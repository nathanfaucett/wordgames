import{S as s,i as t,s as e,D as n,e as o,c as a,a as r,d as c,b as i,f as l,E as u,F as p,G as f,x as m,u as h,L as d,M as $,N as g,P as v,O as w,C as x,Q as I,R as C,T as b}from"./vendor-55b6b459.js";function D(s){let t,e;const d=s[1].default,$=n(d,s,s[0],null);return{c(){t=o("div"),$&&$.c(),this.h()},l(s){t=a(s,"DIV",{class:!0});var e=r(t);$&&$.l(e),e.forEach(c),this.h()},h(){i(t,"class","container mx-auto px-4")},m(s,n){l(s,t,n),$&&$.m(t,null),e=!0},p(s,[t]){$&&$.p&&(!e||1&t)&&u($,d,s,s[0],e?f(d,s[0],t,null):p(s[0]),null)},i(s){e||(m($,s),e=!0)},o(s){h($,s),e=!1},d(s){s&&c(t),$&&$.d(s)}}}function E(s,t,e){let{$$slots:n={},$$scope:o}=t;return s.$$set=s=>{"$$scope"in s&&e(0,o=s.$$scope)},[o,n]}class P extends s{constructor(s){super(),t(this,s,E,D,e,{})}}const M="p2pgame-example-com-",R=x(null),j=x(null),y=new d.EventEmitter;function L(){var s;return null==(s=w(R))?void 0:s.getId()}function S(s){return s.slice(M.length)}function _(s=6){return I(0,s).iter().map((()=>C()<.25?Math.floor(10*C()):String.fromCharCode(97+Math.floor(26*C())))).join("")}function F(){j.set(this)}async function G(s){const t=w(j);if(t){if(t.getRoomId()===s)return t;t.off(b.Connection,F),t.off(b.Disconnection,F),t.close(),j.set(null)}const e=(await function(){const s=w(R);return s?Promise.resolve(s):new Promise((s=>y.once("peer",s)))}()).getRoom(s);return e.on(b.Connection,F),e.on(b.Disconnection,F),j.set(e),y.emit("room",e),e.connect()}$.exports.getItem("peer_id").then((async s=>{s||(s=g(),await $.exports.setItem("peer_id",s));const t=await v.create(new window.Peer((e=s,`${M}${e}`),{host:"localhost",port:parseInt("8080")}));var e;R.set(t),y.emit("peer",t)}));export{P as L,L as a,G as b,S as c,_ as g,y as p,j as r};
