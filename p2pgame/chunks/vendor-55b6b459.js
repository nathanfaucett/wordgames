var e=Object.defineProperty,t=("undefined"!=typeof require&&require,(t,n,r)=>(((t,n,r)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r})(t,"symbol"!=typeof n?n+"":n,r),r));function n(){}function r(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function i(){return Object.create(null)}function s(e){e.forEach(o)}function a(e){return"function"==typeof e}function u(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,...t){if(null==e)return n;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function l(e){let t;return c(e,(e=>t=e))(),t}function h(e,t,n){e.$$.on_destroy.push(c(t,n))}function f(e,t,n,r){if(e){const o=d(e,t,n,r);return e[0](o)}}function d(e,t,n,o){return e[1]&&o?r(n.ctx.slice(),e[1](o(t))):n.ctx}function p(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}function g(e,t,n,r,o,i){if(o){const s=d(t,n,r,i);e.p(s,o)}}function y(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}let _,m=!1;function v(e,t,n,r){for(;e<t;){const o=e+(t-e>>1);n(o)<=r?e=o+1:t=o}return e}function b(e,t){if(m){for(!function(e){if(e.hydrate_init)return;e.hydrate_init=!0;let t=e.childNodes;if("HEAD"===e.nodeName){const e=[];for(let n=0;n<t.length;n++){const r=t[n];void 0!==r.claim_order&&e.push(r)}t=e}const n=new Int32Array(t.length+1),r=new Int32Array(t.length);n[0]=-1;let o=0;for(let u=0;u<t.length;u++){const e=t[u].claim_order,i=(o>0&&t[n[o]].claim_order<=e?o+1:v(1,o,(e=>t[n[e]].claim_order),e))-1;r[u]=n[i]+1;const s=i+1;n[s]=u,o=Math.max(s,o)}const i=[],s=[];let a=t.length-1;for(let u=n[o]+1;0!=u;u=r[u-1]){for(i.push(t[u-1]);a>=u;a--)s.push(t[a]);a--}for(;a>=0;a--)s.push(t[a]);i.reverse(),s.sort(((e,t)=>e.claim_order-t.claim_order));for(let u=0,c=0;u<s.length;u++){for(;c<i.length&&s[u].claim_order>=i[c].claim_order;)c++;const t=c<i.length?i[c]:null;e.insertBefore(s[u],t)}}(e),(void 0===e.actual_end_child||null!==e.actual_end_child&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild);null!==e.actual_end_child&&void 0===e.actual_end_child.claim_order;)e.actual_end_child=e.actual_end_child.nextSibling;t!==e.actual_end_child?void 0===t.claim_order&&t.parentNode===e||e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling}else t.parentNode===e&&null===t.nextSibling||e.appendChild(t)}function w(e,t,n){m&&!n?b(e,t):t.parentNode===e&&t.nextSibling==n||e.insertBefore(t,n||null)}function I(e){e.parentNode.removeChild(e)}function x(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function E(e){return document.createElement(e)}function k(e){return document.createTextNode(e)}function S(){return k(" ")}function O(){return k("")}function j(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function A(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function R(e){return Array.from(e.childNodes)}function C(e,t,n,r,o=!1){!function(e){void 0===e.claim_info&&(e.claim_info={last_index:0,total_claimed:0})}(e);const i=(()=>{for(let r=e.claim_info.last_index;r<e.length;r++){const i=e[r];if(t(i)){const t=n(i);return void 0===t?e.splice(r,1):e[r]=t,o||(e.claim_info.last_index=r),i}}for(let r=e.claim_info.last_index-1;r>=0;r--){const i=e[r];if(t(i)){const t=n(i);return void 0===t?e.splice(r,1):e[r]=t,o?void 0===t&&e.claim_info.last_index--:e.claim_info.last_index=r,i}}return r()})();return i.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1,i}function T(e,t,n){return function(e,t,n,r){return C(e,(e=>e.nodeName===t),(e=>{const t=[];for(let r=0;r<e.attributes.length;r++){const o=e.attributes[r];n[o.name]||t.push(o.name)}t.forEach((t=>e.removeAttribute(t)))}),(()=>r(t)))}(e,t,n,E)}function z(e,t){return C(e,(e=>3===e.nodeType),(e=>{const n=""+t;if(e.data.startsWith(n)){if(e.data.length!==n.length)return e.splitText(n.length)}else e.data=n}),(()=>k(t)),!0)}function N(e){return z(e," ")}function L(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function D(e,t){e.value=null==t?"":t}function M(e,t,n){e.classList[n?"add":"remove"](t)}function U(e){_=e}function V(){if(!_)throw new Error("Function called outside component initialization");return _}function B(e){V().$$.on_mount.push(e)}function $(e){V().$$.after_update.push(e)}function q(e,t){V().$$.context.set(e,t)}const P=[],F=[],H=[],K=[],W=Promise.resolve();let Z=!1;function J(e){H.push(e)}let G=!1;const Y=new Set;function X(){if(!G){G=!0;do{for(let e=0;e<P.length;e+=1){const t=P[e];U(t),Q(t.$$)}for(U(null),P.length=0;F.length;)F.pop()();for(let e=0;e<H.length;e+=1){const t=H[e];Y.has(t)||(Y.add(t),t())}H.length=0}while(P.length);for(;K.length;)K.pop()();Z=!1,G=!1,Y.clear()}}function Q(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(J)}}const ee=new Set;let te;function ne(){te={r:0,c:[],p:te}}function re(){te.r||s(te.c),te=te.p}function oe(e,t){e&&e.i&&(ee.delete(e),e.i(t))}function ie(e,t,n,r){if(e&&e.o){if(ee.has(e))return;ee.add(e),te.c.push((()=>{ee.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function se(e,t){const n={},r={},o={$$scope:1};let i=e.length;for(;i--;){const s=e[i],a=t[i];if(a){for(const e in s)e in a||(r[e]=1);for(const e in a)o[e]||(n[e]=a[e],o[e]=1);e[i]=a}else for(const e in s)o[e]=1}for(const s in r)s in n||(n[s]=void 0);return n}function ae(e){return"object"==typeof e&&null!==e?e:{}}function ue(e){e&&e.c()}function ce(e,t){e&&e.l(t)}function le(e,t,n,r){const{fragment:i,on_mount:u,on_destroy:c,after_update:l}=e.$$;i&&i.m(t,n),r||J((()=>{const t=u.map(o).filter(a);c?c.push(...t):s(t),e.$$.on_mount=[]})),l.forEach(J)}function he(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function fe(e,t){-1===e.$$.dirty[0]&&(P.push(e),Z||(Z=!0,W.then(X)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function de(e,t,r,o,a,u,c,l=[-1]){const h=_;U(e);const f=e.$$={fragment:null,ctx:null,props:u,update:n,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:t.context||[]),callbacks:i(),dirty:l,skip_bound:!1,root:t.target||h.$$.root};c&&c(f.root);let d=!1;if(f.ctx=r?r(e,t.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),d&&fe(e,t)),n})):[],f.update(),d=!0,s(f.before_update),f.fragment=!!o&&o(f.ctx),t.target){if(t.hydrate){m=!0;const e=R(t.target);f.fragment&&f.fragment.l(e),e.forEach(I)}else f.fragment&&f.fragment.c();t.intro&&oe(e.$$.fragment),le(e,t.target,t.anchor,t.customElement),m=!1,X()}U(h)}class pe{$destroy(){he(this,1),this.$destroy=n}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ge=[];function ye(e,t=n){let r;const o=new Set;function i(t){if(u(e,t)&&(e=t,r)){const t=!ge.length;for(const n of o)n[1](),ge.push(n,e);if(t){for(let e=0;e<ge.length;e+=2)ge[e][0](ge[e+1]);ge.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(s,a=n){const u=[s,a];return o.add(u),1===o.size&&(r=t(i)||n),s(e),()=>{o.delete(u),0===o.size&&(r(),r=null)}}}}function _e(e,t,r){const o=!Array.isArray(e),i=o?[e]:e,u=t.length<2;return{subscribe:ye(r,(e=>{let r=!1;const l=[];let h=0,f=n;const d=()=>{if(h)return;f();const r=t(o?l[0]:l,e);u?e(r):f=a(r)?r:n},p=i.map(((e,t)=>c(e,(e=>{l[t]=e,h&=~(1<<t),r&&d()}),(()=>{h|=1<<t}))));return r=!0,d(),function(){s(p),f()}})).subscribe}}var me="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ve(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var be={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,s),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,o);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||o&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[i]=1===c.length?c[0]:c:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(be);var we=be.exports;class Ie extends be.exports.EventEmitter{}const xe=new Ie;var Ee,ke,Se,Oe;"object"==typeof window?window.addEventListener("beforeunload",(()=>xe.emit("close"))):"object"==typeof process&&(process.once("SIGINT",(()=>{process.exit(130)})),process.once("SIGTERM",(()=>{process.exit(143)})),process.on("exit",(()=>{xe.emit("close")}))),(ke=Ee||(Ee={})).Open="open",ke.Close="close",ke.Error="error",ke.ConnectionError="connection-error",ke.Connection="connection",ke.Disconnection="disconnection",ke.Message="data";class je extends be.exports.EventEmitter{constructor(e,n={}){super(),t(this,"peer"),t(this,"peers",{}),t(this,"reconnectTimeoutMS",6e4),t(this,"onError",(e=>{this.emit(Ee.Error,e)})),t(this,"onDataConnection",(async e=>{const t=e.peer;e.on("data",(e=>this.emit(Ee.Message,t,e)));const n=()=>{delete this.peers[t],this.emit(Ee.Disconnection,t)};e.on("close",n),e.on("error",(e=>{switch(n(),this.emit(Ee.ConnectionError,e,t),e.type){case"network":case"peer-unvailable":case"server-error":case"socket-closed":case"socket-error":let e=1e3;const n=()=>{this.connect(t).catch((()=>{e<this.reconnectTimeoutMS&&(e*=2,setTimeout(n,e))}))};setTimeout(n,e)}})),this.peers[t]=e,this.emit(Ee.Connection,t)})),t(this,"waitForDataConnection",(async e=>new Promise(((t,n)=>{if(e.open)this.onDataConnection(e),t(e);else{const r=()=>{e.off("open",r),e.off("error",o),this.onDataConnection(e),t(e)},o=t=>{e.off("open",r),e.off("error",o),n(t)};e.on("open",r),e.on("error",o)}})))),t(this,"close",(()=>(xe.off("close",this.close),this.peers={},this.peer.destroy(),this.emit(Ee.Close),this))),this.peer=e,n&&"number"==typeof n.reconnectTimeoutMS&&n.reconnectTimeoutMS>=0&&(this.reconnectTimeoutMS=n.reconnectTimeoutMS),this.peer.on("error",this.onError),this.peer.on("connection",this.waitForDataConnection),this.emit(Ee.Open),xe.once("close",this.close)}static waitForPeer(e){return new Promise(((t,n)=>{if(e.open)t(e);else{const r=()=>{e.off("open",r),e.off("error",o),t(e)},o=t=>{e.off("open",r),e.off("error",o),n(t)};e.on("open",r),e.on("error",o),(e.destroyed||e.disconnected)&&e.reconnect()}}))}static async create(e,t={}){return new je(await je.waitForPeer(e),t)}async open(){return await je.waitForPeer(this.peer),this}getId(){return this.peer.id}isOpen(){return!!this.peer.open}getInternal(){return this.peer}getReconnectTimeoutMS(){return this.reconnectTimeoutMS}connect(e){const t=this.getPeer(e);return t?Promise.resolve(t):this.waitForDataConnection(this.peer.connect(e))}disconnect(e){var t;return null==(t=this.getPeer(e))||t.close(),delete this.peers[e],this}isConnected(e){const t=this.peer.connections[e];return t&&t.length>0}getPeer(e){return this.peers[e]}getPeerIds(){return Object.keys(this.peers)}getPeers(){return Object.values(this.peers)}send(e,t){var n;return null==(n=this.getPeer(e))||n.send(t),this}broadcast(e,t=[]){for(const n of this.getPeers().filter((e=>!t.includes(e.peer))))n.send(e);return this}}function Ae(e,t,n){return{from:e,type:t,payload:n}}function Re(e,t){return function(e){return null!==e&&"object"==typeof e&&"type"in e}(e)&&e.type===t}(Oe=Se||(Se={})).Message="message",Oe.Boardcast="boardcast",Oe.Peers="peers",Oe.PeerConnect="peer-connect",Oe.PeerDisconnect="peer-disconnect";function Ce(e,t,n,r){return Ae(t,"internal-room-message",Ae(e,n,r))}var Te;(Te||(Te={})).StatusChange="status-change";class ze extends be.exports.EventEmitter{constructor(e,n,r={}){super(),t(this,"roomId"),t(this,"peer"),t(this,"server"),t(this,"client"),t(this,"peers",{}),t(this,"reconnectTimeoutMS",100),t(this,"syncMS",1e3),t(this,"closed",!1),t(this,"close",(()=>(this.closed=!0,xe.off("close",this.close),this.onServeClose(),this.onJoinClose(),this.peer.off(Ee.Message,this.onPeerData),this.emit(Ee.Close),this))),t(this,"onPeerData",((e,t)=>{if(Re(t,"internal-room-message")){const e=t.payload;if(Re(e,Se.Message)&&e.payload.to===this.peer.getId())this.peer.emit(Ee.Message,e.from,e.payload.message),this.emit(Ee.Message,e.from,e.payload.message);else if(Re(e,Se.Boardcast))this.peer.emit(Ee.Message,e.from,e.payload),this.emit(Ee.Message,e.from,e.payload);else if(Re(e,Se.Peers))for(const t of e.payload)this.internalConnect(t);else Re(e,Se.PeerConnect)?this.internalConnect(e.payload):Re(e,Se.PeerDisconnect)&&this.internalDisconnect(e.payload)}})),t(this,"onJoinError",(e=>{switch(this.onJoinClose(),e.type){case"network":case"server-error":case"socket-closed":case"socket-error":setTimeout(this.join,this.reconnectTimeoutMS);break;case"peer-unvailable":this.serve()}this.emit(Ee.Error,e)})),t(this,"onJoinClose",(()=>{this.peer.disconnect(this.roomId),this.client=void 0;for(const e of this.getPeers())this.internalDisconnect(e);return this.peers={},this.closed||this.serve(),this})),t(this,"onServeError",(e=>{switch(this.onServeClose(),e.type){case"network":case"server-error":case"socket-closed":case"socket-error":setTimeout(this.serve,this.reconnectTimeoutMS);break;case"unavailable-id":this.join()}this.emit(Ee.Error,e)})),t(this,"onServeClose",(()=>{var e;null==(e=this.server)||e.close(),this.server=void 0;for(const t of this.getPeers())this.internalDisconnect(t);return this.peers={},this})),t(this,"serve",(async()=>{if(!this.server)try{const e=new(0,Object.getPrototypeOf(this.peer.getInternal()).constructor)(this.roomId,this.peer.getInternal().options),t=new je(e,{reconnectTimeoutMS:this.peer.getReconnectTimeoutMS()});t.on(Ee.Connection,(async e=>{this.internalConnect(e),t.send(e,Ce(this.peer.getId(),this.roomId,Se.Peers,t.getPeerIds())),t.broadcast(Ce(this.peer.getId(),this.roomId,Se.PeerConnect,e),[e])})),t.on(Ee.Disconnection,(e=>{t.broadcast(Ce(this.peer.getId(),this.roomId,Se.PeerDisconnect,e)),this.internalDisconnect(e)})),t.on(Ee.Message,((e,n)=>{if(Re(n,"internal-room-message")){const e=n.payload;Re(e,Se.Message)?t.send(e.payload.to,n):Re(e,Se.Boardcast)&&t.broadcast(n)}})),t.on(Ee.Error,this.onServeError),await je.waitForPeer(e),this.server=t,await this.join(!1),this.emit(Te.StatusChange,"server"),this.emit(Ee.Open)}catch(e){this.onServeError(e)}return this})),this.roomId=n,this.peer=e,this.peer.on(Ee.Message,this.onPeerData),r&&("number"==typeof r.reconnectTimeoutMS&&r.reconnectTimeoutMS>=0&&(this.reconnectTimeoutMS=r.reconnectTimeoutMS),"number"==typeof r.syncMS&&r.syncMS>=0&&(this.syncMS=r.syncMS)),xe.once("close",this.close)}isOpen(){var e;return null==(e=this.peer.getPeer(this.roomId))?void 0:e.open}isServer(){return!!this.server}isClient(){return!this.isServer()}async connect(){return this.closed&&(this.closed=!1),this.serve()}getRoomId(){return this.roomId}getPeer(){return this.peer}getPeers(){return Object.keys(this.peers)}send(e,t,n){var r;return null==(r=this.client)||r.send(Ce(this.peer.getId(),this.roomId,Se.Message,{to:e,message:{from:this.peer.getId(),type:t,payload:n}})),this}broadcast(e,t){var n;return null==(n=this.client)||n.send(Ce(this.peer.getId(),this.roomId,Se.Boardcast,{from:this.peer.getId(),type:e,payload:t})),this}internalConnect(e){this.peers[e]=Date.now(),this.emit(Ee.Connection,e)}internalDisconnect(e){this.emit(Ee.Disconnection,e),delete this.peers[e]}async join(e=!0){if(!this.client)try{const t=this.peer.getInternal().connect(this.roomId);t.on("error",this.onJoinError),t.on("close",this.onJoinClose),await this.peer.waitForDataConnection(t),this.client=t,e&&(this.emit(Te.StatusChange,"client"),this.emit(Ee.Open))}catch(t){this.onJoinError(t)}return this}}class Ne extends je{constructor(){super(...arguments),t(this,"rooms",{})}static async create(e,t={}){return new Ne(await je.waitForPeer(e),t)}getRoom(e){const t=this.rooms[e];if(t)return t;{const t=new ze(this,e);return this.rooms[e]=t,t}}async connectToRoom(e){const t=this.getRoom(e);return t.isOpen()?t:t.connect()}disconnectFromRoom(e){const t=this.getRoom(e);return t&&(t.close(),delete this.rooms[e]),this}}var Le={exports:{}},De={exports:{}},Me="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(Me){var Ue=new Uint8Array(16);De.exports=function(){return Me(Ue),Ue}}else{var Ve=new Array(16);De.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),Ve[t]=e>>>((3&t)<<3)&255;return Ve}}for(var Be=[],$e=0;$e<256;++$e)Be[$e]=($e+256).toString(16).substr(1);var qe,Pe,Fe=function(e,t){var n=t||0,r=Be;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")},He=De.exports,Ke=Fe,We=0,Ze=0;var Je=function(e,t,n){var r=t&&n||0,o=t||[],i=(e=e||{}).node||qe,s=void 0!==e.clockseq?e.clockseq:Pe;if(null==i||null==s){var a=He();null==i&&(i=qe=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==s&&(s=Pe=16383&(a[6]<<8|a[7]))}var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:Ze+1,l=u-We+(c-Ze)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||u>We)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");We=u,Ze=c,Pe=s;var h=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;o[r++]=h>>>24&255,o[r++]=h>>>16&255,o[r++]=h>>>8&255,o[r++]=255&h;var f=u/4294967296*1e4&268435455;o[r++]=f>>>8&255,o[r++]=255&f,o[r++]=f>>>24&15|16,o[r++]=f>>>16&255,o[r++]=s>>>8|128,o[r++]=255&s;for(var d=0;d<6;++d)o[r+d]=i[d];return t||Ke(o)},Ge=De.exports,Ye=Fe;var Xe=Je,Qe=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||Ge)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[r+i]=o[i];return t||Ye(o)},et=Qe;et.v1=Xe,et.v4=Qe;var tt=et;const{v4:nt}=tt;function rt(){return nt().replace(/-/g,"")}let ot=rt;function it(){return ot()}it.setFactory=e=>{ot=e},it.reset=()=>{ot=rt};var st=it;var at={OPTIONS:Symbol("_options"),CACHE:Symbol("_cache"),STATE:Symbol("_state"),OBJECT_ID:Symbol("_objectId"),CONFLICTS:Symbol("_conflicts"),CHANGE:Symbol("_change"),ELEM_IDS:Symbol("_elemIds")};function ut(e){return"object"==typeof e&&null!==e}var ct={isObject:ut,copyObject:function(e){if(!ut(e))return{};let t={};for(let n of Object.keys(e))t[n]=e[n];return t},parseOpId:function(e){const t=/^(\d+)@(.*)$/.exec(e||"");if(!t)throw new RangeError(`Not a valid opId: ${e}`);return{counter:parseInt(t[1],10),actorId:t[2]}},equalBytes:function(e,t){if(!(e instanceof Uint8Array&&t instanceof Uint8Array))throw new TypeError("equalBytes can only compare Uint8Arrays");if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}};const{OBJECT_ID:lt}=at,{isObject:ht}=ct;class ft{constructor(e){if("string"==typeof e){return dt(void 0,[...e].map((e=>({value:e}))))}if(Array.isArray(e)){return dt(void 0,e.map((e=>({value:e}))))}if(void 0===e)return dt(void 0,[]);throw new TypeError(`Unsupported initial value for Text: ${e}`)}get length(){return this.elems.length}get(e){const t=this.elems[e].value;if(this.context&&ht(t)){const n=t[lt],r=this.path.concat([{key:e,objectId:n}]);return this.context.instantiateObject(r,n)}return t}getElemId(e){return this.elems[e].elemId}[Symbol.iterator](){let e=this.elems,t=-1;return{next:()=>(t+=1,t<e.length?{done:!1,value:e[t].value}:{done:!0})}}toString(){let e="";for(const t of this.elems)"string"==typeof t.value&&(e+=t.value);return e}toSpans(){let e=[],t="";for(const n of this.elems)"string"==typeof n.value?t+=n.value:(t.length>0&&(e.push(t),t=""),e.push(n.value));return t.length>0&&e.push(t),e}toJSON(){return this.toString()}getWriteable(e,t){if(!this[lt])throw new RangeError("getWriteable() requires the objectId to be set");const n=dt(this[lt],this.elems);return n.context=e,n.path=t,n}set(e,t){if(this.context)this.context.setListIndex(this.path,e,t);else{if(this[lt])throw new TypeError("Automerge.Text object cannot be modified outside of a change block");this.elems[e].value=t}return this}insertAt(e,...t){if(this.context)this.context.splice(this.path,e,0,t);else{if(this[lt])throw new TypeError("Automerge.Text object cannot be modified outside of a change block");this.elems.splice(e,0,...t.map((e=>({value:e}))))}return this}deleteAt(e,t=1){if(this.context)this.context.splice(this.path,e,t,[]);else{if(this[lt])throw new TypeError("Automerge.Text object cannot be modified outside of a change block");this.elems.splice(e,t)}return this}}for(let Tl of["concat","every","filter","find","findIndex","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString"])ft.prototype[Tl]=function(...e){return[...this][Tl](...e)};function dt(e,t){const n=Object.create(ft.prototype);return n[lt]=e,n.elems=t,n}var pt={Text:ft,instantiateText:dt};const{OBJECT_ID:gt,CONFLICTS:yt}=at,{isObject:_t,copyObject:mt}=ct;function vt(e,t,n){for(let r of e)if(t[r]!==n[r]){if("number"==typeof t[r]&&"number"==typeof n[r])return t[r]-n[r];{const e=""+t[r],o=""+n[r];if(e===o)continue;return e<o?-1:1}}return 0}class bt{constructor(){this.entries=Object.freeze({}),this.opIds=Object.freeze({}),Object.freeze(this)}byId(e){return this.entries[e]}get ids(){return Object.keys(this.entries).filter((e=>{const t=this.entries[e];return _t(t)&&t.id===e}))}get count(){return this.ids.length}get rows(){return this.ids.map((e=>this.byId(e)))}filter(e,t){return this.rows.filter(e,t)}find(e,t){return this.rows.find(e,t)}map(e,t){return this.rows.map(e,t)}sort(e){if("function"==typeof e)return this.rows.sort(e);if("string"==typeof e)return this.rows.sort(((t,n)=>vt([e],t,n)));if(Array.isArray(e))return this.rows.sort(((t,n)=>vt(e,t,n)));if(void 0===e)return this.rows.sort(((e,t)=>vt(["id"],e,t)));throw new TypeError(`Unsupported sorting argument: ${e}`)}[Symbol.iterator](){let e=this.rows,t=-1;return{next:()=>(t+=1,t<e.length?{done:!1,value:e[t]}:{done:!0})}}_clone(){if(!this[gt])throw new RangeError("clone() requires the objectId to be set");return It(this[gt],mt(this.entries),mt(this.opIds))}_set(e,t,n){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");_t(t)&&!Array.isArray(t)&&Object.defineProperty(t,"id",{value:e,enumerable:!0}),this.entries[e]=t,this.opIds[e]=n}remove(e){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");delete this.entries[e],delete this.opIds[e]}_freeze(){Object.freeze(this.entries),Object.freeze(this.opIds),Object.freeze(this)}getWriteable(e,t){if(!this[gt])throw new RangeError("getWriteable() requires the objectId to be set");const n=Object.create(wt.prototype);return n[gt]=this[gt],n.context=e,n.entries=this.entries,n.opIds=this.opIds,n.path=t,n}toJSON(){const e={};for(let t of this.ids)e[t]=this.byId(t);return e}}class wt extends bt{byId(e){if(_t(this.entries[e])&&this.entries[e].id===e){const t=this.entries[e][gt],n=this.path.concat([{key:e,objectId:t}]);return this.context.instantiateObject(n,t,["id"])}}add(e){return this.context.addTableRow(this.path,e)}remove(e){if(!_t(this.entries[e])||this.entries[e].id!==e)throw new RangeError(`There is no row with ID ${e} in this table`);this.context.deleteTableRow(this.path,e,this.opIds[e])}}function It(e,t,n){const r=Object.create(bt.prototype);if(!e)throw new RangeError("instantiateTable requires an objectId to be given");return r[gt]=e,r[yt]=Object.freeze({}),r.entries=t||{},r.opIds=n||{},r}var xt={Table:bt,instantiateTable:It};class Et{constructor(e){this.value=e||0,Object.freeze(this)}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}}class kt extends Et{increment(e){return e="number"==typeof e?e:1,this.context.increment(this.path,this.key,e),this.value+=e,this.value}decrement(e){return this.increment("number"==typeof e?-e:-1)}}var St={Counter:Et,getWriteableCounter:function(e,t,n,r,o){const i=Object.create(kt.prototype);return i.value=e,i.context=t,i.path=n,i.objectId=r,i.key=o,i}};const{isObject:Ot,copyObject:jt,parseOpId:At}=ct,{OBJECT_ID:Rt,CONFLICTS:Ct,ELEM_IDS:Tt}=at,{instantiateText:zt}=pt,{instantiateTable:Nt}=xt,{Counter:Lt}=St;function Dt(e,t,n){return e.objectId?(t&&t[Rt]!==e.objectId&&(t=void 0),$t(e,t,n)):"timestamp"===e.datatype?new Date(e.value):"counter"===e.datatype?new Lt(e.value):e.value}function Mt(e,t){const n=/^(\d+)@(.*)$/,r=n.test(e)?At(e):{counter:0,actorId:e},o=n.test(t)?At(t):{counter:0,actorId:t};return r.counter<o.counter?-1:r.counter>o.counter?1:r.actorId<o.actorId?-1:r.actorId>o.actorId?1:0}function Ut(e,t){const n=jt(e),r=jt(e?e[Ct]:void 0);return Object.defineProperty(n,Rt,{value:t}),Object.defineProperty(n,Ct,{value:r}),n}function Vt(e,t,n){const r=e.objectId;n[r]||(n[r]=Ut(t,r));const o=n[r];return function(e,t,n,r){if(e)for(let o of Object.keys(e)){const i={},s=Object.keys(e[o]).sort(Mt).reverse();for(let t of s){const s=e[o][t];n[o]&&n[o][t]?i[t]=Dt(s,n[o][t],r):i[t]=Dt(s,void 0,r)}0===s.length?(delete t[o],delete n[o]):(t[o]=i[s[0]],n[o]=i)}}(e.props,o,o[Ct],n),o}function Bt(e,t,n){const r=e.objectId;n[r]||(n[r]=function(e,t){const n=e?e.slice():[],r=e&&e[Ct]?e[Ct].slice():[],o=e&&e[Tt]?e[Tt].slice():[];return Object.defineProperty(n,Rt,{value:t}),Object.defineProperty(n,Ct,{value:r}),Object.defineProperty(n,Tt,{value:o}),n}(t,r));const o=n[r],i=o[Ct],s=o[Tt];for(let a=0;a<e.edits.length;a++){const t=e.edits[a];if("insert"===t.action||"update"===t.action){const r=i[t.index]&&i[t.index][t.opId];let u=Dt(t.value,r,n),c={[t.opId]:u};for(;a<e.edits.length-1&&e.edits[a+1].index===t.index&&"update"===e.edits[a+1].action;){a++;const t=e.edits[a],r=i[t.index]&&i[t.index][t.opId];u=Dt(t.value,r,n),c[t.opId]=u}"insert"===t.action?(o.splice(t.index,0,u),i.splice(t.index,0,c),s.splice(t.index,0,t.elemId)):(o[t.index]=u,i[t.index]=c)}else if("multi-insert"===t.action){const e=At(t.elemId),r=[],a=[],u=[],c=t.datatype;t.values.forEach(((t,o)=>{const i=`${e.counter+o}@${e.actorId}`;t=Dt({value:t,datatype:c},void 0,n),a.push(t),u.push({[i]:{value:t,datatype:c,type:"value"}}),r.push(i)})),o.splice(t.index,0,...a),i.splice(t.index,0,...u),s.splice(t.index,0,...r)}else"remove"===t.action&&(o.splice(t.index,t.count),i.splice(t.index,t.count),s.splice(t.index,t.count))}return o}function $t(e,t,n){if(Ot(t)&&(!e.props||0===Object.keys(e.props).length)&&(!e.edits||0===e.edits.length)&&!n[e.objectId])return t;if("map"===e.type)return Vt(e,t,n);if("table"===e.type)return function(e,t,n){const r=e.objectId;n[r]||(n[r]=t?t._clone():Nt(r));const o=n[r];for(let i of Object.keys(e.props||{})){const t=Object.keys(e.props[i]);if(0===t.length)o.remove(i);else{if(1!==t.length)throw new RangeError("Conflicts are not supported on properties of a table");{const r=e.props[i][t[0]];o._set(i,Dt(r,o.byId(i),n),t[0])}}}return o}(e,t,n);if("list"===e.type)return Bt(e,t,n);if("text"===e.type)return function(e,t,n){const r=e.objectId;let o;o=n[r]?n[r].elems:t?t.elems.slice():[];for(const i of e.edits)if("insert"===i.action){const e=Dt(i.value,void 0,n),t={elemId:i.elemId,pred:[i.opId],value:e};o.splice(i.index,0,t)}else if("multi-insert"===i.action){const e=At(i.elemId),t=i.datatype,r=i.values.map(((r,o)=>{r=Dt({datatype:t,value:r},void 0,n);const i=`${e.counter+o}@${e.actorId}`;return{elemId:i,pred:[i],value:r}}));o.splice(i.index,0,...r)}else if("update"===i.action){const e=o[i.index].elemId,t=Dt(i.value,o[i.index].value,n);o[i.index]={elemId:e,pred:[i.opId],value:t}}else"remove"===i.action&&o.splice(i.index,i.count);return n[r]=zt(r,o),n[r]}(e,t,n);throw new TypeError(`Unknown object type: ${e.type}`)}var qt={interpretPatch:$t,cloneRootObject:function(e){if("_root"!==e[Rt])throw new RangeError(`Not the root object: ${e[Rt]}`);return Ut(e,"_root")}};const{OBJECT_ID:Pt,CHANGE:Ft,STATE:Ht}=at,{Text:Kt}=pt,{Table:Wt}=xt;function Zt(e){if("string"==typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e,10)),"number"!=typeof e)throw new TypeError("A list index must be a number, but you passed "+JSON.stringify(e));if(e<0||isNaN(e)||e===1/0||e===-1/0)throw new RangeError("A list index must be positive, but you passed "+e);return e}const Jt={get(e,t){const{context:n,objectId:r,path:o}=e;return t===Pt?r:t===Ft?n:t===Ht?{actorId:n.actorId}:n.getObjectField(o,r,t)},set(e,t,n){const{context:r,path:o,readonly:i}=e;if(Array.isArray(i)&&i.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return r.setMapKey(o,t,n),!0},deleteProperty(e,t){const{context:n,path:r,readonly:o}=e;if(Array.isArray(o)&&o.indexOf(t)>=0)throw new RangeError(`Object property "${t}" cannot be modified`);return n.deleteMapKey(r,t),!0},has(e,t){const{context:n,objectId:r}=e;return[Pt,Ft].includes(t)||t in n.getObject(r)},getOwnPropertyDescriptor(e,t){const{context:n,objectId:r}=e;if(t in n.getObject(r))return{configurable:!0,enumerable:!0,value:n.getObjectField(r,t)}},ownKeys(e){const{context:t,objectId:n}=e;return Object.keys(t.getObject(n))}},Gt={get(e,t){const[n,r,o]=e;return t===Symbol.iterator?n.getObject(r)[Symbol.iterator]:t===Pt?r:t===Ft?n:"length"===t?n.getObject(r).length:"string"==typeof t&&/^[0-9]+$/.test(t)?n.getObjectField(o,r,Zt(t)):function(e,t,n){const r={deleteAt(t,r){return e.splice(n,Zt(t),r||1,[]),this},fill(r,o,i){let s=e.getObject(t);for(let t=Zt(o||0);t<Zt(i||s.length);t++)e.setListIndex(n,t,r);return this},indexOf(n,r=0){const o=n[Pt];if(o){const n=e.getObject(t);for(let e=r;e<n.length;e++)if(n[e][Pt]===o)return e;return-1}return e.getObject(t).indexOf(n,r)},insertAt(t,...r){return e.splice(n,Zt(t),0,r),this},pop(){let r=e.getObject(t);if(0==r.length)return;const o=e.getObjectField(n,t,r.length-1);return e.splice(n,r.length-1,1,[]),o},push(...r){let o=e.getObject(t);return e.splice(n,o.length,0,r),e.getObject(t).length},shift(){if(0==e.getObject(t).length)return;const r=e.getObjectField(n,t,0);return e.splice(n,0,1,[]),r},splice(r,o,...i){let s=e.getObject(t);r=Zt(r),(void 0===o||o>s.length-r)&&(o=s.length-r);const a=[];for(let u=0;u<o;u++)a.push(e.getObjectField(n,t,r+u));return e.splice(n,r,o,i),a},unshift:(...r)=>(e.splice(n,0,0,r),e.getObject(t).length)};for(let o of["entries","keys","values"]){let n=e.getObject(t);r[o]=()=>n[o]()}for(let o of["concat","every","filter","find","findIndex","forEach","includes","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString","toString"])r[o]=(...r)=>e.getObject(t).map(((r,o)=>e.getObjectField(n,t,o)))[o](...r);return r}(n,r,o)[t]},set(e,t,n){const[r,o,i]=e;if("length"===t){if("number"!=typeof n)throw new RangeError("Invalid array length");const e=r.getObject(o).length;e>n?r.splice(i,n,e-n,[]):r.splice(i,e,0,function(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=null;return t}(n-e))}else r.setListIndex(i,Zt(t),n);return!0},deleteProperty(e,t){const[n,,r]=e;return n.splice(r,Zt(t),1,[]),!0},has(e,t){const[n,r]=e;return"string"==typeof t&&/^[0-9]+$/.test(t)?Zt(t)<n.getObject(r).length:["length",Pt,Ft].includes(t)},getOwnPropertyDescriptor(e,t){const[n,r]=e,o=n.getObject(r);if("length"===t)return{writable:!0,value:o.length};if(t===Pt)return{configurable:!1,enumerable:!1,value:r};if("string"==typeof t&&/^[0-9]+$/.test(t)){const e=Zt(t);if(e<o.length)return{configurable:!0,enumerable:!0,value:n.getObjectField(r,e)}}},ownKeys(e){const[t,n]=e,r=t.getObject(n);let o=["length"];for(let i of Object.keys(r))o.push(i);return o}};function Yt(e,t,n,r){return new Proxy({context:e,objectId:t,path:n,readonly:r},Jt)}function Xt(e,t,n){const r=this.getObject(t);return Array.isArray(r)?function(e,t,n){return new Proxy([e,t,n],Gt)}(this,t,e):r instanceof Kt||r instanceof Wt?r.getWriteable(this,e):Yt(this,t,e,n)}var Qt={rootObjectProxy:function(e){return e.instantiateObject=Xt,Yt(e,"_root",[])}};var en={Int:class{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Object.freeze(this)}},Uint:class{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=0))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Object.freeze(this)}},Float64:class{constructor(e){if("number"!=typeof e)throw new RangeError(`Value ${e} cannot be a float64`);this.value=e||0,Object.freeze(this)}}};const{CACHE:tn,OBJECT_ID:nn,CONFLICTS:rn,ELEM_IDS:on,STATE:sn}=at,{interpretPatch:an}=qt,{Text:un}=pt,{Table:cn}=xt,{Counter:ln,getWriteableCounter:hn}=St,{Int:fn,Uint:dn,Float64:pn}=en,{isObject:gn,parseOpId:yn}=ct,_n=st;function mn(e,t){return e instanceof cn?[e.opIds[t]]:e instanceof un?e.elems[t].pred:e[rn]&&e[rn][t]?Object.keys(e[rn][t]):[]}function vn(e,t,n=!1){if(n){if(0===t)return"_head";t-=1}if(e[on])return e[on][t];if(e.getElemId)return e.getElemId(t);throw new RangeError(`Cannot find elemId at list index ${t}`)}var bn={Context:class{constructor(e,t,n){this.actorId=t,this.maxOp=e[sn].maxOp,this.cache=e[tn],this.updated={},this.ops=[],this.applyPatch=n||an}addOp(e){this.ops.push(e)}nextOpId(){let e=this.maxOp+1;for(const t of this.ops)"set"===t.action&&t.values?e+=t.values.length:"del"===t.action&&t.multiOp?e+=t.multiOp:e+=1;return`${e}@${this.actorId}`}getValueDescription(e){if(!["object","boolean","number","string"].includes(typeof e))throw new TypeError("Unsupported type of value: "+typeof e);if(gn(e)){if(e instanceof Date)return{type:"value",value:e.getTime(),datatype:"timestamp"};if(e instanceof fn)return{type:"value",value:e.value,datatype:"int"};if(e instanceof dn)return{type:"value",value:e.value,datatype:"uint"};if(e instanceof pn)return{type:"value",value:e.value,datatype:"float64"};if(e instanceof ln)return{type:"value",value:e.value,datatype:"counter"};{const t=e[nn],n=this.getObjectType(t);if(!t)throw new RangeError(`Object ${JSON.stringify(e)} has no objectId`);return"list"===n||"text"===n?{objectId:t,type:n,edits:[]}:{objectId:t,type:n,props:{}}}}return"number"==typeof e?Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?{type:"value",value:e,datatype:"int"}:{type:"value",value:e,datatype:"float64"}:{type:"value",value:e}}getValuesDescriptions(e,t,n){if(t instanceof cn){const e=t.byId(n);return e?{[n]:this.getValueDescription(e)}:{}}if(t instanceof un){const e=t.get(n),r=t.getElemId(n);return e?{[r]:this.getValueDescription(e)}:{}}{const r=t[rn][n],o={};if(!r)throw new RangeError(`No children at key ${n} of path ${JSON.stringify(e)}`);for(let e of Object.keys(r))o[e]=this.getValueDescription(r[e]);return o}}getPropertyValue(e,t,n){return e instanceof cn?e.byId(t):e instanceof un?e.get(t):e[rn][t][n]}getSubpatch(e,t){if(0==t.length)return e;let n=e,r=this.getObject("_root");for(let o of t){let e=this.getValuesDescriptions(t,r,o.key);if(n.props)n.props[o.key]||(n.props[o.key]=e);else if(n.edits)for(const t of Object.keys(e))n.edits.push({action:"update",index:o.key,opId:t,value:e[t]});let i=null;for(let t of Object.keys(e))e[t].objectId===o.objectId&&(i=t);if(!i)throw new RangeError(`Cannot find path object with objectId ${o.objectId}`);n=e[i],r=this.getPropertyValue(r,o.key,i)}return n}getObject(e){const t=this.updated[e]||this.cache[e];if(!t)throw new RangeError(`Target object does not exist: ${e}`);return t}getObjectType(e){if("_root"===e)return"map";const t=this.getObject(e);return t instanceof un?"text":t instanceof cn?"table":Array.isArray(t)?"list":"map"}getObjectField(e,t,n){if(!["string","number"].includes(typeof n))return;const r=this.getObject(t);if(r[n]instanceof ln)return hn(r[n].value,this,e,t,n);if(gn(r[n])){const t=r[n][nn],o=e.concat([{key:n,objectId:t}]);return this.instantiateObject(o,t)}return r[n]}createNestedObjects(e,t,n,r,o,i){if(n[nn])throw new RangeError("Cannot create a reference to an existing document object");const s=this.nextOpId();if(n instanceof un){this.addOp(i?{action:"makeText",obj:e,elemId:i,insert:r,pred:o}:{action:"makeText",obj:e,key:t,insert:r,pred:o});const a={objectId:s,type:"text",edits:[]};return this.insertListItems(a,0,[...n],!0),a}if(n instanceof cn){if(n.count>0)throw new RangeError("Assigning a non-empty Table object is not supported");return this.addOp(i?{action:"makeTable",obj:e,elemId:i,insert:r,pred:o}:{action:"makeTable",obj:e,key:t,insert:r,pred:o}),{objectId:s,type:"table",props:{}}}if(Array.isArray(n)){this.addOp(i?{action:"makeList",obj:e,elemId:i,insert:r,pred:o}:{action:"makeList",obj:e,key:t,insert:r,pred:o});const a={objectId:s,type:"list",edits:[]};return this.insertListItems(a,0,n,!0),a}{this.addOp(i?{action:"makeMap",obj:e,elemId:i,insert:r,pred:o}:{action:"makeMap",obj:e,key:t,insert:r,pred:o});let a={};for(let e of Object.keys(n).sort()){const t=this.nextOpId(),r=this.setValue(s,e,n[e],!1,[]);a[e]={[t]:r}}return{objectId:s,type:"map",props:a}}}setValue(e,t,n,r,o,i){if(!e)throw new RangeError("setValue needs an objectId");if(""===t)throw new RangeError("The key of a map entry must not be an empty string");if(!gn(n)||n instanceof Date||n instanceof ln||n instanceof fn||n instanceof dn||n instanceof pn){const s=this.getValueDescription(n),a={action:"set",obj:e,insert:r,value:s.value,pred:o};return i?a.elemId=i:a.key=t,s.datatype&&(a.datatype=s.datatype),this.addOp(a),s}return this.createNestedObjects(e,t,n,r,o,i)}applyAtPath(e,t){let n={objectId:"_root",type:"map",props:{}};t(this.getSubpatch(n,e)),this.applyPatch(n,this.cache._root,this.updated)}setMapKey(e,t,n){if("string"!=typeof t)throw new RangeError("The key of a map entry must be a string, not "+typeof t);const r=0===e.length?"_root":e[e.length-1].objectId,o=this.getObject(r);if(o[t]instanceof ln)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(o[t]!==n||Object.keys(o[rn][t]||{}).length>1||void 0===n)&&this.applyAtPath(e,(e=>{const i=mn(o,t),s=this.nextOpId(),a=this.setValue(r,t,n,!1,i);e.props[t]={[s]:a}}))}deleteMapKey(e,t){const n=0===e.length?"_root":e[e.length-1].objectId,r=this.getObject(n);if(void 0!==r[t]){const o=mn(r,t);this.addOp({action:"del",obj:n,key:t,insert:!1,pred:o}),this.applyAtPath(e,(e=>{e.props[t]={}}))}}insertListItems(e,t,n,r){const o=r?[]:this.getObject(e.objectId);if(t<0||t>o.length)throw new RangeError(`List index ${t} is out of bounds for list of length ${o.length}`);if(0===n.length)return;let i=vn(o,t,!0);const s=n.every((e=>"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e||gn(e)&&(e instanceof Date||e instanceof ln||e instanceof fn||e instanceof dn||e instanceof pn))),a=s?n.map((e=>this.getValueDescription(e))):[],u=a.every((e=>e.datatype===a[0].datatype));if(s&&u&&n.length>1){const n=this.nextOpId(),r=a[0].datatype,o=a.map((e=>e.value)),s={action:"set",obj:e.objectId,elemId:i,insert:!0,values:o,pred:[]},u={action:"multi-insert",elemId:n,index:t,values:o};r&&(s.datatype=r,u.datatype=r),this.addOp(s),e.edits.push(u)}else for(let c=0;c<n.length;c++){let r=this.nextOpId();const o=this.setValue(e.objectId,t+c,n[c],!0,[],i);i=r,e.edits.push({action:"insert",index:t+c,elemId:i,opId:i,value:o})}}setListIndex(e,t,n){const r=0===e.length?"_root":e[e.length-1].objectId,o=this.getObject(r);if(t===o.length)return this.splice(e,t,0,[n]);if(t<0||t>o.length)throw new RangeError(`List index ${t} is out of bounds for list of length ${o.length}`);if(o[t]instanceof ln)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(o[t]!==n||Object.keys(o[rn][t]||{}).length>1||void 0===n)&&this.applyAtPath(e,(e=>{const i=mn(o,t),s=this.nextOpId(),a=this.setValue(r,t,n,!1,i,vn(o,t));e.edits.push({action:"update",index:t,opId:s,value:a})}))}splice(e,t,n,r){const o=0===e.length?"_root":e[e.length-1].objectId;let i=this.getObject(o);if(t<0||n<0||t>i.length-n)throw new RangeError(`${n} deletions starting at index ${t} are out of bounds for list of length ${i.length}`);if(0===n&&0===r.length)return;let s={objectId:"_root",type:"map",props:{}},a=this.getSubpatch(s,e);if(n>0){let r,s,u;for(let a=0;a<n;a++){if(this.getObjectField(e,o,t+a)instanceof ln)throw new TypeError("Unsupported operation: deleting a counter from a list");const n=vn(i,t+a),c=yn(n),l=mn(i,t+a),h=1===l.length?yn(l[0]):void 0;r&&s&&u&&h&&s.actorId===c.actorId&&s.counter+1===c.counter&&u.actorId===h.actorId&&u.counter+1===h.counter?r.multiOp=(r.multiOp||1)+1:(r&&this.addOp(r),r={action:"del",obj:o,elemId:n,insert:!1,pred:l}),s=c,u=h}this.addOp(r),a.edits.push({action:"remove",index:t,count:n})}r.length>0&&this.insertListItems(a,t,r,!1),this.applyPatch(s,this.cache._root,this.updated)}addTableRow(e,t){if(!gn(t)||Array.isArray(t))throw new TypeError("A table row must be an object");if(t[nn])throw new TypeError("Cannot reuse an existing object as table row");if(t.id)throw new TypeError('A table row must not have an "id" property; it is generated automatically');const n=_n(),r=this.setValue(e[e.length-1].objectId,n,t,!1,[]);return this.applyAtPath(e,(e=>{e.props[n]={[r.objectId]:r}})),n}deleteTableRow(e,t,n){const r=e[e.length-1].objectId;this.getObject(r).byId(t)&&(this.addOp({action:"del",obj:r,key:t,insert:!1,pred:[n]}),this.applyAtPath(e,(e=>{e.props[t]={}})))}increment(e,t,n){const r=0===e.length?"_root":e[e.length-1].objectId,o=this.getObject(r);if(!(o[t]instanceof ln))throw new TypeError("Only counter values can be incremented");const i=this.getObjectType(r),s=o[t].value+n,a=this.nextOpId(),u=mn(o,t);if("list"===i||"text"===i){const e=vn(o,t,!1);this.addOp({action:"inc",obj:r,elemId:e,value:n,insert:!1,pred:u})}else this.addOp({action:"inc",obj:r,key:t,value:n,insert:!1,pred:u});this.applyAtPath(e,(e=>{"list"===i||"text"===i?e.edits.push({action:"update",index:t,opId:a,value:{value:s,datatype:"counter"}}):e.props[t]={[a]:{value:s,datatype:"counter"}}}))}}};const{OBJECT_ID:wn,CONFLICTS:In}=at;var xn={Observable:class{constructor(){this.observers={}}patchCallback(e,t,n,r,o){this._objectUpdate(e.diffs,t,n,r,o)}_objectUpdate(e,t,n,r,o){if(e.objectId){if(this.observers[e.objectId])for(let i of this.observers[e.objectId])i(e,t,n,r,o);if("map"===e.type&&e.props)for(const i of Object.keys(e.props))for(const s of Object.keys(e.props[i]))this._objectUpdate(e.props[i][s],t&&t[In]&&t[In][i]&&t[In][i][s],n&&n[In]&&n[In][i]&&n[In][i][s],r,o);else if("table"===e.type&&e.props)for(const i of Object.keys(e.props))for(const s of Object.keys(e.props[i]))this._objectUpdate(e.props[i][s],t&&t.byId(i),n&&n.byId(i),r,o);else if("list"===e.type&&e.edits){let i=0;for(const s of e.edits)"insert"===s.action?(i-=1,this._objectUpdate(s.value,void 0,n&&n[In]&&n[In][s.index]&&n[In][s.index][s.elemId],r,o)):"multi-insert"===s.action?i-=s.values.length:"update"===s.action?this._objectUpdate(s.value,t&&t[In]&&t[In][s.index+i]&&t[In][s.index+i][s.opId],n&&n[In]&&n[In][s.index]&&n[In][s.index][s.opId],r,o):"remove"===s.action&&(i+=s.count)}else if("text"===e.type&&e.edits){let i=0;for(const s of e.edits)"insert"===s.action?(i-=1,this._objectUpdate(s.value,void 0,n&&n.get(s.index),r,o)):"multi-insert"===s.action?i-=s.values.length:"update"===s.action?this._objectUpdate(s.value,t&&t.get(s.index+i),n&&n.get(s.index),r,o):"remove"===s.action&&(i+=s.count)}}}observe(e,t){const n=e[wn];if(!n)throw new TypeError("The observed object must be part of an Automerge document");this.observers[n]||(this.observers[n]=[]),this.observers[n].push(t)}}};const{OPTIONS:En,CACHE:kn,STATE:Sn,OBJECT_ID:On,CONFLICTS:jn,CHANGE:An,ELEM_IDS:Rn}=at,{isObject:Cn,copyObject:Tn}=ct,zn=st,{interpretPatch:Nn,cloneRootObject:Ln}=qt,{rootObjectProxy:Dn}=Qt,{Context:Mn}=bn,{Text:Un}=pt,{Table:Vn}=xt,{Counter:Bn}=St,{Float64:$n,Int:qn,Uint:Pn}=en,{Observable:Fn}=xn;function Hn(e){if("string"!=typeof e)throw new TypeError("Unsupported type of actorId: "+typeof e);if(!/^[0-9a-f]+$/.test(e))throw new RangeError("actorId must consist only of lowercase hex digits");if(e.length%2!=0)throw new RangeError("actorId must consist of an even number of digits")}function Kn(e,t,n){let r=t._root;if(r||(r=Ln(e[kn]._root),t._root=r),Object.defineProperty(r,En,{value:e[En]}),Object.defineProperty(r,kn,{value:t}),Object.defineProperty(r,Sn,{value:n}),e[En].freeze)for(let o of Object.keys(t))t[o]instanceof Vn?t[o]._freeze():t[o]instanceof Un?(Object.freeze(t[o].elems),Object.freeze(t[o])):(Object.freeze(t[o]),Object.freeze(t[o][jn]));for(let o of Object.keys(e[kn]))t[o]||(t[o]=e[kn][o]);return e[En].freeze&&Object.freeze(t),r}function Wn(e,t,n){const r=Yn(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const o=Tn(e[Sn]);o.seq+=1;const i={actor:r,seq:o.seq,startOp:o.maxOp+1,deps:o.deps,time:n&&"number"==typeof n.time?n.time:Math.round((new Date).getTime()/1e3),message:n&&"string"==typeof n.message?n.message:"",ops:t.ops};if(e[En].backend){const[t,r,s]=e[En].backend.applyLocalChange(o.backendState,i);o.backendState=t,o.lastLocalChange=s;const a=Zn(e,r,o,!0),u=n&&n.patchCallback||e[En].patchCallback;return u&&u(r,e,a,!0,[s]),[a,i]}{const n={actor:r,seq:i.seq,before:e};return o.requests=o.requests.concat([n]),o.maxOp=o.maxOp+function(e){let t=0;for(const n of e)"set"===n.action&&n.values?t+=n.values.length:t+=1;return t}(i.ops),o.deps=[],[Kn(e,t?t.updated:{},o),i]}}function Zn(e,t,n,r){const o=Yn(e),i={};if(Nn(t.diffs,e,i),r){if(!t.clock)throw new RangeError("patch is missing clock field");t.clock[o]&&t.clock[o]>n.seq&&(n.seq=t.clock[o]),n.clock=t.clock,n.deps=t.deps,n.maxOp=Math.max(n.maxOp,t.maxOp)}return Kn(e,i,n)}function Jn(e){if("string"==typeof e)e={actorId:e};else if(void 0===e)e={};else if(!Cn(e))throw new TypeError(`Unsupported value for init() options: ${e}`);if(e.deferActorId||(void 0===e.actorId&&(e.actorId=zn()),Hn(e.actorId)),e.observable){const t=e.patchCallback,n=e.observable;e.patchCallback=(e,r,o,i,s)=>{t&&t(e,r,o,i,s),n.patchCallback(e,r,o,i,s)}}const t={},n={_root:t},r={seq:0,maxOp:0,requests:[],clock:{},deps:[]};return e.backend&&(r.backendState=e.backend.init(),r.lastLocalChange=null),Object.defineProperty(t,On,{value:"_root"}),Object.defineProperty(t,En,{value:Object.freeze(e)}),Object.defineProperty(t,jn,{value:Object.freeze({})}),Object.defineProperty(t,kn,{value:Object.freeze(n)}),Object.defineProperty(t,Sn,{value:Object.freeze(r)}),Object.freeze(t)}function Gn(e,t,n){if("_root"!==e[On])throw new TypeError("The first argument to Automerge.change must be the document root");if(e[An])throw new TypeError("Calls to Automerge.change cannot be nested");if("function"==typeof t&&void 0===n&&([t,n]=[n,t]),"string"==typeof t&&(t={message:t}),void 0!==t&&!Cn(t))throw new TypeError("Unsupported type of options");const r=Yn(e);if(!r)throw new Error("Actor ID must be initialized with setActorId() before making a change");const o=new Mn(e,r);return n(Dn(o)),0===Object.keys(o.updated).length?[e,null]:Wn(e,o,t)}function Yn(e){return e[Sn].actorId||e[En].actorId}var Xn={init:Jn,from:function(e,t){return Gn(Jn(t),"Initialization",(t=>Object.assign(t,e)))},change:Gn,emptyChange:function(e,t){if("_root"!==e[On])throw new TypeError("The first argument to Automerge.emptyChange must be the document root");if("string"==typeof t&&(t={message:t}),void 0!==t&&!Cn(t))throw new TypeError("Unsupported type of options");const n=Yn(e);if(!n)throw new Error("Actor ID must be initialized with setActorId() before making a change");return Wn(e,new Mn(e,n),t)},applyPatch:function(e,t,n){if("_root"!==e[On])throw new TypeError("The first argument to Frontend.applyPatch must be the document root");const r=Tn(e[Sn]);if(e[En].backend){if(!n)throw new RangeError("applyPatch must be called with the updated backend state");return r.backendState=n,Zn(e,t,r,!0)}let o;if(r.requests.length>0)if(o=r.requests[0].before,t.actor===Yn(e)){if(r.requests[0].seq!==t.seq)throw new RangeError(`Mismatched sequence number: patch ${t.seq} does not match next request ${r.requests[0].seq}`);r.requests=r.requests.slice(1)}else r.requests=r.requests.slice();else o=e,r.requests=[];let i=Zn(o,t,r,!0);return 0===r.requests.length?i:(r.requests[0]=Tn(r.requests[0]),r.requests[0].before=i,Kn(e,{},r))},getObjectId:function(e){return e[On]},getObjectById:function(e,t){if(e[An])throw new TypeError("Cannot use getObjectById in a change callback");return e[kn][t]},getActorId:Yn,setActorId:function(e,t){return Hn(t),Kn(e,{},Object.assign({},e[Sn],{actorId:t}))},getConflicts:function(e,t){if(e[jn]&&e[jn][t]&&Object.keys(e[jn][t]).length>1)return e[jn][t]},getLastLocalChange:function(e){return e[Sn]&&e[Sn].lastLocalChange?e[Sn].lastLocalChange:null},getBackendState:function(e,t=null,n="first"){if("_root"!==e[On]){const r=Array.isArray(e)?". Note: Automerge.applyChanges now returns an array.":"";throw t?new TypeError(`The ${n} argument to Automerge.${t} must be the document root${r}`):new TypeError(`Argument is not an Automerge document root${r}`)}return e[Sn].backendState},getElementIds:function(e){return e instanceof Un?e.elems.map((e=>e.elemId)):e[Rn]},Text:Un,Table:Vn,Counter:Bn,Observable:Fn,Float64:$n,Int:qn,Uint:Pn},Qn={},er={},tr={},nr={};function rr(e){let t=e.length;for(;--t>=0;)e[t]=0}const or=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ir=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),sr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ar=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ur=new Array(576);rr(ur);const cr=new Array(60);rr(cr);const lr=new Array(512);rr(lr);const hr=new Array(256);rr(hr);const fr=new Array(29);rr(fr);const dr=new Array(30);function pr(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}let gr,yr,_r;function mr(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}rr(dr);const vr=e=>e<256?lr[e]:lr[256+(e>>>7)],br=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},wr=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,br(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Ir=(e,t,n)=>{wr(e,n[2*t],n[2*t+1])},xr=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Er=(e,t,n)=>{const r=new Array(16);let o,i,s=0;for(o=1;o<=15;o++)r[o]=s=s+n[o-1]<<1;for(i=0;i<=t;i++){let t=e[2*i+1];0!==t&&(e[2*i]=xr(r[t]++,t))}},kr=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Sr=e=>{e.bi_valid>8?br(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Or=(e,t,n,r)=>{const o=2*t,i=2*n;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]},jr=(e,t,n)=>{const r=e.heap[n];let o=n<<1;for(;o<=e.heap_len&&(o<e.heap_len&&Or(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!Or(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r},Ar=(e,t,n)=>{let r,o,i,s,a=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],o=e.pending_buf[e.l_buf+a],a++,0===r?Ir(e,o,t):(i=hr[o],Ir(e,i+256+1,t),s=or[i],0!==s&&(o-=fr[i],wr(e,o,s)),r--,i=vr(r),Ir(e,i,n),s=ir[i],0!==s&&(r-=dr[i],wr(e,r,s)))}while(a<e.last_lit);Ir(e,256,t)},Rr=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,i=t.stat_desc.elems;let s,a,u,c=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<i;s++)0!==n[2*s]?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,n[2*u]=1,e.depth[u]=0,e.opt_len--,o&&(e.static_len-=r[2*u+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)jr(e,n,s);u=i;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],jr(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,n[2*u]=n[2*s]+n[2*a],e.depth[u]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,n[2*s+1]=n[2*a+1]=u,e.heap[1]=u++,jr(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,u=t.stat_desc.max_length;let c,l,h,f,d,p,g=0;for(f=0;f<=15;f++)e.bl_count[f]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)l=e.heap[c],f=n[2*n[2*l+1]+1]+1,f>u&&(f=u,g++),n[2*l+1]=f,l>r||(e.bl_count[f]++,d=0,l>=a&&(d=s[l-a]),p=n[2*l],e.opt_len+=p*(f+d),i&&(e.static_len+=p*(o[2*l+1]+d)));if(0!==g){do{for(f=u-1;0===e.bl_count[f];)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[u]--,g-=2}while(g>0);for(f=u;0!==f;f--)for(l=e.bl_count[f];0!==l;)h=e.heap[--c],h>r||(n[2*h+1]!==f&&(e.opt_len+=(f-n[2*h+1])*n[2*h],n[2*h+1]=f),l--)}})(e,t),Er(n,c,e.bl_count)},Cr=(e,t,n)=>{let r,o,i=-1,s=t[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=s,s=t[2*(r+1)+1],++a<u&&o===s||(a<c?e.bl_tree[2*o]+=a:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,i=o,0===s?(u=138,c=3):o===s?(u=6,c=3):(u=7,c=4))},Tr=(e,t,n)=>{let r,o,i=-1,s=t[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),r=0;r<=n;r++)if(o=s,s=t[2*(r+1)+1],!(++a<u&&o===s)){if(a<c)do{Ir(e,o,e.bl_tree)}while(0!=--a);else 0!==o?(o!==i&&(Ir(e,o,e.bl_tree),a--),Ir(e,16,e.bl_tree),wr(e,a-3,2)):a<=10?(Ir(e,17,e.bl_tree),wr(e,a-3,3)):(Ir(e,18,e.bl_tree),wr(e,a-11,7));a=0,i=o,0===s?(u=138,c=3):o===s?(u=6,c=3):(u=7,c=4)}};let zr=!1;const Nr=(e,t,n,r)=>{wr(e,0+(r?1:0),3),((e,t,n,r)=>{Sr(e),r&&(br(e,n),br(e,~n)),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n})(e,t,n,!0)};nr._tr_init=e=>{zr||((()=>{let e,t,n,r,o;const i=new Array(16);for(n=0,r=0;r<28;r++)for(fr[r]=n,e=0;e<1<<or[r];e++)hr[n++]=r;for(hr[n-1]=r,o=0,r=0;r<16;r++)for(dr[r]=o,e=0;e<1<<ir[r];e++)lr[o++]=r;for(o>>=7;r<30;r++)for(dr[r]=o<<7,e=0;e<1<<ir[r]-7;e++)lr[256+o++]=r;for(t=0;t<=15;t++)i[t]=0;for(e=0;e<=143;)ur[2*e+1]=8,e++,i[8]++;for(;e<=255;)ur[2*e+1]=9,e++,i[9]++;for(;e<=279;)ur[2*e+1]=7,e++,i[7]++;for(;e<=287;)ur[2*e+1]=8,e++,i[8]++;for(Er(ur,287,i),e=0;e<30;e++)cr[2*e+1]=5,cr[2*e]=xr(e,5);gr=new pr(ur,or,257,286,15),yr=new pr(cr,ir,0,30,15),_r=new pr(new Array(0),sr,0,19,7)})(),zr=!0),e.l_desc=new mr(e.dyn_ltree,gr),e.d_desc=new mr(e.dyn_dtree,yr),e.bl_desc=new mr(e.bl_tree,_r),e.bi_buf=0,e.bi_valid=0,kr(e)},nr._tr_stored_block=Nr,nr._tr_flush_block=(e,t,n,r)=>{let o,i,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Rr(e,e.l_desc),Rr(e,e.d_desc),s=(e=>{let t;for(Cr(e,e.dyn_ltree,e.l_desc.max_code),Cr(e,e.dyn_dtree,e.d_desc.max_code),Rr(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*ar[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),o=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=o&&(o=i)):o=i=n+5,n+4<=o&&-1!==t?Nr(e,t,n,r):4===e.strategy||i===o?(wr(e,2+(r?1:0),3),Ar(e,ur,cr)):(wr(e,4+(r?1:0),3),((e,t,n,r)=>{let o;for(wr(e,t-257,5),wr(e,n-1,5),wr(e,r-4,4),o=0;o<r;o++)wr(e,e.bl_tree[2*ar[o]+1],3);Tr(e,e.dyn_ltree,t-1),Tr(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Ar(e,e.dyn_ltree,e.dyn_dtree)),kr(e),r&&Sr(e)},nr._tr_tally=(e,t,n)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(hr[n]+256+1)]++,e.dyn_dtree[2*vr(t)]++),e.last_lit===e.lit_bufsize-1),nr._tr_align=e=>{wr(e,2,3),Ir(e,256,ur),(e=>{16===e.bi_valid?(br(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)};var Lr=(e,t,n,r)=>{let o=65535&e|0,i=e>>>16&65535|0,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{o=o+t[r++]|0,i=i+o|0}while(--s);o%=65521,i%=65521}return o|i<<16|0};const Dr=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Mr=(e,t,n,r)=>{const o=Dr,i=r+n;e^=-1;for(let s=r;s<i;s++)e=e>>>8^o[255&(e^t[s])];return-1^e},Ur={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Vr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Br,_tr_stored_block:$r,_tr_flush_block:qr,_tr_tally:Pr,_tr_align:Fr}=nr,Hr=Lr,Kr=Mr,Wr=Ur,{Z_NO_FLUSH:Zr,Z_PARTIAL_FLUSH:Jr,Z_FULL_FLUSH:Gr,Z_FINISH:Yr,Z_BLOCK:Xr,Z_OK:Qr,Z_STREAM_END:eo,Z_STREAM_ERROR:to,Z_DATA_ERROR:no,Z_BUF_ERROR:ro,Z_DEFAULT_COMPRESSION:oo,Z_FILTERED:io,Z_HUFFMAN_ONLY:so,Z_RLE:ao,Z_FIXED:uo,Z_DEFAULT_STRATEGY:co,Z_UNKNOWN:lo,Z_DEFLATED:ho}=Vr,fo=(e,t)=>(e.msg=Wr[t],t),po=e=>(e<<1)-(e>4?9:0),go=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let yo=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const _o=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},mo=(e,t)=>{qr(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,_o(e.strm)},vo=(e,t)=>{e.pending_buf[e.pending++]=t},bo=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},wo=(e,t,n,r)=>{let o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),n),1===e.state.wrap?e.adler=Hr(e.adler,t,o,n):2===e.state.wrap&&(e.adler=Kr(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)},Io=(e,t)=>{let n,r,o=e.max_chain_length,i=e.strstart,s=e.prev_length,a=e.nice_match;const u=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,l=e.w_mask,h=e.prev,f=e.strstart+258;let d=c[i+s-1],p=c[i+s];e.prev_length>=e.good_match&&(o>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,c[n+s]===p&&c[n+s-1]===d&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<f);if(r=258-(f-i),i=f-258,r>s){if(e.match_start=t,s=r,r>=a)break;d=c[i+s-1],p=c[i+s]}}}while((t=h[t&l])>u&&0!=--o);return s<=e.lookahead?s:e.lookahead},xo=e=>{const t=e.w_size;let n,r,o,i,s;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-262)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,n=r;do{o=e.head[--n],e.head[n]=o>=t?o-t:0}while(--r);r=t,n=r;do{o=e.prev[--n],e.prev[n]=o>=t?o-t:0}while(--r);i+=t}if(0===e.strm.avail_in)break;if(r=wo(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=yo(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=yo(e,e.ins_h,e.window[s+3-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},Eo=(e,t)=>{let n,r;for(;;){if(e.lookahead<262){if(xo(e),e.lookahead<262&&t===Zr)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=Io(e,n)),e.match_length>=3)if(r=Pr(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=yo(e,e.ins_h,e.window[e.strstart+1]);else r=Pr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(mo(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Yr?(mo(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(mo(e,!1),0===e.strm.avail_out)?1:2},ko=(e,t)=>{let n,r,o;for(;;){if(e.lookahead<262){if(xo(e),e.lookahead<262&&t===Zr)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=Io(e,n),e.match_length<=5&&(e.strategy===io||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,r=Pr(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(mo(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=Pr(e,0,e.window[e.strstart-1]),r&&mo(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Pr(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Yr?(mo(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(mo(e,!1),0===e.strm.avail_out)?1:2};function So(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}const Oo=[new So(0,0,0,0,((e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(xo(e),0===e.lookahead&&t===Zr)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,mo(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(mo(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Yr?(mo(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(mo(e,!1),e.strm.avail_out),1)})),new So(4,4,8,4,Eo),new So(4,5,16,8,Eo),new So(4,6,32,32,Eo),new So(4,4,16,16,ko),new So(8,16,32,32,ko),new So(8,16,128,128,ko),new So(8,32,128,256,ko),new So(32,128,258,1024,ko),new So(32,258,258,4096,ko)];function jo(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ho,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),go(this.dyn_ltree),go(this.dyn_dtree),go(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),go(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),go(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ao=e=>{if(!e||!e.state)return fo(e,to);e.total_in=e.total_out=0,e.data_type=lo;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=Zr,Br(t),Qr},Ro=e=>{const t=Ao(e);var n;return t===Qr&&((n=e.state).window_size=2*n.w_size,go(n.head),n.max_lazy_match=Oo[n.level].max_lazy,n.good_match=Oo[n.level].good_length,n.nice_match=Oo[n.level].nice_length,n.max_chain_length=Oo[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Co=(e,t,n,r,o,i)=>{if(!e)return to;let s=1;if(t===oo&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),o<1||o>9||n!==ho||r<8||r>15||t<0||t>9||i<0||i>uo)return fo(e,to);8===r&&(r=9);const a=new jo;return e.state=a,a.strm=e,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=o+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<o+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=i,a.method=n,Ro(e)};tr.deflateInit=(e,t)=>Co(e,t,ho,15,8,co),tr.deflateInit2=Co,tr.deflateReset=Ro,tr.deflateResetKeep=Ao,tr.deflateSetHeader=(e,t)=>e&&e.state?2!==e.state.wrap?to:(e.state.gzhead=t,Qr):to,tr.deflate=(e,t)=>{let n,r;if(!e||!e.state||t>Xr||t<0)return e?fo(e,to):to;const o=e.state;if(!e.output||!e.input&&0!==e.avail_in||666===o.status&&t!==Yr)return fo(e,0===e.avail_out?ro:to);o.strm=e;const i=o.last_flush;if(o.last_flush=t,42===o.status)if(2===o.wrap)e.adler=0,vo(o,31),vo(o,139),vo(o,8),o.gzhead?(vo(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),vo(o,255&o.gzhead.time),vo(o,o.gzhead.time>>8&255),vo(o,o.gzhead.time>>16&255),vo(o,o.gzhead.time>>24&255),vo(o,9===o.level?2:o.strategy>=so||o.level<2?4:0),vo(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(vo(o,255&o.gzhead.extra.length),vo(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=Kr(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(vo(o,0),vo(o,0),vo(o,0),vo(o,0),vo(o,0),vo(o,9===o.level?2:o.strategy>=so||o.level<2?4:0),vo(o,3),o.status=113);else{let t=ho+(o.w_bits-8<<4)<<8,n=-1;n=o.strategy>=so||o.level<2?0:o.level<6?1:6===o.level?2:3,t|=n<<6,0!==o.strstart&&(t|=32),t+=31-t%31,o.status=113,bo(o,t),0!==o.strstart&&(bo(o,e.adler>>>16),bo(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(n=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>n&&(e.adler=Kr(e.adler,o.pending_buf,o.pending-n,n)),_o(e),n=o.pending,o.pending!==o.pending_buf_size));)vo(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>n&&(e.adler=Kr(e.adler,o.pending_buf,o.pending-n,n)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){n=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>n&&(e.adler=Kr(e.adler,o.pending_buf,o.pending-n,n)),_o(e),n=o.pending,o.pending===o.pending_buf_size)){r=1;break}r=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,vo(o,r)}while(0!==r);o.gzhead.hcrc&&o.pending>n&&(e.adler=Kr(e.adler,o.pending_buf,o.pending-n,n)),0===r&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){n=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>n&&(e.adler=Kr(e.adler,o.pending_buf,o.pending-n,n)),_o(e),n=o.pending,o.pending===o.pending_buf_size)){r=1;break}r=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,vo(o,r)}while(0!==r);o.gzhead.hcrc&&o.pending>n&&(e.adler=Kr(e.adler,o.pending_buf,o.pending-n,n)),0===r&&(o.status=103)}else o.status=103;if(103===o.status&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&_o(e),o.pending+2<=o.pending_buf_size&&(vo(o,255&e.adler),vo(o,e.adler>>8&255),e.adler=0,o.status=113)):o.status=113),0!==o.pending){if(_o(e),0===e.avail_out)return o.last_flush=-1,Qr}else if(0===e.avail_in&&po(t)<=po(i)&&t!==Yr)return fo(e,ro);if(666===o.status&&0!==e.avail_in)return fo(e,ro);if(0!==e.avail_in||0!==o.lookahead||t!==Zr&&666!==o.status){let n=o.strategy===so?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(xo(e),0===e.lookahead)){if(t===Zr)return 1;break}if(e.match_length=0,n=Pr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(mo(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Yr?(mo(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(mo(e,!1),0===e.strm.avail_out)?1:2})(o,t):o.strategy===ao?((e,t)=>{let n,r,o,i;const s=e.window;for(;;){if(e.lookahead<=258){if(xo(e),e.lookahead<=258&&t===Zr)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=e.strstart-1,r=s[o],r===s[++o]&&r===s[++o]&&r===s[++o])){i=e.strstart+258;do{}while(r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&o<i);e.match_length=258-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Pr(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Pr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(mo(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Yr?(mo(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(mo(e,!1),0===e.strm.avail_out)?1:2})(o,t):Oo[o.level].func(o,t);if(3!==n&&4!==n||(o.status=666),1===n||3===n)return 0===e.avail_out&&(o.last_flush=-1),Qr;if(2===n&&(t===Jr?Fr(o):t!==Xr&&($r(o,0,0,!1),t===Gr&&(go(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),_o(e),0===e.avail_out))return o.last_flush=-1,Qr}return t!==Yr?Qr:o.wrap<=0?eo:(2===o.wrap?(vo(o,255&e.adler),vo(o,e.adler>>8&255),vo(o,e.adler>>16&255),vo(o,e.adler>>24&255),vo(o,255&e.total_in),vo(o,e.total_in>>8&255),vo(o,e.total_in>>16&255),vo(o,e.total_in>>24&255)):(bo(o,e.adler>>>16),bo(o,65535&e.adler)),_o(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?Qr:eo)},tr.deflateEnd=e=>{if(!e||!e.state)return to;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?fo(e,to):(e.state=null,113===t?fo(e,no):Qr)},tr.deflateSetDictionary=(e,t)=>{let n=t.length;if(!e||!e.state)return to;const r=e.state,o=r.wrap;if(2===o||1===o&&42!==r.status||r.lookahead)return to;if(1===o&&(e.adler=Hr(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===o&&(go(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const i=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,xo(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=yo(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,xo(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=a,e.avail_in=i,r.wrap=o,Qr},tr.deflateInfo="pako deflate (from Nodeca project)";var To={};const zo=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);To.assign=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)zo(n,t)&&(e[t]=n[t])}}return e},To.flattenChunks=e=>{let t=0;for(let r=0,o=e.length;r<o;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,o=0,i=e.length;r<i;r++){let t=e[r];n.set(t,o),o+=t.length}return n};var No={};let Lo=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Cl){Lo=!1}const Do=new Uint8Array(256);for(let Tl=0;Tl<256;Tl++)Do[Tl]=Tl>=252?6:Tl>=248?5:Tl>=240?4:Tl>=224?3:Tl>=192?2:1;Do[254]=Do[254]=1,No.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,o,i,s=e.length,a=0;for(o=0;o<s;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<s&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),i=0,o=0;i<a;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<s&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t};No.buf2string=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,o;const i=new Array(2*n);for(o=0,r=0;r<n;){let t=e[r++];if(t<128){i[o++]=t;continue}let s=Do[t];if(s>4)i[o++]=65533,r+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&r<n;)t=t<<6|63&e[r++],s--;s>1?i[o++]=65533:t<65536?i[o++]=t:(t-=65536,i[o++]=55296|t>>10&1023,i[o++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Lo)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(i,o)},No.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Do[e[n]]>t?n:t};var Mo=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Uo=tr,Vo=To,Bo=No,$o=Ur,qo=Mo,Po=Object.prototype.toString,{Z_NO_FLUSH:Fo,Z_SYNC_FLUSH:Ho,Z_FULL_FLUSH:Ko,Z_FINISH:Wo,Z_OK:Zo,Z_STREAM_END:Jo,Z_DEFAULT_COMPRESSION:Go,Z_DEFAULT_STRATEGY:Yo,Z_DEFLATED:Xo}=Vr;function Qo(e){this.options=Vo.assign({level:Go,method:Xo,chunkSize:16384,windowBits:15,memLevel:8,strategy:Yo},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qo,this.strm.avail_out=0;let n=Uo.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Zo)throw new Error($o[n]);if(t.header&&Uo.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Bo.string2buf(t.dictionary):"[object ArrayBuffer]"===Po.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=Uo.deflateSetDictionary(this.strm,e),n!==Zo)throw new Error($o[n]);this._dict_set=!0}}function ei(e,t){const n=new Qo(t);if(n.push(e,!0),n.err)throw n.msg||$o[n.err];return n.result}Qo.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let o,i;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Wo:Fo,"string"==typeof e?n.input=Bo.string2buf(e):"[object ArrayBuffer]"===Po.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(i===Ho||i===Ko)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(o=Uo.deflate(n,i),o===Jo)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),o=Uo.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===Zo;if(0!==n.avail_out){if(i>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Qo.prototype.onData=function(e){this.chunks.push(e)},Qo.prototype.onEnd=function(e){e===Zo&&(this.result=Vo.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},er.Deflate=Qo,er.deflate=ei,er.deflateRaw=function(e,t){return(t=t||{}).raw=!0,ei(e,t)},er.gzip=function(e,t){return(t=t||{}).gzip=!0,ei(e,t)},er.constants=Vr;var ti={},ni={};const ri=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),oi=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ii=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),si=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);const ai=Lr,ui=Mr,ci=function(e,t){let n,r,o,i,s,a,u,c,l,h,f,d,p,g,y,_,m,v,b,w,I,x,E,k;const S=e.state;n=e.next_in,E=e.input,r=n+(e.avail_in-5),o=e.next_out,k=e.output,i=o-(t-e.avail_out),s=o+(e.avail_out-257),a=S.dmax,u=S.wsize,c=S.whave,l=S.wnext,h=S.window,f=S.hold,d=S.bits,p=S.lencode,g=S.distcode,y=(1<<S.lenbits)-1,_=(1<<S.distbits)-1;e:do{d<15&&(f+=E[n++]<<d,d+=8,f+=E[n++]<<d,d+=8),m=p[f&y];t:for(;;){if(v=m>>>24,f>>>=v,d-=v,v=m>>>16&255,0===v)k[o++]=65535&m;else{if(!(16&v)){if(0==(64&v)){m=p[(65535&m)+(f&(1<<v)-1)];continue t}if(32&v){S.mode=12;break e}e.msg="invalid literal/length code",S.mode=30;break e}b=65535&m,v&=15,v&&(d<v&&(f+=E[n++]<<d,d+=8),b+=f&(1<<v)-1,f>>>=v,d-=v),d<15&&(f+=E[n++]<<d,d+=8,f+=E[n++]<<d,d+=8),m=g[f&_];n:for(;;){if(v=m>>>24,f>>>=v,d-=v,v=m>>>16&255,!(16&v)){if(0==(64&v)){m=g[(65535&m)+(f&(1<<v)-1)];continue n}e.msg="invalid distance code",S.mode=30;break e}if(w=65535&m,v&=15,d<v&&(f+=E[n++]<<d,d+=8,d<v&&(f+=E[n++]<<d,d+=8)),w+=f&(1<<v)-1,w>a){e.msg="invalid distance too far back",S.mode=30;break e}if(f>>>=v,d-=v,v=o-i,w>v){if(v=w-v,v>c&&S.sane){e.msg="invalid distance too far back",S.mode=30;break e}if(I=0,x=h,0===l){if(I+=u-v,v<b){b-=v;do{k[o++]=h[I++]}while(--v);I=o-w,x=k}}else if(l<v){if(I+=u+l-v,v-=l,v<b){b-=v;do{k[o++]=h[I++]}while(--v);if(I=0,l<b){v=l,b-=v;do{k[o++]=h[I++]}while(--v);I=o-w,x=k}}}else if(I+=l-v,v<b){b-=v;do{k[o++]=h[I++]}while(--v);I=o-w,x=k}for(;b>2;)k[o++]=x[I++],k[o++]=x[I++],k[o++]=x[I++],b-=3;b&&(k[o++]=x[I++],b>1&&(k[o++]=x[I++]))}else{I=o-w;do{k[o++]=k[I++],k[o++]=k[I++],k[o++]=k[I++],b-=3}while(b>2);b&&(k[o++]=k[I++],b>1&&(k[o++]=k[I++]))}break}}break}}while(n<r&&o<s);b=d>>3,n-=b,d-=b<<3,f&=(1<<d)-1,e.next_in=n,e.next_out=o,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=o<s?s-o+257:257-(o-s),S.hold=f,S.bits=d},li=(e,t,n,r,o,i,s,a)=>{const u=a.bits;let c,l,h,f,d,p,g=0,y=0,_=0,m=0,v=0,b=0,w=0,I=0,x=0,E=0,k=null,S=0;const O=new Uint16Array(16),j=new Uint16Array(16);let A,R,C,T=null,z=0;for(g=0;g<=15;g++)O[g]=0;for(y=0;y<r;y++)O[t[n+y]]++;for(v=u,m=15;m>=1&&0===O[m];m--);if(v>m&&(v=m),0===m)return o[i++]=20971520,o[i++]=20971520,a.bits=1,0;for(_=1;_<m&&0===O[_];_++);for(v<_&&(v=_),I=1,g=1;g<=15;g++)if(I<<=1,I-=O[g],I<0)return-1;if(I>0&&(0===e||1!==m))return-1;for(j[1]=0,g=1;g<15;g++)j[g+1]=j[g]+O[g];for(y=0;y<r;y++)0!==t[n+y]&&(s[j[t[n+y]]++]=y);if(0===e?(k=T=s,p=19):1===e?(k=ri,S-=257,T=oi,z-=257,p=256):(k=ii,T=si,p=-1),E=0,y=0,g=_,d=i,b=v,w=0,h=-1,x=1<<v,f=x-1,1===e&&x>852||2===e&&x>592)return 1;for(;;){A=g-w,s[y]<p?(R=0,C=s[y]):s[y]>p?(R=T[z+s[y]],C=k[S+s[y]]):(R=96,C=0),c=1<<g-w,l=1<<b,_=l;do{l-=c,o[d+(E>>w)+l]=A<<24|R<<16|C|0}while(0!==l);for(c=1<<g-1;E&c;)c>>=1;if(0!==c?(E&=c-1,E+=c):E=0,y++,0==--O[g]){if(g===m)break;g=t[n+s[y]]}if(g>v&&(E&f)!==h){for(0===w&&(w=v),d+=_,b=g-w,I=1<<b;b+w<m&&(I-=O[b+w],!(I<=0));)b++,I<<=1;if(x+=1<<b,1===e&&x>852||2===e&&x>592)return 1;h=E&f,o[h]=v<<24|b<<16|d-i|0}}return 0!==E&&(o[d+E]=g-w<<24|64<<16|0),a.bits=v,0},{Z_FINISH:hi,Z_BLOCK:fi,Z_TREES:di,Z_OK:pi,Z_STREAM_END:gi,Z_NEED_DICT:yi,Z_STREAM_ERROR:_i,Z_DATA_ERROR:mi,Z_MEM_ERROR:vi,Z_BUF_ERROR:bi,Z_DEFLATED:wi}=Vr,Ii=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function xi(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ei=e=>{if(!e||!e.state)return _i;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,pi},ki=e=>{if(!e||!e.state)return _i;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ei(e)},Si=(e,t)=>{let n;if(!e||!e.state)return _i;const r=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?_i:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,ki(e))},Oi=(e,t)=>{if(!e)return _i;const n=new xi;e.state=n,n.window=null;const r=Si(e,t);return r!==pi&&(e.state=null),r};let ji,Ai,Ri=!0;const Ci=e=>{if(Ri){ji=new Int32Array(512),Ai=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(li(1,e.lens,0,288,ji,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;li(2,e.lens,0,32,Ai,0,e.work,{bits:5}),Ri=!1}e.lencode=ji,e.lenbits=9,e.distcode=Ai,e.distbits=5},Ti=(e,t,n,r)=>{let o;const i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(o=i.wsize-i.wnext,o>r&&(o=r),i.window.set(t.subarray(n-r,n-r+o),i.wnext),(r-=o)?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0};ni.inflateReset=ki,ni.inflateReset2=Si,ni.inflateResetKeep=Ei,ni.inflateInit=e=>Oi(e,15),ni.inflateInit2=Oi,ni.inflate=(e,t)=>{let n,r,o,i,s,a,u,c,l,h,f,d,p,g,y,_,m,v,b,w,I,x,E=0;const k=new Uint8Array(4);let S,O;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return _i;n=e.state,12===n.mode&&(n.mode=13),s=e.next_out,o=e.output,u=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,c=n.hold,l=n.bits,h=a,f=u,x=pi;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;l<16;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(2&n.wrap&&35615===c){n.check=0,k[0]=255&c,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0),c=0,l=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=30;break}if((15&c)!==wi){e.msg="unknown compression method",n.mode=30;break}if(c>>>=4,l-=4,I=8+(15&c),0===n.wbits)n.wbits=I;else if(I>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&c?10:12,c=0,l=0;break;case 2:for(;l<16;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(n.flags=c,(255&n.flags)!==wi){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0)),c=0,l=0,n.mode=3;case 3:for(;l<32;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}n.head&&(n.head.time=c),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,n.check=ui(n.check,k,4,0)),c=0,l=0,n.mode=4;case 4:for(;l<16;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0)),c=0,l=0,n.mode=5;case 5:if(1024&n.flags){for(;l<16;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,n.check=ui(n.check,k,2,0)),c=0,l=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(d=n.length,d>a&&(d=a),d&&(n.head&&(I=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+d),I)),512&n.flags&&(n.check=ui(n.check,r,d,i)),a-=d,i+=d,n.length-=d),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===a)break e;d=0;do{I=r[i+d++],n.head&&I&&n.length<65536&&(n.head.name+=String.fromCharCode(I))}while(I&&d<a);if(512&n.flags&&(n.check=ui(n.check,r,d,i)),a-=d,i+=d,I)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===a)break e;d=0;do{I=r[i+d++],n.head&&I&&n.length<65536&&(n.head.comment+=String.fromCharCode(I))}while(I&&d<a);if(512&n.flags&&(n.check=ui(n.check,r,d,i)),a-=d,i+=d,I)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;l<16;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}c=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;l<32;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}e.adler=n.check=Ii(c),c=0,l=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=a,n.hold=c,n.bits=l,yi;e.adler=n.check=1,n.mode=12;case 12:if(t===fi||t===di)break e;case 13:if(n.last){c>>>=7&l,l-=7&l,n.mode=27;break}for(;l<3;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}switch(n.last=1&c,c>>>=1,l-=1,3&c){case 0:n.mode=14;break;case 1:if(Ci(n),n.mode=20,t===di){c>>>=2,l-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}c>>>=2,l-=2;break;case 14:for(c>>>=7&l,l-=7&l;l<32;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&c,c=0,l=0,n.mode=15,t===di)break e;case 15:n.mode=16;case 16:if(d=n.length,d){if(d>a&&(d=a),d>u&&(d=u),0===d)break e;o.set(r.subarray(i,i+d),s),a-=d,i+=d,u-=d,s+=d,n.length-=d;break}n.mode=12;break;case 17:for(;l<14;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;l<3;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}n.lens[j[n.have++]]=7&c,c>>>=3,l-=3}for(;n.have<19;)n.lens[j[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},x=li(0,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,x){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;E=n.lencode[c&(1<<n.lenbits)-1],y=E>>>24,_=E>>>16&255,m=65535&E,!(y<=l);){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(m<16)c>>>=y,l-=y,n.lens[n.have++]=m;else{if(16===m){for(O=y+2;l<O;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(c>>>=y,l-=y,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}I=n.lens[n.have-1],d=3+(3&c),c>>>=2,l-=2}else if(17===m){for(O=y+3;l<O;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}c>>>=y,l-=y,I=0,d=3+(7&c),c>>>=3,l-=3}else{for(O=y+7;l<O;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}c>>>=y,l-=y,I=0,d=11+(127&c),c>>>=7,l-=7}if(n.have+d>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;d--;)n.lens[n.have++]=I}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,S={bits:n.lenbits},x=li(1,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,x){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},x=li(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,x){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,t===di)break e;case 20:n.mode=21;case 21:if(a>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=a,n.hold=c,n.bits=l,ci(e,f),s=e.next_out,o=e.output,u=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,c=n.hold,l=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;E=n.lencode[c&(1<<n.lenbits)-1],y=E>>>24,_=E>>>16&255,m=65535&E,!(y<=l);){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(_&&0==(240&_)){for(v=y,b=_,w=m;E=n.lencode[w+((c&(1<<v+b)-1)>>v)],y=E>>>24,_=E>>>16&255,m=65535&E,!(v+y<=l);){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}c>>>=v,l-=v,n.back+=v}if(c>>>=y,l-=y,n.back+=y,n.length=m,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=12;break}if(64&_){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(O=n.extra;l<O;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;E=n.distcode[c&(1<<n.distbits)-1],y=E>>>24,_=E>>>16&255,m=65535&E,!(y<=l);){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(0==(240&_)){for(v=y,b=_,w=m;E=n.distcode[w+((c&(1<<v+b)-1)>>v)],y=E>>>24,_=E>>>16&255,m=65535&E,!(v+y<=l);){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}c>>>=v,l-=v,n.back+=v}if(c>>>=y,l-=y,n.back+=y,64&_){e.msg="invalid distance code",n.mode=30;break}n.offset=m,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(O=n.extra;l<O;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===u)break e;if(d=f-u,n.offset>d){if(d=n.offset-d,d>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}d>n.wnext?(d-=n.wnext,p=n.wsize-d):p=n.wnext-d,d>n.length&&(d=n.length),g=n.window}else g=o,p=s-n.offset,d=n.length;d>u&&(d=u),u-=d,n.length-=d;do{o[s++]=g[p++]}while(--d);0===n.length&&(n.mode=21);break;case 26:if(0===u)break e;o[s++]=n.length,u--,n.mode=21;break;case 27:if(n.wrap){for(;l<32;){if(0===a)break e;a--,c|=r[i++]<<l,l+=8}if(f-=u,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?ui(n.check,o,f,s-f):ai(n.check,o,f,s-f)),f=u,(n.flags?c:Ii(c))!==n.check){e.msg="incorrect data check",n.mode=30;break}c=0,l=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;l<32;){if(0===a)break e;a--,c+=r[i++]<<l,l+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}c=0,l=0}n.mode=29;case 29:x=gi;break e;case 30:x=mi;break e;case 31:return vi;case 32:default:return _i}return e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=a,n.hold=c,n.bits=l,(n.wsize||f!==e.avail_out&&n.mode<30&&(n.mode<27||t!==hi))&&Ti(e,e.output,e.next_out,f-e.avail_out),h-=e.avail_in,f-=e.avail_out,e.total_in+=h,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?ui(n.check,o,f,e.next_out-f):ai(n.check,o,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===h&&0===f||t===hi)&&x===pi&&(x=bi),x},ni.inflateEnd=e=>{if(!e||!e.state)return _i;let t=e.state;return t.window&&(t.window=null),e.state=null,pi},ni.inflateGetHeader=(e,t)=>{if(!e||!e.state)return _i;const n=e.state;return 0==(2&n.wrap)?_i:(n.head=t,t.done=!1,pi)},ni.inflateSetDictionary=(e,t)=>{const n=t.length;let r,o,i;return e&&e.state?(r=e.state,0!==r.wrap&&11!==r.mode?_i:11===r.mode&&(o=1,o=ai(o,t,n,0),o!==r.check)?mi:(i=Ti(e,t,n,n),i?(r.mode=31,vi):(r.havedict=1,pi))):_i},ni.inflateInfo="pako inflate (from Nodeca project)";const zi=ni,Ni=To,Li=No,Di=Ur,Mi=Mo,Ui=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Vi=Object.prototype.toString,{Z_NO_FLUSH:Bi,Z_FINISH:$i,Z_OK:qi,Z_STREAM_END:Pi,Z_NEED_DICT:Fi,Z_STREAM_ERROR:Hi,Z_DATA_ERROR:Ki,Z_MEM_ERROR:Wi}=Vr;function Zi(e){this.options=Ni.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Mi,this.strm.avail_out=0;let n=zi.inflateInit2(this.strm,t.windowBits);if(n!==qi)throw new Error(Di[n]);if(this.header=new Ui,zi.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Li.string2buf(t.dictionary):"[object ArrayBuffer]"===Vi.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=zi.inflateSetDictionary(this.strm,t.dictionary),n!==qi)))throw new Error(Di[n])}function Ji(e,t){const n=new Zi(t);if(n.push(e),n.err)throw n.msg||Di[n.err];return n.result}Zi.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let i,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?$i:Bi,"[object ArrayBuffer]"===Vi.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=zi.inflate(n,s),i===Fi&&o&&(i=zi.inflateSetDictionary(n,o),i===qi?i=zi.inflate(n,s):i===Ki&&(i=Fi));n.avail_in>0&&i===Pi&&n.state.wrap>0&&0!==e[n.next_in];)zi.inflateReset(n),i=zi.inflate(n,s);switch(i){case Hi:case Ki:case Fi:case Wi:return this.onEnd(i),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||i===Pi))if("string"===this.options.to){let e=Li.utf8border(n.output,n.next_out),t=n.next_out-e,o=Li.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(o)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(i!==qi||0!==a){if(i===Pi)return i=zi.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Zi.prototype.onData=function(e){this.chunks.push(e)},Zi.prototype.onEnd=function(e){e===qi&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ni.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},ti.Inflate=Zi,ti.inflate=Ji,ti.inflateRaw=function(e,t){return(t=t||{}).raw=!0,Ji(e,t)},ti.ungzip=Ji,ti.constants=Vr;const{Deflate:Gi,deflate:Yi,deflateRaw:Xi,gzip:Qi}=er,{Inflate:es,inflate:ts,inflateRaw:ns,ungzip:rs}=ti,os=Vr;Qn.Deflate=Gi,Qn.deflate=Yi,Qn.deflateRaw=Xi,Qn.gzip=Qi,Qn.Inflate=es,Qn.inflate=ts,Qn.inflateRaw=ns,Qn.ungzip=rs,Qn.constants=os;const is=new TextEncoder,ss=new TextDecoder("utf-8");function as(e){return is.encode(e)}function us(e){return ss.decode(e)}function cs(e){if("string"!=typeof e)throw new TypeError("value is not a string");if(!/^([0-9a-f][0-9a-f])*$/.test(e))throw new RangeError("value is not hexadecimal");return""===e?new Uint8Array(0):new Uint8Array(e.match(/../g).map((e=>parseInt(e,16))))}function ls(e){const t=[];for(let n of e){if(n<0||n>255)throw new RangeError(`value does not fit in one byte: ${n}`);t.push(("0"+n.toString(16)).slice(-2))}return t.join("")}class hs{constructor(){this.buf=new Uint8Array(16),this.offset=0}get buffer(){return this.finish(),this.buf.subarray(0,this.offset)}grow(e=0){let t=4*this.buf.byteLength;for(;t<e;)t*=2;const n=new Uint8Array(t);return n.set(this.buf,0),this.buf=n,this}appendByte(e){this.offset>=this.buf.byteLength&&this.grow(),this.buf[this.offset]=e,this.offset+=1}appendUint32(e){if(!Number.isInteger(e))throw new RangeError("value is not an integer");if(e<0||e>4294967295)throw new RangeError("number out of range");const t=Math.max(1,Math.ceil((32-Math.clz32(e))/7));this.offset+t>this.buf.byteLength&&this.grow();for(let n=0;n<t;n++)this.buf[this.offset+n]=127&e|(n===t-1?0:128),e>>>=7;return this.offset+=t,t}appendInt32(e){if(!Number.isInteger(e))throw new RangeError("value is not an integer");if(e<-2147483648||e>2147483647)throw new RangeError("number out of range");const t=Math.ceil((33-Math.clz32(e>=0?e:-e-1))/7);this.offset+t>this.buf.byteLength&&this.grow();for(let n=0;n<t;n++)this.buf[this.offset+n]=127&e|(n===t-1?0:128),e>>=7;return this.offset+=t,t}appendUint53(e){if(!Number.isInteger(e))throw new RangeError("value is not an integer");if(e<0||e>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const t=Math.floor(e/4294967296),n=(4294967295&e)>>>0;return this.appendUint64(t,n)}appendInt53(e){if(!Number.isInteger(e))throw new RangeError("value is not an integer");if(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");const t=Math.floor(e/4294967296),n=(4294967295&e)>>>0;return this.appendInt64(t,n)}appendUint64(e,t){if(!Number.isInteger(e)||!Number.isInteger(t))throw new RangeError("value is not an integer");if(e<0||e>4294967295||t<0||t>4294967295)throw new RangeError("number out of range");if(0===e)return this.appendUint32(t);const n=Math.ceil((64-Math.clz32(e))/7);this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<4;r++)this.buf[this.offset+r]=127&t|128,t>>>=7;this.buf[this.offset+4]=15&t|(7&e)<<4|(5===n?0:128),e>>>=3;for(let r=5;r<n;r++)this.buf[this.offset+r]=127&e|(r===n-1?0:128),e>>>=7;return this.offset+=n,n}appendInt64(e,t){if(!Number.isInteger(e)||!Number.isInteger(t))throw new RangeError("value is not an integer");if(e<-2147483648||e>2147483647||t<-2147483648||t>4294967295)throw new RangeError("number out of range");if(t>>>=0,0===e&&t<=2147483647)return this.appendInt32(t);if(-1===e&&t>=2147483648)return this.appendInt32(t-4294967296);const n=Math.ceil((65-Math.clz32(e>=0?e:-e-1))/7);this.offset+n>this.buf.byteLength&&this.grow();for(let r=0;r<4;r++)this.buf[this.offset+r]=127&t|128,t>>>=7;this.buf[this.offset+4]=15&t|(7&e)<<4|(5===n?0:128),e>>=3;for(let r=5;r<n;r++)this.buf[this.offset+r]=127&e|(r===n-1?0:128),e>>=7;return this.offset+=n,n}appendRawBytes(e){return this.offset+e.byteLength>this.buf.byteLength&&this.grow(this.offset+e.byteLength),this.buf.set(e,this.offset),this.offset+=e.byteLength,e.byteLength}appendRawString(e){if("string"!=typeof e)throw new TypeError("value is not a string");return this.appendRawBytes(as(e))}appendPrefixedBytes(e){return this.appendUint53(e.byteLength),this.appendRawBytes(e),this}appendPrefixedString(e){if("string"!=typeof e)throw new TypeError("value is not a string");return this.appendPrefixedBytes(as(e)),this}appendHexString(e){return this.appendPrefixedBytes(cs(e)),this}finish(){}}class fs{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError(`Not a byte array: ${e}`);this.buf=e,this.offset=0}get done(){return this.offset===this.buf.byteLength}reset(){this.offset=0}skip(e){if(this.offset+e>this.buf.byteLength)throw new RangeError("cannot skip beyond end of buffer");this.offset+=e}readByte(){return this.offset+=1,this.buf[this.offset-1]}readUint32(){let e=0,t=0;for(;this.offset<this.buf.byteLength;){const n=this.buf[this.offset];if(28===t&&0!=(240&n))throw new RangeError("number out of range");if(e=(e|(127&n)<<t)>>>0,t+=7,this.offset++,0==(128&n))return e}throw new RangeError("buffer ended with incomplete number")}readInt32(){let e=0,t=0;for(;this.offset<this.buf.byteLength;){const n=this.buf[this.offset];if(28===t&&0!=(128&n)||28===t&&0==(64&n)&&0!=(56&n)||28===t&&0!=(64&n)&&56!=(56&n))throw new RangeError("number out of range");if(e|=(127&n)<<t,t+=7,this.offset++,0==(128&n))return 0==(64&n)||t>28?e:e|-1<<t}throw new RangeError("buffer ended with incomplete number")}readUint53(){const{low32:e,high32:t}=this.readUint64();if(t<0||t>2097151)throw new RangeError("number out of range");return 4294967296*t+e}readInt53(){const{low32:e,high32:t}=this.readInt64();if(t<-2097152||-2097152===t&&0===e||t>2097151)throw new RangeError("number out of range");return 4294967296*t+e}readUint64(){let e=0,t=0,n=0;for(;this.offset<this.buf.byteLength&&n<=28;){const r=this.buf[this.offset];if(e=(e|(127&r)<<n)>>>0,28===n&&(t=(112&r)>>>4),n+=7,this.offset++,0==(128&r))return{high32:t,low32:e}}for(n=3;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(31===n&&0!=(254&r))throw new RangeError("number out of range");if(t=(t|(127&r)<<n)>>>0,n+=7,this.offset++,0==(128&r))return{high32:t,low32:e}}throw new RangeError("buffer ended with incomplete number")}readInt64(){let e=0,t=0,n=0;for(;this.offset<this.buf.byteLength&&n<=28;){const r=this.buf[this.offset];if(e=(e|(127&r)<<n)>>>0,28===n&&(t=(112&r)>>>4),n+=7,this.offset++,0==(128&r))return 0!=(64&r)&&(n<32&&(e=(e|-1<<n)>>>0),t|=-1<<Math.max(n-32,0)),{high32:t,low32:e}}for(n=3;this.offset<this.buf.byteLength;){const r=this.buf[this.offset];if(31===n&&0!==r&&127!==r)throw new RangeError("number out of range");if(t|=(127&r)<<n,n+=7,this.offset++,0==(128&r))return 0!=(64&r)&&n<32&&(t|=-1<<n),{high32:t,low32:e}}throw new RangeError("buffer ended with incomplete number")}readRawBytes(e){const t=this.offset;if(t+e>this.buf.byteLength)throw new RangeError("subarray exceeds buffer size");return this.offset+=e,this.buf.subarray(t,this.offset)}readRawString(e){return us(this.readRawBytes(e))}readPrefixedBytes(){return this.readRawBytes(this.readUint53())}readPrefixedString(){return us(this.readPrefixedBytes())}readHexString(){return ls(this.readPrefixedBytes())}}class ds extends hs{constructor(e){super(),this.type=e,this.state="empty",this.lastValue=void 0,this.count=0,this.literal=[]}appendValue(e,t=1){this._appendValue(e,t)}_appendValue(e,t=1){t<=0||("empty"===this.state?(this.state=null===e?"nulls":1===t?"loneValue":"repetition",this.lastValue=e,this.count=t):"loneValue"===this.state?null===e?(this.flush(),this.state="nulls",this.count=t):e===this.lastValue?(this.state="repetition",this.count=1+t):t>1?(this.flush(),this.state="repetition",this.count=t,this.lastValue=e):(this.state="literal",this.literal=[this.lastValue],this.lastValue=e):"repetition"===this.state?null===e?(this.flush(),this.state="nulls",this.count=t):e===this.lastValue?this.count+=t:t>1?(this.flush(),this.state="repetition",this.count=t,this.lastValue=e):(this.flush(),this.state="loneValue",this.lastValue=e):"literal"===this.state?null===e?(this.literal.push(this.lastValue),this.flush(),this.state="nulls",this.count=t):e===this.lastValue?(this.flush(),this.state="repetition",this.count=1+t):t>1?(this.literal.push(this.lastValue),this.flush(),this.state="repetition",this.count=t,this.lastValue=e):(this.literal.push(this.lastValue),this.lastValue=e):"nulls"===this.state&&(null===e?this.count+=t:t>1?(this.flush(),this.state="repetition",this.count=t,this.lastValue=e):(this.flush(),this.state="loneValue",this.lastValue=e)))}copyFrom(e,t={}){const{count:n,sumValues:r,sumShift:o}=t;if(!(e instanceof ps)||e.type!==this.type)throw new TypeError("incompatible type of decoder");let i="number"==typeof n?n:Number.MAX_SAFE_INTEGER,s=0,a=0;if(n&&i>0&&e.done)throw new RangeError(`cannot copy ${n} values`);if(0===i||e.done)return r?{nonNullValues:s,sum:a}:{nonNullValues:s};let u=e.readValue();if(null===u){const t=Math.min(e.count+1,i);if(i-=t,e.count-=t-1,this.appendValue(null,t),n&&i>0&&e.done)throw new RangeError(`cannot copy ${n} values`);if(0===i||e.done)return r?{nonNullValues:s,sum:a}:{nonNullValues:s};if(u=e.readValue(),null===u)throw new RangeError("null run must be followed by non-null value")}if(this.appendValue(u),i--,s++,r&&(a+=o?u>>>o:u),n&&i>0&&e.done)throw new RangeError(`cannot copy ${n} values`);if(0===i||e.done)return r?{nonNullValues:s,sum:a}:{nonNullValues:s};let c=e.count>0;for(;i>0&&!e.done;){c||e.readRecord();const t=Math.min(e.count,i);if(e.count-=t,"literal"===e.state){s+=t;for(let n=0;n<t;n++){if(e.done)throw new RangeError("incomplete literal");const t=e.readRawValue();if(t===e.lastValue)throw new RangeError("Repetition of values is not allowed in literal");e.lastValue=t,this._appendValue(t),r&&(a+=o?t>>>o:t)}}else if("repetition"===e.state){s+=t,r&&(a+=t*(o?e.lastValue>>>o:e.lastValue));const n=e.lastValue;if(this._appendValue(n),t>1){if(this._appendValue(n),"repetition"!==this.state)throw new RangeError(`Unexpected state ${this.state}`);this.count+=t-2}}else if("nulls"===e.state){if(this._appendValue(null),"nulls"!==this.state)throw new RangeError(`Unexpected state ${this.state}`);this.count+=t-1}c=!1,i-=t}if(n&&i>0&&e.done)throw new RangeError(`cannot copy ${n} values`);return r?{nonNullValues:s,sum:a}:{nonNullValues:s}}flush(){if("loneValue"===this.state)this.appendInt32(-1),this.appendRawValue(this.lastValue);else if("repetition"===this.state)this.appendInt53(this.count),this.appendRawValue(this.lastValue);else if("literal"===this.state){this.appendInt53(-this.literal.length);for(let e of this.literal)this.appendRawValue(e)}else"nulls"===this.state&&(this.appendInt32(0),this.appendUint53(this.count));this.state="empty"}appendRawValue(e){if("int"===this.type)this.appendInt53(e);else if("uint"===this.type)this.appendUint53(e);else{if("utf8"!==this.type)throw new RangeError(`Unknown RLEEncoder datatype: ${this.type}`);this.appendPrefixedString(e)}}finish(){"literal"===this.state&&this.literal.push(this.lastValue),("nulls"!==this.state||this.offset>0)&&this.flush()}}class ps extends fs{constructor(e,t){super(t),this.type=e,this.lastValue=void 0,this.count=0,this.state=void 0}get done(){return 0===this.count&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0}readValue(){if(this.done)return null;if(0===this.count&&this.readRecord(),this.count-=1,"literal"===this.state){const e=this.readRawValue();if(e===this.lastValue)throw new RangeError("Repetition of values is not allowed in literal");return this.lastValue=e,e}return this.lastValue}skipValues(e){for(;e>0&&!this.done;){0===this.count&&(this.count=this.readInt53(),this.count>0?(this.lastValue=this.count<=e?this.skipRawValues(1):this.readRawValue(),this.state="repetition"):this.count<0?(this.count=-this.count,this.state="literal"):(this.count=this.readUint53(),this.lastValue=null,this.state="nulls"));const t=Math.min(e,this.count);"literal"===this.state&&this.skipRawValues(t),e-=t,this.count-=t}}readRecord(){if(this.count=this.readInt53(),this.count>1){const e=this.readRawValue();if(("repetition"===this.state||"literal"===this.state)&&this.lastValue===e)throw new RangeError("Successive repetitions with the same value are not allowed");this.state="repetition",this.lastValue=e}else{if(1===this.count)throw new RangeError("Repetition count of 1 is not allowed, use a literal instead");if(this.count<0){if(this.count=-this.count,"literal"===this.state)throw new RangeError("Successive literals are not allowed");this.state="literal"}else{if("nulls"===this.state)throw new RangeError("Successive null runs are not allowed");if(this.count=this.readUint53(),0===this.count)throw new RangeError("Zero-length null runs are not allowed");this.lastValue=null,this.state="nulls"}}}readRawValue(){if("int"===this.type)return this.readInt53();if("uint"===this.type)return this.readUint53();if("utf8"===this.type)return this.readPrefixedString();throw new RangeError(`Unknown RLEDecoder datatype: ${this.type}`)}skipRawValues(e){if("utf8"===this.type)for(let t=0;t<e;t++)this.skip(this.readUint53());else{for(;e>0&&this.offset<this.buf.byteLength;)0==(128&this.buf[this.offset])&&e--,this.offset++;if(e>0)throw new RangeError("cannot skip beyond end of buffer")}}}class gs extends ps{constructor(e){super("int",e),this.absoluteValue=0}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0,this.absoluteValue=0}readValue(){const e=super.readValue();return null===e?null:(this.absoluteValue+=e,this.absoluteValue)}skipValues(e){for(;e>0&&!this.done;){0===this.count&&this.readRecord();const t=Math.min(e,this.count);if("literal"===this.state)for(let e=0;e<t;e++)this.lastValue=this.readRawValue(),this.absoluteValue+=this.lastValue;else"repetition"===this.state&&(this.absoluteValue+=t*this.lastValue);e-=t,this.count-=t}}}class ys extends fs{constructor(e){super(e),this.lastValue=!0,this.firstRun=!0,this.count=0}get done(){return 0===this.count&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=!0,this.firstRun=!0,this.count=0}readValue(){if(this.done)return!1;for(;0===this.count;){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,0===this.count&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}return this.count-=1,this.lastValue}skipValues(e){for(;e>0&&!this.done;){if(0===this.count&&(this.count=this.readUint53(),this.lastValue=!this.lastValue,0===this.count))throw new RangeError("Zero-length runs are not allowed");this.count<e?(e-=this.count,this.count=0):(this.count-=e,e=0)}}}var _s,ms={stringToUtf8:as,utf8ToString:us,hexStringToBytes:cs,bytesToHexString:ls,Encoder:hs,Decoder:fs,RLEEncoder:ds,RLEDecoder:ps,DeltaEncoder:class extends ds{constructor(){super("int"),this.absoluteValue=0}appendValue(e,t=1){t<=0||("number"==typeof e?(super.appendValue(e-this.absoluteValue,1),this.absoluteValue=e,t>1&&super.appendValue(0,t-1)):super.appendValue(e,t))}copyFrom(e,t={}){if(t.sumValues)throw new RangeError("unsupported options for DeltaEncoder.copyFrom()");if(!(e instanceof gs))throw new TypeError("incompatible type of decoder");let n=t.count;if(n>0&&e.done)throw new RangeError(`cannot copy ${n} values`);if(0===n||e.done)return;let r=e.readValue(),o=0;if(this.appendValue(r),null===r){if(o=e.count+1,void 0!==n&&n<o&&(o=n),e.count-=o-1,this.count+=o-1,n>o&&e.done)throw new RangeError(`cannot copy ${n} values`);if(n===o||e.done)return;0===e.count&&this.appendValue(e.readValue())}void 0!==n&&(n-=o+1);const{nonNullValues:i,sum:s}=super.copyFrom(e,{count:n,sumValues:!0});i>0&&(this.absoluteValue=s,e.absoluteValue=s)}},DeltaDecoder:gs,BooleanEncoder:class extends hs{constructor(){super(),this.lastValue=!1,this.count=0}appendValue(e,t=1){if(!1!==e&&!0!==e)throw new RangeError(`Unsupported value for BooleanEncoder: ${e}`);t<=0||(this.lastValue===e?this.count+=t:(this.appendUint53(this.count),this.lastValue=e,this.count=t))}copyFrom(e,t={}){if(!(e instanceof ys))throw new TypeError("incompatible type of decoder");const{count:n}=t;let r="number"==typeof n?n:Number.MAX_SAFE_INTEGER;if(n&&r>0&&e.done)throw new RangeError(`cannot copy ${n} values`);if(0===r||e.done)return;this.appendValue(e.readValue()),r--;const o=Math.min(e.count,r);for(this.count+=o,e.count-=o,r-=o;r>0&&!e.done;){if(e.count=e.readUint53(),0===e.count)throw new RangeError("Zero-length runs are not allowed");e.lastValue=!e.lastValue,this.appendUint53(this.count);const t=Math.min(e.count,r);this.count=t,this.lastValue=e.lastValue,e.count-=t,r-=t}if(n&&r>0&&e.done)throw new RangeError(`cannot copy ${n} values`)}finish(){this.count>0&&(this.appendUint53(this.count),this.count=0)}},BooleanDecoder:ys},vs={exports:{}};_s=vs,function(e,t){var n={};!function(e){e.__esModule=!0,e.digestLength=32,e.blockSize=64;var t=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function n(e,n,r,o,i){for(var s,a,u,c,l,h,f,d,p,g,y,_,m;i>=64;){for(s=n[0],a=n[1],u=n[2],c=n[3],l=n[4],h=n[5],f=n[6],d=n[7],g=0;g<16;g++)y=o+4*g,e[g]=(255&r[y])<<24|(255&r[y+1])<<16|(255&r[y+2])<<8|255&r[y+3];for(g=16;g<64;g++)_=((p=e[g-2])>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,m=((p=e[g-15])>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,e[g]=(_+e[g-7]|0)+(m+e[g-16]|0);for(g=0;g<64;g++)_=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&h^~l&f)|0)+(d+(t[g]+e[g]|0)|0)|0,m=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&a^s&u^a&u)|0,d=f,f=h,h=l,l=c+_|0,c=u,u=a,a=s,s=_+m|0;n[0]+=s,n[1]+=a,n[2]+=u,n[3]+=c,n[4]+=l,n[5]+=h,n[6]+=f,n[7]+=d,o+=64,i-=64}return o}var r=function(){function t(){this.digestLength=e.digestLength,this.blockSize=e.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return t.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},t.prototype.clean=function(){for(var e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()},t.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var r=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[r++],t--;64===this.bufferLength&&(n(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(r=n(this.temp,this.state,e,r,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[r++],t--;return this},t.prototype.finish=function(e){if(!this.finished){var t=this.bytesHashed,r=this.bufferLength,o=t/536870912|0,i=t<<3,s=t%64<56?64:128;this.buffer[r]=128;for(var a=r+1;a<s-8;a++)this.buffer[a]=0;this.buffer[s-8]=o>>>24&255,this.buffer[s-7]=o>>>16&255,this.buffer[s-6]=o>>>8&255,this.buffer[s-5]=o>>>0&255,this.buffer[s-4]=i>>>24&255,this.buffer[s-3]=i>>>16&255,this.buffer[s-2]=i>>>8&255,this.buffer[s-1]=i>>>0&255,n(this.temp,this.state,this.buffer,0,s),this.finished=!0}for(a=0;a<8;a++)e[4*a+0]=this.state[a]>>>24&255,e[4*a+1]=this.state[a]>>>16&255,e[4*a+2]=this.state[a]>>>8&255,e[4*a+3]=this.state[a]>>>0&255;return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype._saveState=function(e){for(var t=0;t<this.state.length;t++)e[t]=this.state[t]},t.prototype._restoreState=function(e,t){for(var n=0;n<this.state.length;n++)this.state[n]=e[n];this.bytesHashed=t,this.finished=!1,this.bufferLength=0},t}();e.Hash=r;var o=function(){function e(e){this.inner=new r,this.outer=new r,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var t=new Uint8Array(this.blockSize);if(e.length>this.blockSize)(new r).update(e).finish(t).clean();else for(var n=0;n<e.length;n++)t[n]=e[n];for(n=0;n<t.length;n++)t[n]^=54;for(this.inner.update(t),n=0;n<t.length;n++)t[n]^=106;for(this.outer.update(t),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate),n=0;n<t.length;n++)t[n]=0}return e.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},e.prototype.clean=function(){for(var e=0;e<this.istate.length;e++)this.ostate[e]=this.istate[e]=0;this.inner.clean(),this.outer.clean()},e.prototype.update=function(e){return this.inner.update(e),this},e.prototype.finish=function(e){return this.outer.finished?this.outer.finish(e):(this.inner.finish(e),this.outer.update(e,this.digestLength).finish(e)),this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e}();function i(e){var t=(new r).update(e),n=t.digest();return t.clean(),n}function s(e,t){var n=new o(e).update(t),r=n.digest();return n.clean(),r}function a(e,t,n,r){var o=r[0];if(0===o)throw new Error("hkdf: cannot expand more");t.reset(),o>1&&t.update(e),n&&t.update(n),t.update(r),t.finish(e),r[0]++}e.HMAC=o,e.hash=i,e.default=i,e.hmac=s;var u=new Uint8Array(e.digestLength);function c(e,t,n,r){void 0===t&&(t=u),void 0===r&&(r=32);for(var i=new Uint8Array([1]),c=s(t,e),l=new o(c),h=new Uint8Array(l.digestLength),f=h.length,d=new Uint8Array(r),p=0;p<r;p++)f===h.length&&(a(h,l,n,i),f=0),d[p]=h[f++];return l.clean(),h.fill(0),i.fill(0),d}function l(e,t,n,r){for(var i=new o(e),s=i.digestLength,a=new Uint8Array(4),u=new Uint8Array(s),c=new Uint8Array(s),l=new Uint8Array(r),h=0;h*s<r;h++){var f=h+1;a[0]=f>>>24&255,a[1]=f>>>16&255,a[2]=f>>>8&255,a[3]=f>>>0&255,i.reset(),i.update(t),i.update(a),i.finish(c);for(var d=0;d<s;d++)u[d]=c[d];for(d=2;d<=n;d++){i.reset(),i.update(c).finish(c);for(var p=0;p<s;p++)u[p]^=c[p]}for(d=0;d<s&&h*s+d<r;d++)l[h*s+d]=u[d]}for(h=0;h<s;h++)u[h]=c[h]=0;for(h=0;h<4;h++)a[h]=0;return i.clean(),l}e.hkdf=c,e.pbkdf2=l}(n);var r=n.default;for(var o in n)r[o]=n[o];_s.exports=r}();const bs=Qn,{copyObject:ws,parseOpId:Is,equalBytes:xs}=ct,{utf8ToString:Es,hexStringToBytes:ks,bytesToHexString:Ss,Encoder:Os,Decoder:js,RLEEncoder:As,RLEDecoder:Rs,DeltaEncoder:Cs,DeltaDecoder:Ts,BooleanEncoder:zs,BooleanDecoder:Ns}=ms,{Hash:Ls}=vs.exports,Ds=new Uint8Array([133,111,74,131]),Ms={GROUP_CARD:0,ACTOR_ID:1,INT_RLE:2,INT_DELTA:3,BOOLEAN:4,STRING_RLE:5,VALUE_LEN:6,VALUE_RAW:7},Us={NULL:0,FALSE:1,TRUE:2,LEB128_UINT:3,LEB128_INT:4,IEEE754:5,UTF8:6,BYTES:7,COUNTER:8,TIMESTAMP:9,MIN_UNKNOWN:10,MAX_UNKNOWN:15},Vs=["makeMap","set","makeList","del","makeText","inc","makeTable","link"],Bs={makeMap:"map",makeList:"list",makeText:"text",makeTable:"table"},$s={objActor:0|Ms.ACTOR_ID,objCtr:0|Ms.INT_RLE,keyActor:16|Ms.ACTOR_ID,keyCtr:16|Ms.INT_DELTA,keyStr:16|Ms.STRING_RLE,idActor:32|Ms.ACTOR_ID,idCtr:32|Ms.INT_DELTA,insert:48|Ms.BOOLEAN,action:64|Ms.INT_RLE,valLen:80|Ms.VALUE_LEN,valRaw:80|Ms.VALUE_RAW,chldActor:96|Ms.ACTOR_ID,chldCtr:96|Ms.INT_DELTA},qs=Object.assign({predNum:112|Ms.GROUP_CARD,predActor:112|Ms.ACTOR_ID,predCtr:112|Ms.INT_DELTA},$s),Ps=Object.assign({succNum:128|Ms.GROUP_CARD,succActor:128|Ms.ACTOR_ID,succCtr:128|Ms.INT_DELTA},$s),Fs=Object.entries(Ps).reduce(((e,[t,n])=>(e[n]=t,e)),[]),Hs={actor:0|Ms.ACTOR_ID,seq:0|Ms.INT_DELTA,maxOp:16|Ms.INT_DELTA,time:32|Ms.INT_DELTA,message:48|Ms.STRING_RLE,depsNum:64|Ms.GROUP_CARD,depsIndex:64|Ms.INT_DELTA,extraLen:80|Ms.VALUE_LEN,extraRaw:80|Ms.VALUE_RAW};function Ks(e,t,n){if(1===t.length)e[t[0]]=n;else{let r=Object.assign({},e[t[0]]);Ks(r,t.slice(1),n),e[t[0]]=r}}function Ws(e,t){if(!e||!e.actorId)return e;const n=e.counter,r=t.indexOf(e.actorId);if(r<0)throw new RangeError("missing actorId");return{counter:n,actorNum:r,actorId:e.actorId}}function Zs(e,t){return e.counter<t.counter?-1:e.counter>t.counter?1:e.actorId<t.actorId?-1:e.actorId>t.actorId?1:0}function Js(e,t){const n={},r=[];for(let i of e)i=ws(i),n[i.actor]=!0,i.ops=oa(i.ops,i.startOp,i.actor),i.ops=i.ops.map((e=>{"_root"!==(e=ws(e)).obj&&(e.obj=Is(e.obj)),e.elemId&&"_head"!==e.elemId&&(e.elemId=Is(e.elemId)),e.child&&(e.child=Is(e.child)),e.pred&&(e.pred=e.pred.map(Is)),e.obj.actorId&&(n[e.obj.actorId]=!0),e.elemId&&e.elemId.actorId&&(n[e.elemId.actorId]=!0),e.child&&e.child.actorId&&(n[e.child.actorId]=!0);for(let t of e.pred)n[t.actorId]=!0;return e})),r.push(i);let o=Object.keys(n).sort();t&&(o=[e[0].actor].concat(o.filter((t=>t!==e[0].actor))));for(let i of r){i.actorNum=o.indexOf(i.actor);for(let e=0;e<i.ops.length;e++){let t=i.ops[e];t.id={counter:i.startOp+e,actorNum:i.actorNum,actorId:i.actor},t.obj=Ws(t.obj,o),t.elemId=Ws(t.elemId,o),t.child=Ws(t.child,o),t.pred=t.pred.map((e=>Ws(e,o)))}}return{changes:r,actorIds:o}}function Gs(e,t){if("_root"===e.obj)t.objActor.appendValue(null),t.objCtr.appendValue(null);else{if(!(e.obj.actorNum>=0&&e.obj.counter>0))throw new RangeError(`Unexpected objectId reference: ${JSON.stringify(e.obj)}`);t.objActor.appendValue(e.obj.actorNum),t.objCtr.appendValue(e.obj.counter)}}function Ys(e,t){if(e.key)t.keyActor.appendValue(null),t.keyCtr.appendValue(null),t.keyStr.appendValue(e.key);else if("_head"===e.elemId&&e.insert)t.keyActor.appendValue(null),t.keyCtr.appendValue(0),t.keyStr.appendValue(null);else{if(!(e.elemId&&e.elemId.actorNum>=0&&e.elemId.counter>0))throw new RangeError(`Unexpected operation key: ${JSON.stringify(e)}`);t.keyActor.appendValue(e.elemId.actorNum),t.keyCtr.appendValue(e.elemId.counter),t.keyStr.appendValue(null)}}function Xs(e,t){const n=Vs.indexOf(e.action);if(n>=0)t.action.appendValue(n);else{if("number"!=typeof e.action)throw new RangeError(`Unexpected operation action: ${e.action}`);t.action.appendValue(e.action)}}function Qs(e,t){if("set"!==e.action&&"inc"!==e.action||null===e.value)t.valLen.appendValue(Us.NULL);else if(!1===e.value)t.valLen.appendValue(Us.FALSE);else if(!0===e.value)t.valLen.appendValue(Us.TRUE);else if("string"==typeof e.value){const n=t.valRaw.appendRawString(e.value);t.valLen.appendValue(n<<4|Us.UTF8)}else if(ArrayBuffer.isView(e.value)){const n=t.valRaw.appendRawBytes(new Uint8Array(e.value.buffer));t.valLen.appendValue(n<<4|Us.BYTES)}else if("number"==typeof e.value){let n,[r,o]=function(e){switch(e.datatype){case"counter":return[Us.COUNTER,e.value];case"timestamp":return[Us.TIMESTAMP,e.value];case"uint":return[Us.LEB128_UINT,e.value];case"int":return[Us.LEB128_INT,e.value];case"float64":{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[Us.IEEE754,new Uint8Array(t)]}default:if(Number.isInteger(e.value)&&e.value<=Number.MAX_SAFE_INTEGER&&e.value>=Number.MIN_SAFE_INTEGER)return[Us.LEB128_INT,e.value];{const t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e.value,!0),[Us.IEEE754,new Uint8Array(t)]}}}(e);n=r===Us.LEB128_UINT?t.valRaw.appendUint53(o):r===Us.IEEE754?t.valRaw.appendRawBytes(o):t.valRaw.appendInt53(o),t.valLen.appendValue(n<<4|r)}else{if(!("number"==typeof e.datatype&&e.datatype>=Us.MIN_UNKNOWN&&e.datatype<=Us.MAX_UNKNOWN&&e.value instanceof Uint8Array))throw e.datatype?new RangeError(`Unknown datatype ${e.datatype} for value ${e.value}`):new RangeError(`Unsupported value in operation: ${e.value}`);{const n=t.valRaw.appendRawBytes(e.value);t.valLen.appendValue(n<<4|e.datatype)}}}function ea(e,t){if(e===Us.NULL)return{value:null};if(e===Us.FALSE)return{value:!1};if(e===Us.TRUE)return{value:!0};if(e%16===Us.UTF8)return{value:Es(t)};if(e%16===Us.LEB128_UINT)return{value:new js(t).readUint53(),datatype:"uint"};if(e%16===Us.LEB128_INT)return{value:new js(t).readInt53(),datatype:"int"};if(e%16===Us.IEEE754){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);if(8===t.byteLength)return{value:e.getFloat64(0,!0),datatype:"float64"};throw new RangeError(`Invalid length for floating point number: ${t.byteLength}`)}return e%16===Us.COUNTER?{value:new js(t).readInt53(),datatype:"counter"}:e%16===Us.TIMESTAMP?{value:new js(t).readInt53(),datatype:"timestamp"}:{value:t,datatype:e%16}}function ta(e,t,n,r){const{columnId:o,columnName:i,decoder:s}=e[t];if(o%8===Ms.VALUE_LEN&&t+1<e.length&&e[t+1].columnId===o+1){const n=s.readValue(),o=e[t+1].decoder.readRawBytes(n>>4),{value:a,datatype:u}=ea(n,o);return r[i]=a,u&&(r[i+"_datatype"]=u),2}if(o%8===Ms.ACTOR_ID){const e=s.readValue();if(null===e)r[i]=null;else{if(!n[e])throw new RangeError(`No actor index ${e}`);r[i]=n[e]}}else r[i]=s.readValue();return 1}function na(e,t){const n={objActor:new As("uint"),objCtr:new As("uint"),keyActor:new As("uint"),keyCtr:new Cs,keyStr:new As("utf8"),insert:new zs,action:new As("uint"),valLen:new As("uint"),valRaw:new Os,chldActor:new As("uint"),chldCtr:new Cs};t?(n.idActor=new As("uint"),n.idCtr=new Cs,n.succNum=new As("uint"),n.succActor=new As("uint"),n.succCtr=new Cs):(n.predNum=new As("uint"),n.predCtr=new Cs,n.predActor=new As("uint"));for(let o of e)if(Gs(o,n),Ys(o,n),n.insert.appendValue(!!o.insert),Xs(o,n),Qs(o,n),o.child&&o.child.counter?(n.chldActor.appendValue(o.child.actorNum),n.chldCtr.appendValue(o.child.counter)):(n.chldActor.appendValue(null),n.chldCtr.appendValue(null)),t){n.idActor.appendValue(o.id.actorNum),n.idCtr.appendValue(o.id.counter),n.succNum.appendValue(o.succ.length),o.succ.sort(Zs);for(let e=0;e<o.succ.length;e++)n.succActor.appendValue(o.succ[e].actorNum),n.succCtr.appendValue(o.succ[e].counter)}else{n.predNum.appendValue(o.pred.length),o.pred.sort(Zs);for(let e=0;e<o.pred.length;e++)n.predActor.appendValue(o.pred[e].actorNum),n.predCtr.appendValue(o.pred[e].counter)}let r=[];for(let[o,i]of Object.entries(t?Ps:qs))n[o]&&r.push({id:i,name:o,encoder:n[o]});return r.sort(((e,t)=>e.id-t.id))}function ra(e,t){return void 0===t?"string"==typeof e||"boolean"==typeof e||null===e:"number"==typeof e}function oa(e,t,n){let r=t,o=[];for(const i of e)if("set"===i.action&&i.values&&i.insert){if(0!==i.pred.length)throw new RangeError("multi-insert pred must be empty");let e=i.elemId;const t=i.datatype;for(const s of i.values){if(!ra(s,t))throw new RangeError(`Decode failed: bad value/datatype association (${s},${t})`);o.push({action:"set",obj:i.obj,elemId:e,datatype:t,value:s,pred:[],insert:!0}),e=`${r}@${n}`,r+=1}}else if("del"===i.action&&i.multiOp>1){if(1!==i.pred.length)throw new RangeError("multiOp deletion must have exactly one pred");const e=Is(i.elemId),t=Is(i.pred[0]);for(let n=0;n<i.multiOp;n++){const s=`${e.counter+n}@${e.actorId}`,a=[`${t.counter+n}@${t.actorId}`];o.push({action:"del",obj:i.obj,elemId:s,pred:a}),r+=1}}else o.push(i),r+=1;return o}function ia(e,t){const n=[];for(let r of e){const e=null===r.objCtr?"_root":`${r.objCtr}@${r.objActor}`,o=r.keyStr?void 0:0===r.keyCtr?"_head":`${r.keyCtr}@${r.keyActor}`,i=Vs[r.action]||r.action,s=o?{obj:e,elemId:o,action:i}:{obj:e,key:r.keyStr,action:i};if(s.insert=!!r.insert,"set"!==Vs[r.action]&&"inc"!==Vs[r.action]||(s.value=r.valLen,r.valLen_datatype&&(s.datatype=r.valLen_datatype)),!!r.chldCtr!=!!r.chldActor)throw new RangeError(`Mismatched child columns: ${r.chldCtr} and ${r.chldActor}`);null!==r.chldCtr&&(s.child=`${r.chldCtr}@${r.chldActor}`),t?(s.id=`${r.idCtr}@${r.idActor}`,s.succ=r.succNum.map((e=>`${e.succCtr}@${e.succActor}`)),sa(r.succNum.map((e=>({counter:e.succCtr,actorId:e.succActor}))))):(s.pred=r.predNum.map((e=>`${e.predCtr}@${e.predActor}`)),sa(r.predNum.map((e=>({counter:e.predCtr,actorId:e.predActor}))))),n.push(s)}return n}function sa(e){let t=null;for(let n of e){if(t&&-1!==Zs(t,n))throw new RangeError("operation IDs are not in ascending order");t=n}}function aa(e){return(7&e)===Ms.INT_DELTA?new Cs:(7&e)===Ms.BOOLEAN?new zs:(7&e)===Ms.STRING_RLE?new As("utf8"):(7&e)===Ms.VALUE_RAW?new Os:new As("uint")}function ua(e,t){return(7&e)===Ms.INT_DELTA?new Ts(t):(7&e)===Ms.BOOLEAN?new Ns(t):(7&e)===Ms.STRING_RLE?new Rs("utf8",t):(7&e)===Ms.VALUE_RAW?new js(t):new Rs("uint",t)}function ca(e,t){const n=new Uint8Array(0),r={};for(let i of Object.values(t))r[i]=ua(i,n);for(let i of e)r[i.columnId]=ua(i.columnId,i.buffer);let o=[];for(let i of Object.keys(r).map((e=>parseInt(e,10))).sort(((e,t)=>e-t))){let[e]=Object.entries(t).find((([,e])=>e===i));e||(e=i.toString()),o.push({columnId:i,columnName:e,decoder:r[i]})}return o}function la(e,t,n){e=ca(e,n);let r=[];for(;e.some((e=>!e.decoder.done));){let n={},o=0;for(;o<e.length;){const r=e[o].columnId;let i=r>>4,s=1;for(;o+s<e.length&&e[o+s].columnId>>4===i;)s++;if(r%8===Ms.GROUP_CARD){const r=[],i=e[o].decoder.readValue();for(let n=0;n<i;n++){let n={};for(let r=1;r<s;r++)ta(e,o+r,t,n);r.push(n)}n[e[o].columnName]=r,o+=s}else o+=ta(e,o,t,n)}r.push(n)}return r}function ha(e){const t=-9>>>0;let n=-1,r=[],o=e.readUint53();for(let i=0;i<o;i++){const o=e.readUint53(),i=e.readUint53();if((o&t)<=(n&t))throw new RangeError("Columns must be in ascending order");n=o,r.push({columnId:o,bufferLen:i})}return r}function fa(e,t){const n=t.filter((e=>e.encoder.buffer.byteLength>0));e.appendUint53(n.length);for(let r of n)e.appendUint53(r.id),e.appendUint53(r.encoder.buffer.byteLength)}function da(e){const t=e.readUint53(),n=[];for(let s=0;s<t;s++)n.push(Ss(e.readRawBytes(32)));let r={actor:e.readHexString(),seq:e.readUint53(),startOp:e.readUint53(),time:e.readInt53(),message:e.readPrefixedString(),deps:n};const o=[r.actor],i=e.readUint53();for(let s=0;s<i;s++)o.push(e.readHexString());return r.actorIds=o,r}function pa(e,t){const n=Ds.byteLength+4+1+5,r=new Os;r.appendRawBytes(new Uint8Array(n)),t(r);const o=r.buffer,i=new Os;i.appendByte(e),i.appendUint53(o.byteLength-n);const s=i.buffer,a=new Ls;a.update(s),a.update(o.subarray(n));const u=a.digest(),c=u.subarray(0,4);return o.set(Ds,n-s.byteLength-4-Ds.byteLength),o.set(c,n-s.byteLength-4),o.set(s,n-s.byteLength),{hash:u,bytes:o.subarray(n-s.byteLength-4-Ds.byteLength)}}function ga(e,t){if(!xs(e.readRawBytes(Ds.byteLength),Ds))throw new RangeError("Data does not begin with magic bytes 85 6f 4a 83");const n=e.readRawBytes(4),r=e.offset,o=e.readByte(),i=e.readUint53(),s={chunkType:o,chunkLength:i,chunkData:e.readRawBytes(i)};if(t){const t=new Ls;t.update(e.buf.subarray(r,e.offset));const o=t.digest();if(!xs(o.subarray(0,4),n))throw new RangeError("checksum does not match data");s.hash=Ss(o)}return s}function ya(e){const{changes:t,actorIds:n}=Js([e],!0),r=t[0],{hash:o,bytes:i}=pa(1,(e=>{if(!Array.isArray(r.deps))throw new TypeError("deps is not an array");e.appendUint53(r.deps.length);for(let n of r.deps.slice().sort())e.appendRawBytes(ks(n));e.appendHexString(r.actor),e.appendUint53(r.seq),e.appendUint53(r.startOp),e.appendInt53(r.time),e.appendPrefixedString(r.message||""),e.appendUint53(n.length-1);for(let r of n.slice(1))e.appendHexString(r);const t=na(r.ops,!1);fa(e,t);for(let n of t)e.appendRawBytes(n.encoder.buffer);r.extraBytes&&e.appendRawBytes(r.extraBytes)})),s=Ss(o);if(e.hash&&e.hash!==s)throw new RangeError(`Change hash does not match encoding: ${e.hash} != ${s}`);return i.byteLength>=256?function(e){const t=ga(new js(e),!1);if(1!==t.chunkType)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=bs.deflateRaw(t.chunkData),r=new Os;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(2),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}(i):i}function _a(e){const t=new js(e),n=ga(t,!0),r=new js(n.chunkData);if(!t.done)throw new RangeError("Encoded change has trailing data");if(1!==n.chunkType)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const o=da(r),i=ha(r);for(let s=0;s<i.length;s++){if(0!=(8&i[s].columnId))throw new RangeError("change must not contain deflated columns");i[s].buffer=r.readRawBytes(i[s].bufferLen)}if(!r.done){const e=r.buf.byteLength-r.offset;o.extraBytes=r.readRawBytes(e)}return o.columns=i,o.hash=n.hash,o}function ma(e){2===e[8]&&(e=va(e));const t=_a(e);return t.ops=ia(la(t.columns,t.actorIds,qs),!1),delete t.actorIds,delete t.columns,t}function va(e){const t=ga(new js(e),!1);if(2!==t.chunkType)throw new RangeError(`Unexpected chunk type: ${t.chunkType}`);const n=bs.inflateRaw(t.chunkData),r=new Os;return r.appendRawBytes(e.subarray(0,8)),r.appendByte(1),r.appendUint53(n.byteLength),r.appendRawBytes(n),r.buffer}function ba(e){let t=new js(e),n=[],r=0;for(;!t.done;)ga(t,!1),n.push(e.subarray(r,t.offset)),r=t.offset;return n}function wa(e){let t=[];for(let n of e)for(let e of ba(n))0===e[8]?t=t.concat(ka(e)):1!==e[8]&&2!==e[8]||t.push(ma(e));return t}function Ia(e,t){if(e===t)return 0;if("_root"===e)return-1;if("_root"===t)return 1;const n=Is(e),r=Is(t);return n.counter<r.counter?-1:n.counter>r.counter?1:n.actorId<r.actorId?-1:n.actorId>r.actorId?1:0}function xa(e){const{changes:t,actorIds:n}=Js(wa(e),!1),{changesColumns:r,heads:o}=function(e){const t={actor:new As("uint"),seq:new Cs,maxOp:new Cs,time:new Cs,message:new As("utf8"),depsNum:new As("uint"),depsIndex:new Cs,extraLen:new As("uint"),extraRaw:new Os};let n={},r={};for(let i=0;i<e.length;i++){const o=e[i];n[o.hash]=i,r[o.hash]=!0,t.actor.appendValue(o.actorNum),t.seq.appendValue(o.seq),t.maxOp.appendValue(o.startOp+o.ops.length-1),t.time.appendValue(o.time),t.message.appendValue(o.message),t.depsNum.appendValue(o.deps.length);for(let e of o.deps){if("number"!=typeof n[e])throw new RangeError(`Unknown dependency hash: ${e}`);t.depsIndex.appendValue(n[e]),r[e]&&delete r[e]}o.extraBytes?(t.extraLen.appendValue(o.extraBytes.byteLength<<4|Us.BYTES),t.extraRaw.appendRawBytes(o.extraBytes)):t.extraLen.appendValue(Us.BYTES)}let o=[];for(let[i,s]of Object.entries(Hs))o.push({id:s,name:i,encoder:t[i]});return o.sort(((e,t)=>e.id-t.id)),{changesColumns:o,heads:Object.keys(r).sort()}}(t),i=na(function(e){let t={},n={},r={};for(let i of e)for(let e=0;e<i.ops.length;e++){const o=i.ops[e],s=`${o.id.counter}@${o.id.actorId}`,a="_root"===o.obj?"_root":`${o.obj.counter}@${o.obj.actorId}`;let u;if(o.action.startsWith("make")&&(r[s]=o.action,"makeList"!==o.action&&"makeText"!==o.action||(n[s]={_head:[]})),"_root"===a||"makeMap"===r[a]||"makeTable"===r[a])u=o.key;else{if("makeList"!==r[a]&&"makeText"!==r[a])throw new RangeError(`Unknown object type for object ${a}`);if(o.insert){u=s;const e="_head"===o.elemId?"_head":`${o.elemId.counter}@${o.elemId.actorId}`;n[a][e].push(s),n[a][s]=[]}else u=`${o.elemId.counter}@${o.elemId.actorId}`}t[a]||(t[a]={}),t[a][u]||(t[a][u]={}),t[a][u][s]=o,o.succ=[];for(let e of o.pred){const n=`${e.counter}@${e.actorId}`;if(!t[a][u][n])throw new RangeError(`No predecessor operation ${n}`);t[a][u][n].succ.push(o.id)}}let o=[];for(let i of Object.keys(t).sort(Ia)){let e=[];if("makeList"===r[i]||"makeText"===r[i]){let t=["_head"];for(;t.length>0;){const r=t.pop();"_head"!==r&&e.push(r);for(let e of n[i][r].sort(Ia))t.push(e)}}else e=Object.keys(t[i]).sort();for(let n of e)for(let e of Object.keys(t[i][n]).sort(Ia)){const r=t[i][n][e];"del"!==r.action&&o.push(r)}}return o}(t),!0);for(let s of r)Sa(s);for(let s of i)Sa(s);return pa(0,(e=>{e.appendUint53(n.length);for(let t of n)e.appendHexString(t);e.appendUint53(o.length);for(let t of o.sort())e.appendRawBytes(ks(t));fa(e,r),fa(e,i);for(let t of r)e.appendRawBytes(t.encoder.buffer);for(let t of i)e.appendRawBytes(t.encoder.buffer)})).bytes}function Ea(e){const t=new js(e),n=ga(t,!0),r=new js(n.chunkData);if(!t.done)throw new RangeError("Encoded document has trailing data");if(0!==n.chunkType)throw new RangeError(`Unexpected chunk type: ${n.chunkType}`);const o=[],i=r.readUint53();for(let l=0;l<i;l++)o.push(r.readHexString());const s=[],a=r.readUint53();for(let l=0;l<a;l++)s.push(Ss(r.readRawBytes(32)));const u=ha(r),c=ha(r);for(let l=0;l<u.length;l++)u[l].buffer=r.readRawBytes(u[l].bufferLen),Oa(u[l]);for(let l=0;l<c.length;l++)c[l].buffer=r.readRawBytes(c[l].bufferLen),Oa(c[l]);return{changesColumns:u,opsColumns:c,actorIds:o,heads:s,extraBytes:r.readRawBytes(r.buf.byteLength-r.offset)}}function ka(e){const{changesColumns:t,opsColumns:n,actorIds:r,heads:o}=Ea(e),i=la(t,r,Hs);return function(e,t){let n={};for(let o of e){if(o.ops=[],n[o.actor]||(n[o.actor]=[]),o.seq!==n[o.actor].length+1)throw new RangeError(`Expected seq = ${n[o.actor].length+1}, got ${o.seq}`);if(o.seq>1&&n[o.actor][o.seq-2].maxOp>o.maxOp)throw new RangeError("maxOp must increase monotonically per actor");n[o.actor].push(o)}let r={};for(let o of t){if("del"===o.action)throw new RangeError("document should not contain del operations");o.pred=r[o.id]?r[o.id].pred:[],r[o.id]=o;for(let e of o.succ){if(!r[e])if(o.elemId){const t=o.insert?o.id:o.elemId;r[e]={id:e,action:"del",obj:o.obj,elemId:t,pred:[]}}else r[e]={id:e,action:"del",obj:o.obj,key:o.key,pred:[]};r[e].pred.push(o.id)}delete o.succ}for(let o of Object.values(r))"del"===o.action&&t.push(o);for(let o of t){const{counter:e,actorId:t}=Is(o.id),r=n[t];let i=0,s=r.length;for(;i<s;){const t=Math.floor((i+s)/2);r[t].maxOp<e?i=t+1:s=t}if(i>=r.length)throw new RangeError(`Operation ID ${o.id} outside of allowed range`);r[i].ops.push(o)}for(let o of e){o.ops.sort(((e,t)=>Ia(e.id,t.id))),o.startOp=o.maxOp-o.ops.length+1,delete o.maxOp;for(let e=0;e<o.ops.length;e++){const t=o.ops[e],n=`${o.startOp+e}@${o.actor}`;if(t.id!==n)throw new RangeError(`Expected opId ${n}, got ${t.id}`);delete t.id}}}(i,ia(la(n,r,Ps),!0)),function(e,t){let n={};for(let s=0;s<e.length;s++){let t=e[s];t.deps=[];for(let r of t.depsNum.map((e=>e.depsIndex))){if(!e[r]||!e[r].hash)throw new RangeError(`No hash for index ${r} while processing index ${s}`);const o=e[r].hash;t.deps.push(o),n[o]&&delete n[o]}if(t.deps.sort(),delete t.depsNum,t.extraLen_datatype!==Us.BYTES)throw new RangeError(`Bad datatype for extra bytes: ${Us.BYTES}`);t.extraBytes=t.extraLen,delete t.extraLen_datatype,e[s]=ma(ya(t)),n[e[s].hash]=!0}const r=Object.keys(n).sort();let o=r.length===t.length,i=0;for(;o&&i<r.length;)o=r[i]===t[i],i++;if(!o)throw new RangeError(`Mismatched heads hashes: expected ${t.join(", ")}, got ${r.join(", ")}`)}(i,o),i}function Sa(e){e.encoder.buffer.byteLength>=256&&(e.encoder={buffer:bs.deflateRaw(e.encoder.buffer)},e.id|=8)}function Oa(e){0!=(8&e.columnId)&&(e.buffer=bs.inflateRaw(e.buffer),e.columnId^=8)}function ja(e,t){let n={},r=null;for(let o of t.ops)if("set"===o.actionName&&"counter"===o.value.datatype){r||(r={opId:o.opId,value:0,succ:{}}),r.value+=o.value.value;for(let e of o.succ)r.succ[e]=!0}else if("inc"===o.actionName){if(!r)throw new RangeError(`inc operation ${o.opId} without a counter`);r.value+=o.value.value,delete r.succ[o.opId];for(let e of o.succ)r.succ[e]=!0}else if(0===o.succ.length)if(o.actionName.startsWith("make"))n[o.opId]=e[o.opId];else if("set"===o.actionName)n[o.opId]={value:o.value.value,type:"value"},o.value.datatype&&(n[o.opId].datatype=o.value.datatype);else{if("link"!==o.actionName)throw new RangeError(`Unexpected action type: ${o.actionName}`);if(!o.childId)throw new RangeError(`link operation ${o.opId} without a childId`);n[o.opId]=e[o.childId]}if(r&&0===Object.keys(r.succ).length&&(n[r.opId]={type:"value",value:r.value,datatype:"counter"}),Object.keys(n).length>0){let r=e[t.objId];return"map"===r.type||"table"===r.type?r.props[t.key]=n:"list"!==r.type&&"text"!==r.type||function(e,t,n,r){let o=!0;const i=Object.keys(t).sort(((e,t)=>Zs(Is(e),Is(t))));for(const s of i)o?e.edits.push({action:"insert",value:t[s],elemId:n,opId:s,index:r}):e.edits.push({action:"update",value:t[s],opId:s,index:r}),o=!1}(r,n,t.key,t.index),!0}return!1}function Aa(e){if("list"===e.type||"text"===e.type){e.edits.forEach((e=>Aa(e.value)));let t=e.edits;e.edits=[];for(const n of t)Ra(e.edits,n)}else if("map"===e.type||"table"===e.type)for(const t of Object.keys(e.props))for(const n of Object.keys(e.props[t]))Aa(e.props[t][n])}function Ra(e,t){if(0===e.length)return void e.push(t);let n=e[e.length-1];"insert"===n.action&&"insert"===t.action&&n.index===t.index-1&&"value"===n.value.type&&"value"===t.value.type&&n.elemId===n.opId&&t.elemId===t.opId&&Ca(n.elemId,t.elemId,1)&&n.value.datatype===t.value.datatype&&typeof n.value.value==typeof t.value.value?(n.action="multi-insert",t.value.datatype&&(n.datatype=t.value.datatype),n.values=[n.value.value,t.value.value],delete n.value,delete n.opId):"multi-insert"===n.action&&"insert"===t.action&&n.index+n.values.length===t.index&&"value"===t.value.type&&t.elemId===t.opId&&Ca(n.elemId,t.elemId,n.values.length)&&n.datatype===t.value.datatype&&typeof n.values[0]==typeof t.value.value?n.values.push(t.value.value):"remove"===n.action&&"remove"===t.action&&n.index===t.index?n.count+=t.count:e.push(t)}function Ca(e,t,n=1){const r=Is(e),o=Is(t);return r.actorId===o.actorId&&r.counter+n===o.counter}function Ta(e,t,n){const{objActor:r,objCtr:o,keyActor:i,keyCtr:s,keyStr:a,idActor:u,idCtr:c,insert:l}=e,[h,f,,,d,p,g,y,_,,,,,m]=t.map((e=>e.decoder));let v=0,b=0,w=!1,I=null,x=null,E=null,k=null,S=null,O=null,j=0;if(null!==o)for(;(!f.done||!h.done||!_.done)&&(x=f.readValue(),I=n[h.readValue()],_.skipValues(1),null===x||!I||x<o||x===o&&I<r);)v+=1;if(x!==o||I!==r)return{skipCount:v,visibleCount:b};if(null!==a){for(d.skipValues(v);!d.done;){const e=h.readValue();if(I=null===e?null:n[e],x=f.readValue(),S=d.readValue(),!(null!==S&&S<a&&x===o&&I===r))break;v+=1}return{skipCount:v,visibleCount:b}}if(g.skipValues(v),p.skipValues(v),y.skipValues(v),m.skipValues(v),k=g.readValue(),E=n[p.readValue()],O=y.readValue(),j=m.readValue(),l){if(null!==s&&s>0&&null!==i){for(v+=1;!(g.done||p.done||k===s&&E===i)&&(O&&(w=!1),0!==j||w||(b+=1,w=!0),k=g.readValue(),E=n[p.readValue()],x=f.readValue(),I=n[h.readValue()],O=y.readValue(),j=m.readValue(),x===o&&I===r);)v+=1;if(x!==o||I!==r||k!==s||E!==i||!O)throw new RangeError(`Reference element not found: ${s}@${i}`);if(O&&(w=!1),0!==j||w||(b+=1,w=!0),g.done||p.done)return{skipCount:v,visibleCount:b};k=g.readValue(),E=n[p.readValue()],x=f.readValue(),I=n[h.readValue()],O=y.readValue(),j=m.readValue()}for(;(!O||k>c||k===c&&E>u)&&x===o&&I===r&&(v+=1,O&&(w=!1),0!==j||w||(b+=1,w=!0),!g.done&&!p.done);)k=g.readValue(),E=n[p.readValue()],x=f.readValue(),I=n[h.readValue()],O=y.readValue(),j=m.readValue()}else if(null!==s&&s>0&&null!==i){for(;!(O&&k===s&&E===i||x!==o||I!==r||(v+=1,O&&(w=!1),0!==j||w||(b+=1,w=!0),g.done||p.done));)k=g.readValue(),E=n[p.readValue()],x=f.readValue(),I=n[h.readValue()],O=y.readValue(),j=m.readValue();if(x!==o||I!==r||k!==s||E!==i||!O)throw new RangeError(`Element not found for update: ${s}@${i}`)}return{skipCount:v,visibleCount:b}}function za(e,t,n){if(0===n)return;let r=0,o=-1,i=0,s=-1,a=0;for(let u of e){for(;r<t.length&&t[r].columnId<u.columnId;)r++;let e=null;r<t.length&&t[r].columnId===u.columnId&&t[r].decoder.buf.byteLength>0&&(e=t[r].decoder);const c=u.columnId>>4===o?i:n;if(u.columnId%8===Ms.GROUP_CARD)o=u.columnId>>4,e?i=u.encoder.copyFrom(e,{count:n,sumValues:!0}).sum:(u.encoder.appendValue(0,n),i=0);else if(u.columnId%8===Ms.VALUE_LEN)if(e){if(r+1===t.length||t[r+1].columnId!==u.columnId+1)throw new RangeError("VALUE_LEN column without accompanying VALUE_RAW column");s=u.columnId+1,a=u.encoder.copyFrom(e,{count:c,sumValues:!0,sumShift:4}).sum}else u.encoder.appendValue(null,c),s=u.columnId+1,a=0;else if(u.columnId%8===Ms.VALUE_RAW){if(u.columnId!==s)throw new RangeError("VALUE_RAW column without accompanying VALUE_LEN column");a>0&&u.encoder.appendRawBytes(e.readRawBytes(a))}else if(e)u.encoder.copyFrom(e,{count:c});else{const e=u.columnId%8!==Ms.BOOLEAN&&null;u.encoder.appendValue(e,c)}}}function Na(e,t){let n,r=[],o=-1,i=0,s=-1,a=0;for(let u of e){if(u.columnId%8===Ms.VALUE_RAW){if(u.columnId!==s)throw new RangeError("unexpected VALUE_RAW column");n=u.decoder.readRawBytes(a)}else if(u.columnId%8===Ms.GROUP_CARD)o=u.columnId>>4,i=u.decoder.readValue()||0,n=i;else if(u.columnId>>4===o){n=[],u.columnId%8===Ms.VALUE_LEN&&(s=u.columnId+1,a=0);for(let e=0;e<i;e++){let e=u.decoder.readValue();u.columnId%8===Ms.ACTOR_ID&&t&&"number"==typeof e&&(e=t[e]),u.columnId%8===Ms.VALUE_LEN&&(a+=n>>>4),n.push(e)}}else n=u.decoder.readValue(),u.columnId%8===Ms.ACTOR_ID&&t&&"number"==typeof n&&(n=t[n]),u.columnId%8===Ms.VALUE_LEN&&(s=u.columnId+1,a=n>>>4);r.push(n)}return r}function La(e,t,n){let r=0,o=-1,i=0;for(let s of e){for(;r<t.length&&t[r].columnId<s.columnId;)r++;if(r<t.length&&t[r].columnId===s.columnId){const e=n[r];if(s.columnId%8===Ms.GROUP_CARD)o=s.columnId>>4,i=e,s.encoder.appendValue(e);else if(s.columnId>>4===o){if(!Array.isArray(e)||e.length!==i)throw new RangeError("bad group value");for(let t of e)s.encoder.appendValue(t)}else s.columnId%8===Ms.VALUE_RAW?s.encoder.appendRawBytes(e):s.encoder.appendValue(e)}else if(s.columnId%8===Ms.GROUP_CARD)o=s.columnId>>4,i=0,s.encoder.appendValue(0);else if(s.columnId%8!==Ms.VALUE_RAW){const e=s.columnId>>4===o?i:1;let t=null;s.columnId%8===Ms.BOOLEAN&&(t=!1),s.columnId%8===Ms.VALUE_LEN&&(t=0),s.encoder.appendValue(t,e)}}}function Da(e,t,n){const r=e.actorIds[0],[o,i,s,a,u,,,c,l]=t.map((e=>e.decoder));let h={},f=null,d=null,p=e.startOp,g=[],y={};for(;!l.done;){const t=o.readValue(),_=s.readValue(),m={objActor:null===t?null:e.actorIds[t],objCtr:i.readValue(),keyActor:null===_?null:e.actorIds[_],keyCtr:a.readValue(),keyStr:u.readValue(),idActor:r,idCtr:p,insert:c.readValue(),action:l.readValue(),idActorIndex:-1,consecutiveOps:1};if(null===m.objCtr&&null!==m.objActor||null!==m.objCtr&&"string"!=typeof m.objActor)throw new RangeError(`Mismatched object reference: (${m.objCtr}, ${m.objActor})`);if(null===m.keyCtr&&null!==m.keyActor||0===m.keyCtr&&null!==m.keyActor||m.keyCtr>0&&"string"!=typeof m.keyActor)throw new RangeError(`Mismatched operation key: (${m.keyCtr}, ${m.keyActor})`);if(m.opId=`${m.idCtr}@${m.idActor}`,m.objId=null===m.objCtr?"_root":`${m.objCtr}@${m.objActor}`,y[m.objId]=!0,m.action%2==0){let e;e=null!==m.keyStr?m.keyStr:m.insert?m.opId:`${m.keyCtr}@${m.keyActor}`;const t=m.action<Vs.length?Bs[Vs[m.action]]:null;n[m.opId]={parentObj:m.objId,parentKey:e,opId:m.opId,type:t,children:{}},y[m.opId]=!0,Ks(n,[m.objId,"children",e,m.opId],{objectId:m.opId,type:t,props:{}})}f?m.objActor===d.objActor&&m.objCtr===d.objCtr&&(null!==m.keyStr&&null!==d.keyStr&&d.keyStr<=m.keyStr||null===m.keyStr&&null===d.keyStr&&!d.insert&&!m.insert||null===m.keyStr&&null===d.keyStr&&d.insert&&m.insert&&m.keyActor===d.idActor&&m.keyCtr===d.idCtr)?(f.consecutiveOps+=1,d=m):(h[m.objId]=!0,g.push(f),f=m,d=m):(f=m,d=m),p+=1}return f&&g.push(f),{opSequences:g,objectIds:Object.keys(y)}}class Ma{constructor(e){if(this.maxOp=0,this.changes=[],this.changeByHash={},this.hashesByActor={},this.actorIds=[],this.heads=[],this.clock={},e){const t=Ea(e);for(let n of wa([e])){const e=ya(n);this.changes.push(e),this.changeByHash[n.hash]=e,this.clock[n.actor]=Math.max(n.seq,this.clock[n.actor]||0)}this.actorIds=t.actorIds,this.heads=t.heads,this.docColumns=ca(t.opsColumns,Ps),this.numOps=0,this.objectMeta={}}else this.docColumns=ca([],Ps),this.numOps=0,this.objectMeta={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}}}clone(){let e=new Ma;return e.maxOp=this.maxOp,e.changes=this.changes,e.changeByHash=this.changeByHash,e.actorIds=this.actorIds,e.heads=this.heads,e.clock=this.clock,e.docColumns=this.docColumns,e.numOps=this.numOps,e.objectMeta=this.objectMeta,e}updatePatchProperty(e,t,n,r,o,i,s){const a=t.objId,u=n[4]?n[4]:n[7]?`${n[6]}@${r.actorIds[n[5]]}`:`${n[3]}@${r.actorIds[n[2]]}`,c=void 0!==s&&n[13]>0;e[a]||(e[a]={objectId:a,type:r.objectMeta[a].type,props:{}});let l=e[a];if(null===n[4]?(l.edits||(l.edits=[]),c||(o[u]?"remove"===o[u].action&&(l.edits.pop(),o[u].action="update"):(l.edits.push({action:"insert",index:i,elemId:u}),o[u]={action:"insert",visibleOps:[],hasChild:!1})),0===s&&(o[u]?"insert"===o[u].action&&(l.edits.pop(),o[u].action="update"):(l.edits.push({action:"remove",index:i}),o[u]={action:"remove",visibleOps:[],hasChild:!1})),!l.props[i]&&o[u]&&["insert","update"].includes(o[u].action)&&(l.props[i]={})):l.props[n[4]]||(l.props[n[4]]={}),!c&&(o[u]||(o[u]={visibleOps:[],hasChild:!1}),o[u].visibleOps.push(n),o[u].hasChild=o[u].hasChild||n[8]%2==0,o[u].hasChild)){let e={};for(let t of o[u].visibleOps){const n=`${t[6]}@${r.actorIds[t[5]]}`;if("set"===Vs[t[8]])e[n]=ea(t[9],t[10]);else if(t[8]%2==0){const r=t[8]<Vs.length?Bs[Vs[t[8]]]:null;e[n]={objectId:n,type:r,props:{}}}}Ks(r.objectMeta,[a,"children",u],e)}const h=`${n[6]}@${r.actorIds[n[5]]}`,f=null!==n[4]?n[4]:i;if(c&&"set"===Vs[n[8]]&&(15&n[9])===Us.COUNTER){o[u]||(o[u]={visibleOps:[],hasChild:!1}),o[u].counterStates||(o[u].counterStates={});let e=o[u].counterStates,t={opId:h,value:ea(n[9],n[10]).value,succs:{}};for(let o=0;o<n[13];o++){const i=`${n[15][o]}@${r.actorIds[n[14][o]]}`;e[i]=t,t.succs[i]=!0}}else if("inc"===Vs[n[8]]){if(!o[u]||!o[u].counterStates||!o[u].counterStates[h])throw new RangeError(`increment operation ${h} for unknown counter`);let e=o[u].counterStates[h];e.value+=ea(n[9],n[10]).value,delete e.succs[h],0===Object.keys(e.succs).length&&l.props[f]&&(l.props[f][e.opId]={datatype:"counter",value:e.value})}else if(l.props[f]&&!c)if("set"===Vs[n[8]])l.props[f][h]=ea(n[9],n[10]);else if(n[8]%2==0){if(!e[h]){const t=n[8]<Vs.length?Bs[Vs[n[8]]]:null;e[h]={objectId:h,type:t,props:{}}}l.props[f][h]=e[h]}}mergeDocChangeOps(e,t,n,r,o,i){if(o.opsCols[0].columnId!==Ps.objActor||r[0].columnId!==qs.objActor||o.opsCols[1].columnId!==Ps.objCtr||r[1].columnId!==qs.objCtr||o.opsCols[2].columnId!==Ps.keyActor||r[2].columnId!==qs.keyActor||o.opsCols[3].columnId!==Ps.keyCtr||r[3].columnId!==qs.keyCtr||o.opsCols[4].columnId!==Ps.keyStr||r[4].columnId!==qs.keyStr||o.opsCols[5].columnId!==Ps.idActor||r[5].columnId!==qs.idActor||o.opsCols[6].columnId!==Ps.idCtr||r[6].columnId!==qs.idCtr||o.opsCols[7].columnId!==Ps.insert||r[7].columnId!==qs.insert||o.opsCols[8].columnId!==Ps.action||r[8].columnId!==qs.action||o.opsCols[9].columnId!==Ps.valLen||r[9].columnId!==qs.valLen||o.opsCols[10].columnId!==Ps.valRaw||r[10].columnId!==qs.valRaw||o.opsCols[13].columnId!==Ps.succNum||r[13].columnId!==qs.predNum||o.opsCols[14].columnId!==Ps.succActor||r[14].columnId!==qs.predActor||o.opsCols[15].columnId!==Ps.succCtr||r[15].columnId!==qs.predCtr)throw new RangeError("unexpected columnId");let s=n.consecutiveOps,a=0,u=n.idCtr,c=!1,l=!1,h={},f=o.opsCols[8].decoder.done?null:Na(o.opsCols),d=null===f?0:1,p=null===f?0:f[13],g=null,y=null,_=[],m=[];for(;;){if(0===_.length)for(c=!1;0===_.length||n.insert||null!==y[4]&&y[4]===_[0][4]||null===y[4]&&y[2]===_[0][2]&&y[3]===_[0][3];){if(null!==y&&(_.push(y),m.push(new Array(y[13]))),0===s){y=null;break}y=Na(r,o.actorTable),y[5]=n.idActorIndex,y[6]=u,s--,u++}_.length>0&&(g=_[0]);const v=f&&f[0]===g[0]&&f[1]===g[1],b=f&&null!==f[4]&&f[4]===g[4],w=f&&null===f[4]&&null===g[4]&&(!f[7]&&f[2]===g[2]&&f[3]===g[3]||f[7]&&f[5]===g[2]&&f[6]===g[3]);if(0===_.length&&(!v||!b&&!w))break;let I=!1,x=0;if(n.insert||!v||null===f[4]&&null!==g[4]||null!==f[4]&&null!==g[4]&&g[4]<f[4]){if(x=_.length,!v&&!c&&null===g[4]&&!g[7])throw new RangeError(`could not find list element with ID: ${g[3]}@${o.actorIds[g[2]]}`)}else if(b||w||c){for(let e=0;e<_.length;e++){const t=_[e];for(let r=0;r<t[13];r++)if(t[14][r]===f[5]&&t[15][r]===f[6]){let i=0;for(;i<f[13]&&(f[15][i]<t[6]||f[15][i]===t[6]&&o.actorIds[f[14][i]]<n.idActor);)i++;f[15].splice(i,0,t[6]),f[14].splice(i,0,n.idActorIndex),f[13]++,m[e][r]=!0;break}}if(w&&(c=!0),c&&!w)x=_.length;else if(0===_.length||f[6]<g[6]||f[6]===g[6]&&o.actorIds[f[5]]<n.idActor){I=!0,this.updatePatchProperty(e,n,f,o,h,i,p);for(let e=_.length-1;e>=0;e--){let t=!0;for(let n=0;n<_[e][13];n++)m[e][n]||(t=!1);"del"===Vs[_[e][8]]&&t&&(_.splice(e,1),m.splice(e,1))}}else{if(f[6]===g[6]&&o.actorIds[f[5]]===n.idActor)throw new RangeError(`duplicate operation ID: ${g[6]}@${n.idActor}`);x=1}}else I=!0;if(I&&(La(t,o.opsCols,f),f[7]&&l&&(l=!1,i++),0===f[13]&&(l=!0),a++,f=o.opsCols[8].decoder.done?null:Na(o.opsCols),null!==f&&(d++,p=f[13])),x>0){for(let s=0;s<x;s++){let a=_[s];for(let e=0;e<a[13];e++)if(!m[s][e])throw new RangeError(`no matching operation for pred: ${a[15][e]}@${o.actorIds[a[14][e]]}`);this.updatePatchProperty(e,n,a,o,h,i),La(t,r,a),a[7]?(l=!1,i++):l=!0}x===_.length?(_.length=0,m.length=0):(_.splice(0,x),m.splice(0,x)),a+=x}}return f&&(La(t,o.opsCols,f),a++),{opsAppended:a,docOpsConsumed:d}}applyOps(e,t,n,r){for(let c of r.opsCols)c.decoder.reset();const{skipCount:o,visibleCount:i}=Ta(t,r.opsCols,r.actorIds);if(r.lastIndex[t.objId]&&i<r.lastIndex[t.objId])throw new RangeError("list element accesses must occur in ascending order");r.lastIndex[t.objId]=i;for(let c of r.opsCols)c.decoder.reset();let s=r.allCols.map((e=>({columnId:e,encoder:aa(e)})));za(s,r.opsCols,o);const{opsAppended:a,docOpsConsumed:u}=this.mergeDocChangeOps(e,s,t,n,r,i);za(s,r.opsCols,r.numOps-o-u);for(let c of r.opsCols)if(!c.decoder.done)throw new RangeError(`excess ops in ${c.columnName} column`);r.opsCols=s.map((e=>{const t=ua(e.columnId,e.encoder.buffer);return{columnId:e.columnId,columnName:Fs[e.columnId],decoder:t}})),r.numOps=r.numOps+a-u}getAllColumns(e){const t=["objActor","objCtr","keyActor","keyCtr","keyStr","idActor","idCtr","insert","action","valLen","valRaw","chldActor","chldCtr","predNum","predActor","predCtr"];let n={};for(let r=0;r<t.length;r++)if(e[r].columnName!==t[r])throw new RangeError(`Expected column ${t[r]} at index ${r}, got ${e[r].columnName}`);for(let r of e)n[r.columnId]=!0;for(let r of Object.values(Ps))n[r]=!0;return delete n[qs.predNum],delete n[qs.predActor],delete n[qs.predCtr],Object.keys(n).map((e=>parseInt(e,10))).sort(((e,t)=>e-t))}getActorTable(e,t){if(e.indexOf(t.actorIds[0])<0){if(1!==t.seq)throw new RangeError(`Seq ${t.seq} is the first change for actor ${t.actorIds[0]}`);e=e.concat([t.actorIds[0]])}const n=[];for(let r of t.actorIds){const t=e.indexOf(r);if(t<0)throw new RangeError(`actorId ${r} is not known to document`);n.push(t)}return{actorIds:e,actorTable:n}}setupPatches(e,t,n){for(let r of t){let t=n.objectMeta[r],o=null,i=!1;for(;;){if(e[r]||(e[r]={objectId:r,type:t.type,props:{}}),o){let s=o.parentKey;if("list"===t.type||"text"===t.type){const e=Is(r),t=Is(s),o={objActor:e.actorId,objCtr:e.counter,keyActor:t.actorId,keyCtr:t.counter,keyStr:null,insert:!1},{visibleCount:i}=Ta(o,n.opsCols,n.actorIds);s=i}e[r].props[s]||(e[r].props[s]={});let a=e[r].props[s];for(let[n,r]of Object.entries(t.children[o.parentKey]))a[n]?i=!0:r.objectId?(e[r.objectId]||(e[r.objectId]=Object.assign({},r,{props:{}})),a[n]=e[r.objectId]):a[n]=r;if(!a[o.opId])throw new RangeError(`object metadata did not contain child entry for ${o.opId}`)}if(i||!t.parentObj)break;o=t,r=t.parentObj,t=n.objectMeta[r]}}return e}applyChanges(e,t=!1){let n={_root:{objectId:"_root",type:"map",props:{}}},r={actorIds:this.actorIds,opsCols:this.docColumns,numOps:this.numOps,objectMeta:Object.assign({},this.objectMeta),lastIndex:{}},o={},i=Object.assign({},this.changeByHash),s=this.maxOp,a={},u=Object.assign({},this.clock);for(let h of this.heads)a[h]=!0;let c=[];for(let h of e){const e=_a(h);c.push(e);for(let n of e.deps){if(!i[n])throw new RangeError(`missing dependency ${n}`);delete a[n]}i[e.hash]=h,a[e.hash]=!0;const t=(u[e.actor]||0)+1;if(e.seq!==t)throw new RangeError(`Expected seq ${t}, got seq ${e.seq} from actor ${e.actor}`);u[e.actor]=e.seq;const l=ca(e.columns,qs);r.allCols=this.getAllColumns(l),Object.assign(r,this.getActorTable(r.actorIds,e));const f=r.actorIds.indexOf(e.actorIds[0]),{opSequences:d,objectIds:p}=Da(e,l,r.objectMeta);for(let n of p)o[n]=!0;const g=d[d.length-1];g&&(s=Math.max(s,g.idCtr+g.consecutiveOps-1));for(let n of l)n.decoder.reset();for(let o of d)o.idActorIndex=f,this.applyOps(n,o,l,r)}this.setupPatches(n,Object.keys(o),r),this.maxOp=s,this.changes=this.changes.concat(e),this.changeByHash=i,this.actorIds=r.actorIds,this.heads=Object.keys(a).sort(),this.clock=u,this.docColumns=r.opsCols,this.numOps=r.numOps,this.objectMeta=r.objectMeta;for(let h of c)1===h.seq&&(this.hashesByActor[h.actor]=[]),this.hashesByActor[h.actor].push(h.hash);let l={maxOp:s,clock:u,deps:this.heads,diffs:n._root};return t&&1===c.length&&(l.actor=c[0].actor,l.seq=c[0].seq),l}getChanges(e){const t={},n=this.changes.map(_a);for(let o of e)t[o]=!0;for(let o=n.length-1;o>=0;o--)if(t[n[o].hash])for(let e of n[o].deps)t[e]=!0;let r=[];for(let o=0;o<n.length;o++)t[n[o].hash]||r.push(this.changes[o]);return r}getMissingDeps(){return[]}save(){return xa(this.changes)}}var Ua={COLUMN_TYPE:Ms,VALUE_TYPE:Us,ACTIONS:Vs,DOC_OPS_COLUMNS:Ps,CHANGE_COLUMNS:qs,DOCUMENT_COLUMNS:Hs,splitContainers:ba,encodeChange:ya,decodeChange:ma,decodeChangeMeta:function(e,t){2===e[8]&&(e=va(e));const n=ga(new js(e),t);if(1!==n.chunkType)throw new RangeError("Buffer chunk type is not a change");const r=da(new js(n.chunkData));return r.change=e,t&&(r.hash=n.hash),r},decodeChanges:wa,encodeDocument:xa,decodeDocument:ka,getChangeChecksum:function(e){if(e[0]!==Ds[0]||e[1]!==Ds[1]||e[2]!==Ds[2]||e[3]!==Ds[3])throw new RangeError("Data does not begin with magic bytes 85 6f 4a 83");return(e[4]<<24|e[5]<<16|e[6]<<8|e[7])>>>0},appendEdit:Ra,constructPatch:function(e){const{opsColumns:t,actorIds:n}=Ea(e),r=ca(t,Ps).reduce(((e,t)=>Object.assign(e,{[t.columnName]:t.decoder})),{});let o={_root:{objectId:"_root",type:"map",props:{}}},i=null;for(;!r.idActor.done;){const e=`${r.idCtr.readValue()}@${n[r.idActor.readValue()]}`,t=r.action.readValue(),s=Vs[t];if(t%2==0){const t=Bs[s]||"unknown";o[e]="list"===t||"text"===t?{objectId:e,type:t,edits:[]}:{objectId:e,type:t,props:{}}}const a=r.objActor.readValue(),u=r.objCtr.readValue(),c=null===a?"_root":`${u}@${n[a]}`;let l=o[c];if(!l)throw new RangeError(`Operation for nonexistent object: ${c}`);const h=r.keyActor.readValue(),f=r.keyCtr.readValue(),d=r.keyStr.readValue(),p=!!r.insert.readValue(),g=r.chldActor.readValue(),y=r.chldCtr.readValue(),_=null===g?null:`${y}@${n[g]}`,m=r.valLen.readValue(),v=ea(m,r.valRaw.readRawBytes(m>>4)),b=r.succNum.readValue();let w,I=[];for(let o=0;o<b;o++)I.push(`${r.succCtr.readValue()}@${n[r.succActor.readValue()]}`);if(s&&"unknown"!==l.type){if("list"===l.type||"text"===l.type){if(null===f||0===f&&!p)throw new RangeError(`Operation ${e} on ${l.type} object has no key`);w=p?e:`${f}@${n[h]}`}else{if(null===d)throw new RangeError(`Operation ${e} on ${l.type} object has no key`);w=d}if(!i||i.objId!==c||i.key!==w){let e=0;i&&(e=i.index,ja(o,i)&&(e+=1),i.objId!==c&&(e=0)),i={objId:c,key:w,index:e,ops:[]}}i.ops.push({opId:e,actionName:s,value:v,childId:_,succ:I})}}return i&&ja(o,i),Aa(o._root),o._root},BackendDoc:Ma},Va={exports:{}};Va.exports=function(){var e=Array.prototype.slice;function t(e,t){t&&(e.prototype=Object.create(t.prototype)),e.prototype.constructor=e}function n(e){return s(e)?e:W(e)}function r(e){return a(e)?e:Z(e)}function o(e){return u(e)?e:J(e)}function i(e){return s(e)&&!c(e)?e:G(e)}function s(e){return!(!e||!e[h])}function a(e){return!(!e||!e[f])}function u(e){return!(!e||!e[d])}function c(e){return a(e)||u(e)}function l(e){return!(!e||!e[p])}t(r,n),t(o,n),t(i,n),n.isIterable=s,n.isKeyed=a,n.isIndexed=u,n.isAssociative=c,n.isOrdered=l,n.Keyed=r,n.Indexed=o,n.Set=i;var h="@@__IMMUTABLE_ITERABLE__@@",f="@@__IMMUTABLE_KEYED__@@",d="@@__IMMUTABLE_INDEXED__@@",p="@@__IMMUTABLE_ORDERED__@@",g="delete",y=5,_=1<<y,m=_-1,v={},b={value:!1},w={value:!1};function I(e){return e.value=!1,e}function x(e){e&&(e.value=!0)}function E(){}function k(e,t){t=t||0;for(var n=Math.max(0,e.length-t),r=new Array(n),o=0;o<n;o++)r[o]=e[o+t];return r}function S(e){return void 0===e.size&&(e.size=e.__iterate(j)),e.size}function O(e,t){if("number"!=typeof t){var n=t>>>0;if(""+n!==t||4294967295===n)return NaN;t=n}return t<0?S(e)+t:t}function j(){return!0}function A(e,t,n){return(0===e||void 0!==n&&e<=-n)&&(void 0===t||void 0!==n&&t>=n)}function R(e,t){return T(e,t,0)}function C(e,t){return T(e,t,t)}function T(e,t,n){return void 0===e?n:e<0?Math.max(0,t+e):void 0===t?e:Math.min(t,e)}var z=0,N=1,L=2,D="function"==typeof Symbol&&Symbol.iterator,M="@@iterator",U=D||M;function V(e){this.next=e}function B(e,t,n,r){var o=0===e?t:1===e?n:[t,n];return r?r.value=o:r={value:o,done:!1},r}function $(){return{value:void 0,done:!0}}function q(e){return!!H(e)}function P(e){return e&&"function"==typeof e.next}function F(e){var t=H(e);return t&&t.call(e)}function H(e){var t=e&&(D&&e[D]||e[M]);if("function"==typeof t)return t}function K(e){return e&&"number"==typeof e.length}function W(e){return null==e?se():s(e)?e.toSeq():ce(e)}function Z(e){return null==e?se().toKeyedSeq():s(e)?a(e)?e.toSeq():e.fromEntrySeq():ae(e)}function J(e){return null==e?se():s(e)?a(e)?e.entrySeq():e.toIndexedSeq():ue(e)}function G(e){return(null==e?se():s(e)?a(e)?e.entrySeq():e:ue(e)).toSetSeq()}V.prototype.toString=function(){return"[Iterator]"},V.KEYS=z,V.VALUES=N,V.ENTRIES=L,V.prototype.inspect=V.prototype.toSource=function(){return this.toString()},V.prototype[U]=function(){return this},t(W,n),W.of=function(){return W(arguments)},W.prototype.toSeq=function(){return this},W.prototype.toString=function(){return this.__toString("Seq {","}")},W.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},W.prototype.__iterate=function(e,t){return he(this,e,t,!0)},W.prototype.__iterator=function(e,t){return fe(this,e,t,!0)},t(Z,W),Z.prototype.toKeyedSeq=function(){return this},t(J,W),J.of=function(){return J(arguments)},J.prototype.toIndexedSeq=function(){return this},J.prototype.toString=function(){return this.__toString("Seq [","]")},J.prototype.__iterate=function(e,t){return he(this,e,t,!1)},J.prototype.__iterator=function(e,t){return fe(this,e,t,!1)},t(G,W),G.of=function(){return G(arguments)},G.prototype.toSetSeq=function(){return this},W.isSeq=ie,W.Keyed=Z,W.Set=G,W.Indexed=J;var Y,X,Q,ee="@@__IMMUTABLE_SEQ__@@";function te(e){this._array=e,this.size=e.length}function ne(e){var t=Object.keys(e);this._object=e,this._keys=t,this.size=t.length}function re(e){this._iterable=e,this.size=e.length||e.size}function oe(e){this._iterator=e,this._iteratorCache=[]}function ie(e){return!(!e||!e[ee])}function se(){return Y||(Y=new te([]))}function ae(e){var t=Array.isArray(e)?new te(e).fromEntrySeq():P(e)?new oe(e).fromEntrySeq():q(e)?new re(e).fromEntrySeq():"object"==typeof e?new ne(e):void 0;if(!t)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+e);return t}function ue(e){var t=le(e);if(!t)throw new TypeError("Expected Array or iterable object of values: "+e);return t}function ce(e){var t=le(e)||"object"==typeof e&&new ne(e);if(!t)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+e);return t}function le(e){return K(e)?new te(e):P(e)?new oe(e):q(e)?new re(e):void 0}function he(e,t,n,r){var o=e._cache;if(o){for(var i=o.length-1,s=0;s<=i;s++){var a=o[n?i-s:s];if(!1===t(a[1],r?a[0]:s,e))return s+1}return s}return e.__iterateUncached(t,n)}function fe(e,t,n,r){var o=e._cache;if(o){var i=o.length-1,s=0;return new V((function(){var e=o[n?i-s:s];return s++>i?$():B(t,r?e[0]:s-1,e[1])}))}return e.__iteratorUncached(t,n)}function de(e,t){return t?pe(t,e,"",{"":e}):ge(e)}function pe(e,t,n,r){return Array.isArray(t)?e.call(r,n,J(t).map((function(n,r){return pe(e,n,r,t)}))):ye(t)?e.call(r,n,Z(t).map((function(n,r){return pe(e,n,r,t)}))):t}function ge(e){return Array.isArray(e)?J(e).map(ge).toList():ye(e)?Z(e).map(ge).toMap():e}function ye(e){return e&&(e.constructor===Object||void 0===e.constructor)}function _e(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){if((e=e.valueOf())===(t=t.valueOf())||e!=e&&t!=t)return!0;if(!e||!t)return!1}return!("function"!=typeof e.equals||"function"!=typeof t.equals||!e.equals(t))}function me(e,t){if(e===t)return!0;if(!s(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||a(e)!==a(t)||u(e)!==u(t)||l(e)!==l(t))return!1;if(0===e.size&&0===t.size)return!0;var n=!c(e);if(l(e)){var r=e.entries();return t.every((function(e,t){var o=r.next().value;return o&&_e(o[1],e)&&(n||_e(o[0],t))}))&&r.next().done}var o=!1;if(void 0===e.size)if(void 0===t.size)"function"==typeof e.cacheResult&&e.cacheResult();else{o=!0;var i=e;e=t,t=i}var h=!0,f=t.__iterate((function(t,r){if(n?!e.has(t):o?!_e(t,e.get(r,v)):!_e(e.get(r,v),t))return h=!1,!1}));return h&&e.size===f}function ve(e,t){if(!(this instanceof ve))return new ve(e,t);if(this._value=e,this.size=void 0===t?1/0:Math.max(0,t),0===this.size){if(X)return X;X=this}}function be(e,t){if(!e)throw new Error(t)}function we(e,t,n){if(!(this instanceof we))return new we(e,t,n);if(be(0!==n,"Cannot step a Range by 0"),e=e||0,void 0===t&&(t=1/0),n=void 0===n?1:Math.abs(n),t<e&&(n=-n),this._start=e,this._end=t,this._step=n,this.size=Math.max(0,Math.ceil((t-e)/n-1)+1),0===this.size){if(Q)return Q;Q=this}}function Ie(){throw TypeError("Abstract")}function xe(){}function Ee(){}function ke(){}W.prototype[ee]=!0,t(te,J),te.prototype.get=function(e,t){return this.has(e)?this._array[O(this,e)]:t},te.prototype.__iterate=function(e,t){for(var n=this._array,r=n.length-1,o=0;o<=r;o++)if(!1===e(n[t?r-o:o],o,this))return o+1;return o},te.prototype.__iterator=function(e,t){var n=this._array,r=n.length-1,o=0;return new V((function(){return o>r?$():B(e,o,n[t?r-o++:o++])}))},t(ne,Z),ne.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},ne.prototype.has=function(e){return this._object.hasOwnProperty(e)},ne.prototype.__iterate=function(e,t){for(var n=this._object,r=this._keys,o=r.length-1,i=0;i<=o;i++){var s=r[t?o-i:i];if(!1===e(n[s],s,this))return i+1}return i},ne.prototype.__iterator=function(e,t){var n=this._object,r=this._keys,o=r.length-1,i=0;return new V((function(){var s=r[t?o-i:i];return i++>o?$():B(e,s,n[s])}))},ne.prototype[p]=!0,t(re,J),re.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var n=F(this._iterable),r=0;if(P(n))for(var o;!(o=n.next()).done&&!1!==e(o.value,r++,this););return r},re.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var n=F(this._iterable);if(!P(n))return new V($);var r=0;return new V((function(){var t=n.next();return t.done?t:B(e,r++,t.value)}))},t(oe,J),oe.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);for(var n,r=this._iterator,o=this._iteratorCache,i=0;i<o.length;)if(!1===e(o[i],i++,this))return i;for(;!(n=r.next()).done;){var s=n.value;if(o[i]=s,!1===e(s,i++,this))break}return i},oe.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var n=this._iterator,r=this._iteratorCache,o=0;return new V((function(){if(o>=r.length){var t=n.next();if(t.done)return t;r[o]=t.value}return B(e,o,r[o++])}))},t(ve,J),ve.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},ve.prototype.get=function(e,t){return this.has(e)?this._value:t},ve.prototype.includes=function(e){return _e(this._value,e)},ve.prototype.slice=function(e,t){var n=this.size;return A(e,t,n)?this:new ve(this._value,C(t,n)-R(e,n))},ve.prototype.reverse=function(){return this},ve.prototype.indexOf=function(e){return _e(this._value,e)?0:-1},ve.prototype.lastIndexOf=function(e){return _e(this._value,e)?this.size:-1},ve.prototype.__iterate=function(e,t){for(var n=0;n<this.size;n++)if(!1===e(this._value,n,this))return n+1;return n},ve.prototype.__iterator=function(e,t){var n=this,r=0;return new V((function(){return r<n.size?B(e,r++,n._value):$()}))},ve.prototype.equals=function(e){return e instanceof ve?_e(this._value,e._value):me(e)},t(we,J),we.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},we.prototype.get=function(e,t){return this.has(e)?this._start+O(this,e)*this._step:t},we.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},we.prototype.slice=function(e,t){return A(e,t,this.size)?this:(e=R(e,this.size),(t=C(t,this.size))<=e?new we(0,0):new we(this.get(e,this._end),this.get(t,this._end),this._step))},we.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step==0){var n=t/this._step;if(n>=0&&n<this.size)return n}return-1},we.prototype.lastIndexOf=function(e){return this.indexOf(e)},we.prototype.__iterate=function(e,t){for(var n=this.size-1,r=this._step,o=t?this._start+n*r:this._start,i=0;i<=n;i++){if(!1===e(o,i,this))return i+1;o+=t?-r:r}return i},we.prototype.__iterator=function(e,t){var n=this.size-1,r=this._step,o=t?this._start+n*r:this._start,i=0;return new V((function(){var s=o;return o+=t?-r:r,i>n?$():B(e,i++,s)}))},we.prototype.equals=function(e){return e instanceof we?this._start===e._start&&this._end===e._end&&this._step===e._step:me(this,e)},t(Ie,n),t(xe,Ie),t(Ee,Ie),t(ke,Ie),Ie.Keyed=xe,Ie.Indexed=Ee,Ie.Set=ke;var Se="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){var n=65535&(e|=0),r=65535&(t|=0);return n*r+((e>>>16)*r+n*(t>>>16)<<16>>>0)|0};function Oe(e){return e>>>1&1073741824|3221225471&e}function je(e){if(!1===e||null==e)return 0;if("function"==typeof e.valueOf&&(!1===(e=e.valueOf())||null==e))return 0;if(!0===e)return 1;var t=typeof e;if("number"===t){if(e!=e||e===1/0)return 0;var n=0|e;for(n!==e&&(n^=4294967295*e);e>4294967295;)n^=e/=4294967295;return Oe(n)}if("string"===t)return e.length>Ve?Ae(e):Re(e);if("function"==typeof e.hashCode)return e.hashCode();if("object"===t)return Ce(e);if("function"==typeof e.toString)return Re(e.toString());throw new Error("Value type "+t+" cannot be hashed.")}function Ae(e){var t=qe[e];return void 0===t&&(t=Re(e),$e===Be&&($e=0,qe={}),$e++,qe[e]=t),t}function Re(e){for(var t=0,n=0;n<e.length;n++)t=31*t+e.charCodeAt(n)|0;return Oe(t)}function Ce(e){var t;if(De&&void 0!==(t=Le.get(e)))return t;if(void 0!==(t=e[Ue]))return t;if(!ze){if(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[Ue]))return t;if(void 0!==(t=Ne(e)))return t}if(t=++Me,1073741824&Me&&(Me=0),De)Le.set(e,t);else{if(void 0!==Te&&!1===Te(e))throw new Error("Non-extensible objects are not allowed as keys.");if(ze)Object.defineProperty(e,Ue,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[Ue]=t;else{if(void 0===e.nodeType)throw new Error("Unable to set a non-enumerable property on object.");e[Ue]=t}}return t}var Te=Object.isExtensible,ze=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}();function Ne(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}var Le,De="function"==typeof WeakMap;De&&(Le=new WeakMap);var Me=0,Ue="__immutablehash__";"function"==typeof Symbol&&(Ue=Symbol(Ue));var Ve=16,Be=255,$e=0,qe={};function Pe(e){be(e!==1/0,"Cannot perform this action with an infinite size.")}function Fe(e){return null==e?ot():He(e)&&!l(e)?e:ot().withMutations((function(t){var n=r(e);Pe(n.size),n.forEach((function(e,n){return t.set(n,e)}))}))}function He(e){return!(!e||!e[We])}t(Fe,xe),Fe.of=function(){var t=e.call(arguments,0);return ot().withMutations((function(e){for(var n=0;n<t.length;n+=2){if(n+1>=t.length)throw new Error("Missing value for key: "+t[n]);e.set(t[n],t[n+1])}}))},Fe.prototype.toString=function(){return this.__toString("Map {","}")},Fe.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},Fe.prototype.set=function(e,t){return it(this,e,t)},Fe.prototype.setIn=function(e,t){return this.updateIn(e,v,(function(){return t}))},Fe.prototype.remove=function(e){return it(this,e,v)},Fe.prototype.deleteIn=function(e){return this.updateIn(e,(function(){return v}))},Fe.prototype.update=function(e,t,n){return 1===arguments.length?e(this):this.updateIn([e],t,n)},Fe.prototype.updateIn=function(e,t,n){n||(n=t,t=void 0);var r=yt(this,In(e),t,n);return r===v?void 0:r},Fe.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):ot()},Fe.prototype.merge=function(){return ft(this,void 0,arguments)},Fe.prototype.mergeWith=function(t){return ft(this,t,e.call(arguments,1))},Fe.prototype.mergeIn=function(t){var n=e.call(arguments,1);return this.updateIn(t,ot(),(function(e){return"function"==typeof e.merge?e.merge.apply(e,n):n[n.length-1]}))},Fe.prototype.mergeDeep=function(){return ft(this,dt,arguments)},Fe.prototype.mergeDeepWith=function(t){var n=e.call(arguments,1);return ft(this,pt(t),n)},Fe.prototype.mergeDeepIn=function(t){var n=e.call(arguments,1);return this.updateIn(t,ot(),(function(e){return"function"==typeof e.mergeDeep?e.mergeDeep.apply(e,n):n[n.length-1]}))},Fe.prototype.sort=function(e){return qt(hn(this,e))},Fe.prototype.sortBy=function(e,t){return qt(hn(this,t,e))},Fe.prototype.withMutations=function(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this},Fe.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new E)},Fe.prototype.asImmutable=function(){return this.__ensureOwner()},Fe.prototype.wasAltered=function(){return this.__altered},Fe.prototype.__iterator=function(e,t){return new et(this,e,t)},Fe.prototype.__iterate=function(e,t){var n=this,r=0;return this._root&&this._root.iterate((function(t){return r++,e(t[1],t[0],n)}),t),r},Fe.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?rt(this.size,this._root,e,this.__hash):(this.__ownerID=e,this.__altered=!1,this)},Fe.isMap=He;var Ke,We="@@__IMMUTABLE_MAP__@@",Ze=Fe.prototype;function Je(e,t){this.ownerID=e,this.entries=t}function Ge(e,t,n){this.ownerID=e,this.bitmap=t,this.nodes=n}function Ye(e,t,n){this.ownerID=e,this.count=t,this.nodes=n}function Xe(e,t,n){this.ownerID=e,this.keyHash=t,this.entries=n}function Qe(e,t,n){this.ownerID=e,this.keyHash=t,this.entry=n}function et(e,t,n){this._type=t,this._reverse=n,this._stack=e._root&&nt(e._root)}function tt(e,t){return B(e,t[0],t[1])}function nt(e,t){return{node:e,index:0,__prev:t}}function rt(e,t,n,r){var o=Object.create(Ze);return o.size=e,o._root=t,o.__ownerID=n,o.__hash=r,o.__altered=!1,o}function ot(){return Ke||(Ke=rt(0))}function it(e,t,n){var r,o;if(e._root){var i=I(b),s=I(w);if(r=st(e._root,e.__ownerID,0,void 0,t,n,i,s),!s.value)return e;o=e.size+(i.value?n===v?-1:1:0)}else{if(n===v)return e;o=1,r=new Je(e.__ownerID,[[t,n]])}return e.__ownerID?(e.size=o,e._root=r,e.__hash=void 0,e.__altered=!0,e):r?rt(o,r):ot()}function st(e,t,n,r,o,i,s,a){return e?e.update(t,n,r,o,i,s,a):i===v?e:(x(a),x(s),new Qe(t,r,[o,i]))}function at(e){return e.constructor===Qe||e.constructor===Xe}function ut(e,t,n,r,o){if(e.keyHash===r)return new Xe(t,r,[e.entry,o]);var i,s=(0===n?e.keyHash:e.keyHash>>>n)&m,a=(0===n?r:r>>>n)&m;return new Ge(t,1<<s|1<<a,s===a?[ut(e,t,n+y,r,o)]:(i=new Qe(t,r,o),s<a?[e,i]:[i,e]))}function ct(e,t,n,r){e||(e=new E);for(var o=new Qe(e,je(n),[n,r]),i=0;i<t.length;i++){var s=t[i];o=o.update(e,0,void 0,s[0],s[1])}return o}function lt(e,t,n,r){for(var o=0,i=0,s=new Array(n),a=0,u=1,c=t.length;a<c;a++,u<<=1){var l=t[a];void 0!==l&&a!==r&&(o|=u,s[i++]=l)}return new Ge(e,o,s)}function ht(e,t,n,r,o){for(var i=0,s=new Array(_),a=0;0!==n;a++,n>>>=1)s[a]=1&n?t[i++]:void 0;return s[r]=o,new Ye(e,i+1,s)}function ft(e,t,n){for(var o=[],i=0;i<n.length;i++){var a=n[i],u=r(a);s(a)||(u=u.map((function(e){return de(e)}))),o.push(u)}return gt(e,t,o)}function dt(e,t,n){return e&&e.mergeDeep&&s(t)?e.mergeDeep(t):_e(e,t)?e:t}function pt(e){return function(t,n,r){if(t&&t.mergeDeepWith&&s(n))return t.mergeDeepWith(e,n);var o=e(t,n,r);return _e(t,o)?t:o}}function gt(e,t,n){return 0===(n=n.filter((function(e){return 0!==e.size}))).length?e:0!==e.size||e.__ownerID||1!==n.length?e.withMutations((function(e){for(var r=t?function(n,r){e.update(r,v,(function(e){return e===v?n:t(e,n,r)}))}:function(t,n){e.set(n,t)},o=0;o<n.length;o++)n[o].forEach(r)})):e.constructor(n[0])}function yt(e,t,n,r){var o=e===v,i=t.next();if(i.done){var s=o?n:e,a=r(s);return a===s?e:a}be(o||e&&e.set,"invalid keyPath");var u=i.value,c=o?v:e.get(u,v),l=yt(c,t,n,r);return l===c?e:l===v?e.remove(u):(o?ot():e).set(u,l)}function _t(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,127&(e+=e>>16)}function mt(e,t,n,r){var o=r?e:k(e);return o[t]=n,o}function vt(e,t,n,r){var o=e.length+1;if(r&&t+1===o)return e[t]=n,e;for(var i=new Array(o),s=0,a=0;a<o;a++)a===t?(i[a]=n,s=-1):i[a]=e[a+s];return i}function bt(e,t,n){var r=e.length-1;if(n&&t===r)return e.pop(),e;for(var o=new Array(r),i=0,s=0;s<r;s++)s===t&&(i=1),o[s]=e[s+i];return o}Ze[We]=!0,Ze[g]=Ze.remove,Ze.removeIn=Ze.deleteIn,Je.prototype.get=function(e,t,n,r){for(var o=this.entries,i=0,s=o.length;i<s;i++)if(_e(n,o[i][0]))return o[i][1];return r},Je.prototype.update=function(e,t,n,r,o,i,s){for(var a=o===v,u=this.entries,c=0,l=u.length;c<l&&!_e(r,u[c][0]);c++);var h=c<l;if(h?u[c][1]===o:a)return this;if(x(s),(a||!h)&&x(i),!a||1!==u.length){if(!h&&!a&&u.length>=wt)return ct(e,u,r,o);var f=e&&e===this.ownerID,d=f?u:k(u);return h?a?c===l-1?d.pop():d[c]=d.pop():d[c]=[r,o]:d.push([r,o]),f?(this.entries=d,this):new Je(e,d)}},Ge.prototype.get=function(e,t,n,r){void 0===t&&(t=je(n));var o=1<<((0===e?t:t>>>e)&m),i=this.bitmap;return 0==(i&o)?r:this.nodes[_t(i&o-1)].get(e+y,t,n,r)},Ge.prototype.update=function(e,t,n,r,o,i,s){void 0===n&&(n=je(r));var a=(0===t?n:n>>>t)&m,u=1<<a,c=this.bitmap,l=0!=(c&u);if(!l&&o===v)return this;var h=_t(c&u-1),f=this.nodes,d=l?f[h]:void 0,p=st(d,e,t+y,n,r,o,i,s);if(p===d)return this;if(!l&&p&&f.length>=It)return ht(e,f,c,a,p);if(l&&!p&&2===f.length&&at(f[1^h]))return f[1^h];if(l&&p&&1===f.length&&at(p))return p;var g=e&&e===this.ownerID,_=l?p?c:c^u:c|u,b=l?p?mt(f,h,p,g):bt(f,h,g):vt(f,h,p,g);return g?(this.bitmap=_,this.nodes=b,this):new Ge(e,_,b)},Ye.prototype.get=function(e,t,n,r){void 0===t&&(t=je(n));var o=(0===e?t:t>>>e)&m,i=this.nodes[o];return i?i.get(e+y,t,n,r):r},Ye.prototype.update=function(e,t,n,r,o,i,s){void 0===n&&(n=je(r));var a=(0===t?n:n>>>t)&m,u=o===v,c=this.nodes,l=c[a];if(u&&!l)return this;var h=st(l,e,t+y,n,r,o,i,s);if(h===l)return this;var f=this.count;if(l){if(!h&&--f<xt)return lt(e,c,f,a)}else f++;var d=e&&e===this.ownerID,p=mt(c,a,h,d);return d?(this.count=f,this.nodes=p,this):new Ye(e,f,p)},Xe.prototype.get=function(e,t,n,r){for(var o=this.entries,i=0,s=o.length;i<s;i++)if(_e(n,o[i][0]))return o[i][1];return r},Xe.prototype.update=function(e,t,n,r,o,i,s){void 0===n&&(n=je(r));var a=o===v;if(n!==this.keyHash)return a?this:(x(s),x(i),ut(this,e,t,n,[r,o]));for(var u=this.entries,c=0,l=u.length;c<l&&!_e(r,u[c][0]);c++);var h=c<l;if(h?u[c][1]===o:a)return this;if(x(s),(a||!h)&&x(i),a&&2===l)return new Qe(e,this.keyHash,u[1^c]);var f=e&&e===this.ownerID,d=f?u:k(u);return h?a?c===l-1?d.pop():d[c]=d.pop():d[c]=[r,o]:d.push([r,o]),f?(this.entries=d,this):new Xe(e,this.keyHash,d)},Qe.prototype.get=function(e,t,n,r){return _e(n,this.entry[0])?this.entry[1]:r},Qe.prototype.update=function(e,t,n,r,o,i,s){var a=o===v,u=_e(r,this.entry[0]);return(u?o===this.entry[1]:a)?this:(x(s),a?void x(i):u?e&&e===this.ownerID?(this.entry[1]=o,this):new Qe(e,this.keyHash,[r,o]):(x(i),ut(this,e,t,je(r),[r,o])))},Je.prototype.iterate=Xe.prototype.iterate=function(e,t){for(var n=this.entries,r=0,o=n.length-1;r<=o;r++)if(!1===e(n[t?o-r:r]))return!1},Ge.prototype.iterate=Ye.prototype.iterate=function(e,t){for(var n=this.nodes,r=0,o=n.length-1;r<=o;r++){var i=n[t?o-r:r];if(i&&!1===i.iterate(e,t))return!1}},Qe.prototype.iterate=function(e,t){return e(this.entry)},t(et,V),et.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var n,r=t.node,o=t.index++;if(r.entry){if(0===o)return tt(e,r.entry)}else if(r.entries){if(o<=(n=r.entries.length-1))return tt(e,r.entries[this._reverse?n-o:o])}else if(o<=(n=r.nodes.length-1)){var i=r.nodes[this._reverse?n-o:o];if(i){if(i.entry)return tt(e,i.entry);t=this._stack=nt(i,t)}continue}t=this._stack=this._stack.__prev}return $()};var wt=_/4,It=_/2,xt=_/4;function Et(e){var t=Nt();if(null==e)return t;if(kt(e))return e;var n=o(e),r=n.size;return 0===r?t:(Pe(r),r>0&&r<_?zt(0,r,y,null,new jt(n.toArray())):t.withMutations((function(e){e.setSize(r),n.forEach((function(t,n){return e.set(n,t)}))})))}function kt(e){return!(!e||!e[St])}t(Et,Ee),Et.of=function(){return this(arguments)},Et.prototype.toString=function(){return this.__toString("List [","]")},Et.prototype.get=function(e,t){if((e=O(this,e))>=0&&e<this.size){var n=Ut(this,e+=this._origin);return n&&n.array[e&m]}return t},Et.prototype.set=function(e,t){return Lt(this,e,t)},Et.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},Et.prototype.insert=function(e,t){return this.splice(e,0,t)},Et.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=y,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):Nt()},Et.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations((function(n){Vt(n,0,t+e.length);for(var r=0;r<e.length;r++)n.set(t+r,e[r])}))},Et.prototype.pop=function(){return Vt(this,0,-1)},Et.prototype.unshift=function(){var e=arguments;return this.withMutations((function(t){Vt(t,-e.length);for(var n=0;n<e.length;n++)t.set(n,e[n])}))},Et.prototype.shift=function(){return Vt(this,1)},Et.prototype.merge=function(){return Bt(this,void 0,arguments)},Et.prototype.mergeWith=function(t){return Bt(this,t,e.call(arguments,1))},Et.prototype.mergeDeep=function(){return Bt(this,dt,arguments)},Et.prototype.mergeDeepWith=function(t){var n=e.call(arguments,1);return Bt(this,pt(t),n)},Et.prototype.setSize=function(e){return Vt(this,0,e)},Et.prototype.slice=function(e,t){var n=this.size;return A(e,t,n)?this:Vt(this,R(e,n),C(t,n))},Et.prototype.__iterator=function(e,t){var n=0,r=Tt(this,t);return new V((function(){var t=r();return t===Ct?$():B(e,n++,t)}))},Et.prototype.__iterate=function(e,t){for(var n,r=0,o=Tt(this,t);(n=o())!==Ct&&!1!==e(n,r++,this););return r},Et.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?zt(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):(this.__ownerID=e,this)},Et.isList=kt;var St="@@__IMMUTABLE_LIST__@@",Ot=Et.prototype;function jt(e,t){this.array=e,this.ownerID=t}Ot[St]=!0,Ot[g]=Ot.remove,Ot.setIn=Ze.setIn,Ot.deleteIn=Ot.removeIn=Ze.removeIn,Ot.update=Ze.update,Ot.updateIn=Ze.updateIn,Ot.mergeIn=Ze.mergeIn,Ot.mergeDeepIn=Ze.mergeDeepIn,Ot.withMutations=Ze.withMutations,Ot.asMutable=Ze.asMutable,Ot.asImmutable=Ze.asImmutable,Ot.wasAltered=Ze.wasAltered,jt.prototype.removeBefore=function(e,t,n){if(n===t?1<<t:0===this.array.length)return this;var r=n>>>t&m;if(r>=this.array.length)return new jt([],e);var o,i=0===r;if(t>0){var s=this.array[r];if((o=s&&s.removeBefore(e,t-y,n))===s&&i)return this}if(i&&!o)return this;var a=Mt(this,e);if(!i)for(var u=0;u<r;u++)a.array[u]=void 0;return o&&(a.array[r]=o),a},jt.prototype.removeAfter=function(e,t,n){if(n===(t?1<<t:0)||0===this.array.length)return this;var r,o=n-1>>>t&m;if(o>=this.array.length)return this;if(t>0){var i=this.array[o];if((r=i&&i.removeAfter(e,t-y,n))===i&&o===this.array.length-1)return this}var s=Mt(this,e);return s.array.splice(o+1),r&&(s.array[o]=r),s};var At,Rt,Ct={};function Tt(e,t){var n=e._origin,r=e._capacity,o=$t(r),i=e._tail;return s(e._root,e._level,0);function s(e,t,n){return 0===t?a(e,n):u(e,t,n)}function a(e,s){var a=s===o?i&&i.array:e&&e.array,u=s>n?0:n-s,c=r-s;return c>_&&(c=_),function(){if(u===c)return Ct;var e=t?--c:u++;return a&&a[e]}}function u(e,o,i){var a,u=e&&e.array,c=i>n?0:n-i>>o,l=1+(r-i>>o);return l>_&&(l=_),function(){for(;;){if(a){var e=a();if(e!==Ct)return e;a=null}if(c===l)return Ct;var n=t?--l:c++;a=s(u&&u[n],o-y,i+(n<<o))}}}}function zt(e,t,n,r,o,i,s){var a=Object.create(Ot);return a.size=t-e,a._origin=e,a._capacity=t,a._level=n,a._root=r,a._tail=o,a.__ownerID=i,a.__hash=s,a.__altered=!1,a}function Nt(){return At||(At=zt(0,0,y))}function Lt(e,t,n){if((t=O(e,t))!=t)return e;if(t>=e.size||t<0)return e.withMutations((function(e){t<0?Vt(e,t).set(0,n):Vt(e,0,t+1).set(t,n)}));t+=e._origin;var r=e._tail,o=e._root,i=I(w);return t>=$t(e._capacity)?r=Dt(r,e.__ownerID,0,t,n,i):o=Dt(o,e.__ownerID,e._level,t,n,i),i.value?e.__ownerID?(e._root=o,e._tail=r,e.__hash=void 0,e.__altered=!0,e):zt(e._origin,e._capacity,e._level,o,r):e}function Dt(e,t,n,r,o,i){var s,a=r>>>n&m,u=e&&a<e.array.length;if(!u&&void 0===o)return e;if(n>0){var c=e&&e.array[a],l=Dt(c,t,n-y,r,o,i);return l===c?e:((s=Mt(e,t)).array[a]=l,s)}return u&&e.array[a]===o?e:(x(i),s=Mt(e,t),void 0===o&&a===s.array.length-1?s.array.pop():s.array[a]=o,s)}function Mt(e,t){return t&&e&&t===e.ownerID?e:new jt(e?e.array.slice():[],t)}function Ut(e,t){if(t>=$t(e._capacity))return e._tail;if(t<1<<e._level+y){for(var n=e._root,r=e._level;n&&r>0;)n=n.array[t>>>r&m],r-=y;return n}}function Vt(e,t,n){void 0!==t&&(t|=0),void 0!==n&&(n|=0);var r=e.__ownerID||new E,o=e._origin,i=e._capacity,s=o+t,a=void 0===n?i:n<0?i+n:o+n;if(s===o&&a===i)return e;if(s>=a)return e.clear();for(var u=e._level,c=e._root,l=0;s+l<0;)c=new jt(c&&c.array.length?[void 0,c]:[],r),l+=1<<(u+=y);l&&(s+=l,o+=l,a+=l,i+=l);for(var h=$t(i),f=$t(a);f>=1<<u+y;)c=new jt(c&&c.array.length?[c]:[],r),u+=y;var d=e._tail,p=f<h?Ut(e,a-1):f>h?new jt([],r):d;if(d&&f>h&&s<i&&d.array.length){for(var g=c=Mt(c,r),_=u;_>y;_-=y){var v=h>>>_&m;g=g.array[v]=Mt(g.array[v],r)}g.array[h>>>y&m]=d}if(a<i&&(p=p&&p.removeAfter(r,0,a)),s>=f)s-=f,a-=f,u=y,c=null,p=p&&p.removeBefore(r,0,s);else if(s>o||f<h){for(l=0;c;){var b=s>>>u&m;if(b!==f>>>u&m)break;b&&(l+=(1<<u)*b),u-=y,c=c.array[b]}c&&s>o&&(c=c.removeBefore(r,u,s-l)),c&&f<h&&(c=c.removeAfter(r,u,f-l)),l&&(s-=l,a-=l)}return e.__ownerID?(e.size=a-s,e._origin=s,e._capacity=a,e._level=u,e._root=c,e._tail=p,e.__hash=void 0,e.__altered=!0,e):zt(s,a,u,c,p)}function Bt(e,t,n){for(var r=[],i=0,a=0;a<n.length;a++){var u=n[a],c=o(u);c.size>i&&(i=c.size),s(u)||(c=c.map((function(e){return de(e)}))),r.push(c)}return i>e.size&&(e=e.setSize(i)),gt(e,t,r)}function $t(e){return e<_?0:e-1>>>y<<y}function qt(e){return null==e?Ht():Pt(e)?e:Ht().withMutations((function(t){var n=r(e);Pe(n.size),n.forEach((function(e,n){return t.set(n,e)}))}))}function Pt(e){return He(e)&&l(e)}function Ft(e,t,n,r){var o=Object.create(qt.prototype);return o.size=e?e.size:0,o._map=e,o._list=t,o.__ownerID=n,o.__hash=r,o}function Ht(){return Rt||(Rt=Ft(ot(),Nt()))}function Kt(e,t,n){var r,o,i=e._map,s=e._list,a=i.get(t),u=void 0!==a;if(n===v){if(!u)return e;s.size>=_&&s.size>=2*i.size?(r=(o=s.filter((function(e,t){return void 0!==e&&a!==t}))).toKeyedSeq().map((function(e){return e[0]})).flip().toMap(),e.__ownerID&&(r.__ownerID=o.__ownerID=e.__ownerID)):(r=i.remove(t),o=a===s.size-1?s.pop():s.set(a,void 0))}else if(u){if(n===s.get(a)[1])return e;r=i,o=s.set(a,[t,n])}else r=i.set(t,s.size),o=s.set(s.size,[t,n]);return e.__ownerID?(e.size=r.size,e._map=r,e._list=o,e.__hash=void 0,e):Ft(r,o)}function Wt(e,t){this._iter=e,this._useKeys=t,this.size=e.size}function Zt(e){this._iter=e,this.size=e.size}function Jt(e){this._iter=e,this.size=e.size}function Gt(e){this._iter=e,this.size=e.size}function Yt(e){var t=vn(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=bn,t.__iterateUncached=function(t,n){var r=this;return e.__iterate((function(e,n){return!1!==t(n,e,r)}),n)},t.__iteratorUncached=function(t,n){if(t===L){var r=e.__iterator(t,n);return new V((function(){var e=r.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e}))}return e.__iterator(t===N?z:N,n)},t}function Xt(e,t,n){var r=vn(e);return r.size=e.size,r.has=function(t){return e.has(t)},r.get=function(r,o){var i=e.get(r,v);return i===v?o:t.call(n,i,r,e)},r.__iterateUncached=function(r,o){var i=this;return e.__iterate((function(e,o,s){return!1!==r(t.call(n,e,o,s),o,i)}),o)},r.__iteratorUncached=function(r,o){var i=e.__iterator(L,o);return new V((function(){var o=i.next();if(o.done)return o;var s=o.value,a=s[0];return B(r,a,t.call(n,s[1],a,e),o)}))},r}function Qt(e,t){var n=vn(e);return n._iter=e,n.size=e.size,n.reverse=function(){return e},e.flip&&(n.flip=function(){var t=Yt(e);return t.reverse=function(){return e.flip()},t}),n.get=function(n,r){return e.get(t?n:-1-n,r)},n.has=function(n){return e.has(t?n:-1-n)},n.includes=function(t){return e.includes(t)},n.cacheResult=bn,n.__iterate=function(t,n){var r=this;return e.__iterate((function(e,n){return t(e,n,r)}),!n)},n.__iterator=function(t,n){return e.__iterator(t,!n)},n}function en(e,t,n,r){var o=vn(e);return r&&(o.has=function(r){var o=e.get(r,v);return o!==v&&!!t.call(n,o,r,e)},o.get=function(r,o){var i=e.get(r,v);return i!==v&&t.call(n,i,r,e)?i:o}),o.__iterateUncached=function(o,i){var s=this,a=0;return e.__iterate((function(e,i,u){if(t.call(n,e,i,u))return a++,o(e,r?i:a-1,s)}),i),a},o.__iteratorUncached=function(o,i){var s=e.__iterator(L,i),a=0;return new V((function(){for(;;){var i=s.next();if(i.done)return i;var u=i.value,c=u[0],l=u[1];if(t.call(n,l,c,e))return B(o,r?c:a++,l,i)}}))},o}function tn(e,t,n){var r=Fe().asMutable();return e.__iterate((function(o,i){r.update(t.call(n,o,i,e),0,(function(e){return e+1}))})),r.asImmutable()}function nn(e,t,n){var r=a(e),o=(l(e)?qt():Fe()).asMutable();e.__iterate((function(i,s){o.update(t.call(n,i,s,e),(function(e){return(e=e||[]).push(r?[s,i]:i),e}))}));var i=mn(e);return o.map((function(t){return gn(e,i(t))}))}function rn(e,t,n,r){var o=e.size;if(void 0!==t&&(t|=0),void 0!==n&&(n===1/0?n=o:n|=0),A(t,n,o))return e;var i=R(t,o),s=C(n,o);if(i!=i||s!=s)return rn(e.toSeq().cacheResult(),t,n,r);var a,u=s-i;u==u&&(a=u<0?0:u);var c=vn(e);return c.size=0===a?a:e.size&&a||void 0,!r&&ie(e)&&a>=0&&(c.get=function(t,n){return(t=O(this,t))>=0&&t<a?e.get(t+i,n):n}),c.__iterateUncached=function(t,n){var o=this;if(0===a)return 0;if(n)return this.cacheResult().__iterate(t,n);var s=0,u=!0,c=0;return e.__iterate((function(e,n){if(!u||!(u=s++<i))return c++,!1!==t(e,r?n:c-1,o)&&c!==a})),c},c.__iteratorUncached=function(t,n){if(0!==a&&n)return this.cacheResult().__iterator(t,n);var o=0!==a&&e.__iterator(t,n),s=0,u=0;return new V((function(){for(;s++<i;)o.next();if(++u>a)return $();var e=o.next();return r||t===N?e:B(t,u-1,t===z?void 0:e.value[1],e)}))},c}function on(e,t,n){var r=vn(e);return r.__iterateUncached=function(r,o){var i=this;if(o)return this.cacheResult().__iterate(r,o);var s=0;return e.__iterate((function(e,o,a){return t.call(n,e,o,a)&&++s&&r(e,o,i)})),s},r.__iteratorUncached=function(r,o){var i=this;if(o)return this.cacheResult().__iterator(r,o);var s=e.__iterator(L,o),a=!0;return new V((function(){if(!a)return $();var e=s.next();if(e.done)return e;var o=e.value,u=o[0],c=o[1];return t.call(n,c,u,i)?r===L?e:B(r,u,c,e):(a=!1,$())}))},r}function sn(e,t,n,r){var o=vn(e);return o.__iterateUncached=function(o,i){var s=this;if(i)return this.cacheResult().__iterate(o,i);var a=!0,u=0;return e.__iterate((function(e,i,c){if(!a||!(a=t.call(n,e,i,c)))return u++,o(e,r?i:u-1,s)})),u},o.__iteratorUncached=function(o,i){var s=this;if(i)return this.cacheResult().__iterator(o,i);var a=e.__iterator(L,i),u=!0,c=0;return new V((function(){var e,i,l;do{if((e=a.next()).done)return r||o===N?e:B(o,c++,o===z?void 0:e.value[1],e);var h=e.value;i=h[0],l=h[1],u&&(u=t.call(n,l,i,s))}while(u);return o===L?e:B(o,i,l,e)}))},o}function an(e,t){var n=a(e),o=[e].concat(t).map((function(e){return s(e)?n&&(e=r(e)):e=n?ae(e):ue(Array.isArray(e)?e:[e]),e})).filter((function(e){return 0!==e.size}));if(0===o.length)return e;if(1===o.length){var i=o[0];if(i===e||n&&a(i)||u(e)&&u(i))return i}var c=new te(o);return n?c=c.toKeyedSeq():u(e)||(c=c.toSetSeq()),(c=c.flatten(!0)).size=o.reduce((function(e,t){if(void 0!==e){var n=t.size;if(void 0!==n)return e+n}}),0),c}function un(e,t,n){var r=vn(e);return r.__iterateUncached=function(r,o){var i=0,a=!1;function u(e,c){var l=this;e.__iterate((function(e,o){return(!t||c<t)&&s(e)?u(e,c+1):!1===r(e,n?o:i++,l)&&(a=!0),!a}),o)}return u(e,0),i},r.__iteratorUncached=function(r,o){var i=e.__iterator(r,o),a=[],u=0;return new V((function(){for(;i;){var e=i.next();if(!1===e.done){var c=e.value;if(r===L&&(c=c[1]),t&&!(a.length<t)||!s(c))return n?e:B(r,u++,c,e);a.push(i),i=c.__iterator(r,o)}else i=a.pop()}return $()}))},r}function cn(e,t,n){var r=mn(e);return e.toSeq().map((function(o,i){return r(t.call(n,o,i,e))})).flatten(!0)}function ln(e,t){var n=vn(e);return n.size=e.size&&2*e.size-1,n.__iterateUncached=function(n,r){var o=this,i=0;return e.__iterate((function(e,r){return(!i||!1!==n(t,i++,o))&&!1!==n(e,i++,o)}),r),i},n.__iteratorUncached=function(n,r){var o,i=e.__iterator(N,r),s=0;return new V((function(){return(!o||s%2)&&(o=i.next()).done?o:s%2?B(n,s++,t):B(n,s++,o.value,o)}))},n}function hn(e,t,n){t||(t=wn);var r=a(e),o=0,i=e.toSeq().map((function(t,r){return[r,t,o++,n?n(t,r,e):t]})).toArray();return i.sort((function(e,n){return t(e[3],n[3])||e[2]-n[2]})).forEach(r?function(e,t){i[t].length=2}:function(e,t){i[t]=e[1]}),r?Z(i):u(e)?J(i):G(i)}function fn(e,t,n){if(t||(t=wn),n){var r=e.toSeq().map((function(t,r){return[t,n(t,r,e)]})).reduce((function(e,n){return dn(t,e[1],n[1])?n:e}));return r&&r[0]}return e.reduce((function(e,n){return dn(t,e,n)?n:e}))}function dn(e,t,n){var r=e(n,t);return 0===r&&n!==t&&(null==n||n!=n)||r>0}function pn(e,t,r){var o=vn(e);return o.size=new te(r).map((function(e){return e.size})).min(),o.__iterate=function(e,t){for(var n,r=this.__iterator(N,t),o=0;!(n=r.next()).done&&!1!==e(n.value,o++,this););return o},o.__iteratorUncached=function(e,o){var i=r.map((function(e){return e=n(e),F(o?e.reverse():e)})),s=0,a=!1;return new V((function(){var n;return a||(n=i.map((function(e){return e.next()})),a=n.some((function(e){return e.done}))),a?$():B(e,s++,t.apply(null,n.map((function(e){return e.value}))))}))},o}function gn(e,t){return ie(e)?t:e.constructor(t)}function yn(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function _n(e){return Pe(e.size),S(e)}function mn(e){return a(e)?r:u(e)?o:i}function vn(e){return Object.create((a(e)?Z:u(e)?J:G).prototype)}function bn(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):W.prototype.cacheResult.call(this)}function wn(e,t){return e>t?1:e<t?-1:0}function In(e){var t=F(e);if(!t){if(!K(e))throw new TypeError("Expected iterable or array-like: "+e);t=F(n(e))}return t}function xn(e,t){var n,r=function(i){if(i instanceof r)return i;if(!(this instanceof r))return new r(i);if(!n){n=!0;var s=Object.keys(e);On(o,s),o.size=s.length,o._name=t,o._keys=s,o._defaultValues=e}this._map=Fe(i)},o=r.prototype=Object.create(En);return o.constructor=r,r}t(qt,Fe),qt.of=function(){return this(arguments)},qt.prototype.toString=function(){return this.__toString("OrderedMap {","}")},qt.prototype.get=function(e,t){var n=this._map.get(e);return void 0!==n?this._list.get(n)[1]:t},qt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):Ht()},qt.prototype.set=function(e,t){return Kt(this,e,t)},qt.prototype.remove=function(e){return Kt(this,e,v)},qt.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},qt.prototype.__iterate=function(e,t){var n=this;return this._list.__iterate((function(t){return t&&e(t[1],t[0],n)}),t)},qt.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},qt.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),n=this._list.__ensureOwner(e);return e?Ft(t,n,e,this.__hash):(this.__ownerID=e,this._map=t,this._list=n,this)},qt.isOrderedMap=Pt,qt.prototype[p]=!0,qt.prototype[g]=qt.prototype.remove,t(Wt,Z),Wt.prototype.get=function(e,t){return this._iter.get(e,t)},Wt.prototype.has=function(e){return this._iter.has(e)},Wt.prototype.valueSeq=function(){return this._iter.valueSeq()},Wt.prototype.reverse=function(){var e=this,t=Qt(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},Wt.prototype.map=function(e,t){var n=this,r=Xt(this,e,t);return this._useKeys||(r.valueSeq=function(){return n._iter.toSeq().map(e,t)}),r},Wt.prototype.__iterate=function(e,t){var n,r=this;return this._iter.__iterate(this._useKeys?function(t,n){return e(t,n,r)}:(n=t?_n(this):0,function(o){return e(o,t?--n:n++,r)}),t)},Wt.prototype.__iterator=function(e,t){if(this._useKeys)return this._iter.__iterator(e,t);var n=this._iter.__iterator(N,t),r=t?_n(this):0;return new V((function(){var o=n.next();return o.done?o:B(e,t?--r:r++,o.value,o)}))},Wt.prototype[p]=!0,t(Zt,J),Zt.prototype.includes=function(e){return this._iter.includes(e)},Zt.prototype.__iterate=function(e,t){var n=this,r=0;return this._iter.__iterate((function(t){return e(t,r++,n)}),t)},Zt.prototype.__iterator=function(e,t){var n=this._iter.__iterator(N,t),r=0;return new V((function(){var t=n.next();return t.done?t:B(e,r++,t.value,t)}))},t(Jt,G),Jt.prototype.has=function(e){return this._iter.includes(e)},Jt.prototype.__iterate=function(e,t){var n=this;return this._iter.__iterate((function(t){return e(t,t,n)}),t)},Jt.prototype.__iterator=function(e,t){var n=this._iter.__iterator(N,t);return new V((function(){var t=n.next();return t.done?t:B(e,t.value,t.value,t)}))},t(Gt,Z),Gt.prototype.entrySeq=function(){return this._iter.toSeq()},Gt.prototype.__iterate=function(e,t){var n=this;return this._iter.__iterate((function(t){if(t){yn(t);var r=s(t);return e(r?t.get(1):t[1],r?t.get(0):t[0],n)}}),t)},Gt.prototype.__iterator=function(e,t){var n=this._iter.__iterator(N,t);return new V((function(){for(;;){var t=n.next();if(t.done)return t;var r=t.value;if(r){yn(r);var o=s(r);return B(e,o?r.get(0):r[0],o?r.get(1):r[1],t)}}}))},Zt.prototype.cacheResult=Wt.prototype.cacheResult=Jt.prototype.cacheResult=Gt.prototype.cacheResult=bn,t(xn,xe),xn.prototype.toString=function(){return this.__toString(Sn(this)+" {","}")},xn.prototype.has=function(e){return this._defaultValues.hasOwnProperty(e)},xn.prototype.get=function(e,t){if(!this.has(e))return t;var n=this._defaultValues[e];return this._map?this._map.get(e,n):n},xn.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var e=this.constructor;return e._empty||(e._empty=kn(this,ot()))},xn.prototype.set=function(e,t){if(!this.has(e))throw new Error('Cannot set unknown key "'+e+'" on '+Sn(this));if(this._map&&!this._map.has(e)&&t===this._defaultValues[e])return this;var n=this._map&&this._map.set(e,t);return this.__ownerID||n===this._map?this:kn(this,n)},xn.prototype.remove=function(e){if(!this.has(e))return this;var t=this._map&&this._map.remove(e);return this.__ownerID||t===this._map?this:kn(this,t)},xn.prototype.wasAltered=function(){return this._map.wasAltered()},xn.prototype.__iterator=function(e,t){var n=this;return r(this._defaultValues).map((function(e,t){return n.get(t)})).__iterator(e,t)},xn.prototype.__iterate=function(e,t){var n=this;return r(this._defaultValues).map((function(e,t){return n.get(t)})).__iterate(e,t)},xn.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map&&this._map.__ensureOwner(e);return e?kn(this,t,e):(this.__ownerID=e,this._map=t,this)};var En=xn.prototype;function kn(e,t,n){var r=Object.create(Object.getPrototypeOf(e));return r._map=t,r.__ownerID=n,r}function Sn(e){return e._name||e.constructor.name||"Record"}function On(e,t){try{t.forEach(jn.bind(void 0,e))}catch(n){}}function jn(e,t){Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){be(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}function An(e){return null==e?Dn():Rn(e)&&!l(e)?e:Dn().withMutations((function(t){var n=i(e);Pe(n.size),n.forEach((function(e){return t.add(e)}))}))}function Rn(e){return!(!e||!e[Tn])}En[g]=En.remove,En.deleteIn=En.removeIn=Ze.removeIn,En.merge=Ze.merge,En.mergeWith=Ze.mergeWith,En.mergeIn=Ze.mergeIn,En.mergeDeep=Ze.mergeDeep,En.mergeDeepWith=Ze.mergeDeepWith,En.mergeDeepIn=Ze.mergeDeepIn,En.setIn=Ze.setIn,En.update=Ze.update,En.updateIn=Ze.updateIn,En.withMutations=Ze.withMutations,En.asMutable=Ze.asMutable,En.asImmutable=Ze.asImmutable,t(An,ke),An.of=function(){return this(arguments)},An.fromKeys=function(e){return this(r(e).keySeq())},An.prototype.toString=function(){return this.__toString("Set {","}")},An.prototype.has=function(e){return this._map.has(e)},An.prototype.add=function(e){return Nn(this,this._map.set(e,!0))},An.prototype.remove=function(e){return Nn(this,this._map.remove(e))},An.prototype.clear=function(){return Nn(this,this._map.clear())},An.prototype.union=function(){var t=e.call(arguments,0);return 0===(t=t.filter((function(e){return 0!==e.size}))).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations((function(e){for(var n=0;n<t.length;n++)i(t[n]).forEach((function(t){return e.add(t)}))})):this.constructor(t[0])},An.prototype.intersect=function(){var t=e.call(arguments,0);if(0===t.length)return this;t=t.map((function(e){return i(e)}));var n=this;return this.withMutations((function(e){n.forEach((function(n){t.every((function(e){return e.includes(n)}))||e.remove(n)}))}))},An.prototype.subtract=function(){var t=e.call(arguments,0);if(0===t.length)return this;t=t.map((function(e){return i(e)}));var n=this;return this.withMutations((function(e){n.forEach((function(n){t.some((function(e){return e.includes(n)}))&&e.remove(n)}))}))},An.prototype.merge=function(){return this.union.apply(this,arguments)},An.prototype.mergeWith=function(t){var n=e.call(arguments,1);return this.union.apply(this,n)},An.prototype.sort=function(e){return Mn(hn(this,e))},An.prototype.sortBy=function(e,t){return Mn(hn(this,t,e))},An.prototype.wasAltered=function(){return this._map.wasAltered()},An.prototype.__iterate=function(e,t){var n=this;return this._map.__iterate((function(t,r){return e(r,r,n)}),t)},An.prototype.__iterator=function(e,t){return this._map.map((function(e,t){return t})).__iterator(e,t)},An.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):(this.__ownerID=e,this._map=t,this)},An.isSet=Rn;var Cn,Tn="@@__IMMUTABLE_SET__@@",zn=An.prototype;function Nn(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function Ln(e,t){var n=Object.create(zn);return n.size=e?e.size:0,n._map=e,n.__ownerID=t,n}function Dn(){return Cn||(Cn=Ln(ot()))}function Mn(e){return null==e?qn():Un(e)?e:qn().withMutations((function(t){var n=i(e);Pe(n.size),n.forEach((function(e){return t.add(e)}))}))}function Un(e){return Rn(e)&&l(e)}zn[Tn]=!0,zn[g]=zn.remove,zn.mergeDeep=zn.merge,zn.mergeDeepWith=zn.mergeWith,zn.withMutations=Ze.withMutations,zn.asMutable=Ze.asMutable,zn.asImmutable=Ze.asImmutable,zn.__empty=Dn,zn.__make=Ln,t(Mn,An),Mn.of=function(){return this(arguments)},Mn.fromKeys=function(e){return this(r(e).keySeq())},Mn.prototype.toString=function(){return this.__toString("OrderedSet {","}")},Mn.isOrderedSet=Un;var Vn,Bn=Mn.prototype;function $n(e,t){var n=Object.create(Bn);return n.size=e?e.size:0,n._map=e,n.__ownerID=t,n}function qn(){return Vn||(Vn=$n(Ht()))}function Pn(e){return null==e?Jn():Fn(e)?e:Jn().unshiftAll(e)}function Fn(e){return!(!e||!e[Kn])}Bn[p]=!0,Bn.__empty=qn,Bn.__make=$n,t(Pn,Ee),Pn.of=function(){return this(arguments)},Pn.prototype.toString=function(){return this.__toString("Stack [","]")},Pn.prototype.get=function(e,t){var n=this._head;for(e=O(this,e);n&&e--;)n=n.next;return n?n.value:t},Pn.prototype.peek=function(){return this._head&&this._head.value},Pn.prototype.push=function(){if(0===arguments.length)return this;for(var e=this.size+arguments.length,t=this._head,n=arguments.length-1;n>=0;n--)t={value:arguments[n],next:t};return this.__ownerID?(this.size=e,this._head=t,this.__hash=void 0,this.__altered=!0,this):Zn(e,t)},Pn.prototype.pushAll=function(e){if(0===(e=o(e)).size)return this;Pe(e.size);var t=this.size,n=this._head;return e.reverse().forEach((function(e){t++,n={value:e,next:n}})),this.__ownerID?(this.size=t,this._head=n,this.__hash=void 0,this.__altered=!0,this):Zn(t,n)},Pn.prototype.pop=function(){return this.slice(1)},Pn.prototype.unshift=function(){return this.push.apply(this,arguments)},Pn.prototype.unshiftAll=function(e){return this.pushAll(e)},Pn.prototype.shift=function(){return this.pop.apply(this,arguments)},Pn.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Jn()},Pn.prototype.slice=function(e,t){if(A(e,t,this.size))return this;var n=R(e,this.size);if(C(t,this.size)!==this.size)return Ee.prototype.slice.call(this,e,t);for(var r=this.size-n,o=this._head;n--;)o=o.next;return this.__ownerID?(this.size=r,this._head=o,this.__hash=void 0,this.__altered=!0,this):Zn(r,o)},Pn.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Zn(this.size,this._head,e,this.__hash):(this.__ownerID=e,this.__altered=!1,this)},Pn.prototype.__iterate=function(e,t){if(t)return this.reverse().__iterate(e);for(var n=0,r=this._head;r&&!1!==e(r.value,n++,this);)r=r.next;return n},Pn.prototype.__iterator=function(e,t){if(t)return this.reverse().__iterator(e);var n=0,r=this._head;return new V((function(){if(r){var t=r.value;return r=r.next,B(e,n++,t)}return $()}))},Pn.isStack=Fn;var Hn,Kn="@@__IMMUTABLE_STACK__@@",Wn=Pn.prototype;function Zn(e,t,n,r){var o=Object.create(Wn);return o.size=e,o._head=t,o.__ownerID=n,o.__hash=r,o.__altered=!1,o}function Jn(){return Hn||(Hn=Zn(0))}function Gn(e,t){var n=function(n){e.prototype[n]=t[n]};return Object.keys(t).forEach(n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(n),e}Wn[Kn]=!0,Wn.withMutations=Ze.withMutations,Wn.asMutable=Ze.asMutable,Wn.asImmutable=Ze.asImmutable,Wn.wasAltered=Ze.wasAltered,n.Iterator=V,Gn(n,{toArray:function(){Pe(this.size);var e=new Array(this.size||0);return this.valueSeq().__iterate((function(t,n){e[n]=t})),e},toIndexedSeq:function(){return new Zt(this)},toJS:function(){return this.toSeq().map((function(e){return e&&"function"==typeof e.toJS?e.toJS():e})).__toJS()},toJSON:function(){return this.toSeq().map((function(e){return e&&"function"==typeof e.toJSON?e.toJSON():e})).__toJS()},toKeyedSeq:function(){return new Wt(this,!0)},toMap:function(){return Fe(this.toKeyedSeq())},toObject:function(){Pe(this.size);var e={};return this.__iterate((function(t,n){e[n]=t})),e},toOrderedMap:function(){return qt(this.toKeyedSeq())},toOrderedSet:function(){return Mn(a(this)?this.valueSeq():this)},toSet:function(){return An(a(this)?this.valueSeq():this)},toSetSeq:function(){return new Jt(this)},toSeq:function(){return u(this)?this.toIndexedSeq():a(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Pn(a(this)?this.valueSeq():this)},toList:function(){return Et(a(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){return gn(this,an(this,e.call(arguments,0)))},includes:function(e){return this.some((function(t){return _e(t,e)}))},entries:function(){return this.__iterator(L)},every:function(e,t){Pe(this.size);var n=!0;return this.__iterate((function(r,o,i){if(!e.call(t,r,o,i))return n=!1,!1})),n},filter:function(e,t){return gn(this,en(this,e,t,!0))},find:function(e,t,n){var r=this.findEntry(e,t);return r?r[1]:n},forEach:function(e,t){return Pe(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){Pe(this.size),e=void 0!==e?""+e:",";var t="",n=!0;return this.__iterate((function(r){n?n=!1:t+=e,t+=null!=r?r.toString():""})),t},keys:function(){return this.__iterator(z)},map:function(e,t){return gn(this,Xt(this,e,t))},reduce:function(e,t,n){var r,o;return Pe(this.size),arguments.length<2?o=!0:r=t,this.__iterate((function(t,i,s){o?(o=!1,r=t):r=e.call(n,r,t,i,s)})),r},reduceRight:function(e,t,n){var r=this.toKeyedSeq().reverse();return r.reduce.apply(r,arguments)},reverse:function(){return gn(this,Qt(this,!0))},slice:function(e,t){return gn(this,rn(this,e,t,!0))},some:function(e,t){return!this.every(tr(e),t)},sort:function(e){return gn(this,hn(this,e))},values:function(){return this.__iterator(N)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(e,t){return S(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){return tn(this,e,t)},equals:function(e){return me(this,e)},entrySeq:function(){var e=this;if(e._cache)return new te(e._cache);var t=e.toSeq().map(er).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(tr(e),t)},findEntry:function(e,t,n){var r=n;return this.__iterate((function(n,o,i){if(e.call(t,n,o,i))return r=[o,n],!1})),r},findKey:function(e,t){var n=this.findEntry(e,t);return n&&n[0]},findLast:function(e,t,n){return this.toKeyedSeq().reverse().find(e,t,n)},findLastEntry:function(e,t,n){return this.toKeyedSeq().reverse().findEntry(e,t,n)},findLastKey:function(e,t){return this.toKeyedSeq().reverse().findKey(e,t)},first:function(){return this.find(j)},flatMap:function(e,t){return gn(this,cn(this,e,t))},flatten:function(e){return gn(this,un(this,e,!0))},fromEntrySeq:function(){return new Gt(this)},get:function(e,t){return this.find((function(t,n){return _e(n,e)}),void 0,t)},getIn:function(e,t){for(var n,r=this,o=In(e);!(n=o.next()).done;){var i=n.value;if((r=r&&r.get?r.get(i,v):v)===v)return t}return r},groupBy:function(e,t){return nn(this,e,t)},has:function(e){return this.get(e,v)!==v},hasIn:function(e){return this.getIn(e,v)!==v},isSubset:function(e){return e="function"==typeof e.includes?e:n(e),this.every((function(t){return e.includes(t)}))},isSuperset:function(e){return(e="function"==typeof e.isSubset?e:n(e)).isSubset(this)},keyOf:function(e){return this.findKey((function(t){return _e(t,e)}))},keySeq:function(){return this.toSeq().map(Qn).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return fn(this,e)},maxBy:function(e,t){return fn(this,t,e)},min:function(e){return fn(this,e?nr(e):ir)},minBy:function(e,t){return fn(this,t?nr(t):ir,e)},rest:function(){return this.slice(1)},skip:function(e){return this.slice(Math.max(0,e))},skipLast:function(e){return gn(this,this.toSeq().reverse().skip(e).reverse())},skipWhile:function(e,t){return gn(this,sn(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(tr(e),t)},sortBy:function(e,t){return gn(this,hn(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return gn(this,this.toSeq().reverse().take(e).reverse())},takeWhile:function(e,t){return gn(this,on(this,e,t))},takeUntil:function(e,t){return this.takeWhile(tr(e),t)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=sr(this))}});var Yn=n.prototype;Yn[h]=!0,Yn[U]=Yn.values,Yn.__toJS=Yn.toArray,Yn.__toStringMapper=rr,Yn.inspect=Yn.toSource=function(){return this.toString()},Yn.chain=Yn.flatMap,Yn.contains=Yn.includes,Gn(r,{flip:function(){return gn(this,Yt(this))},mapEntries:function(e,t){var n=this,r=0;return gn(this,this.toSeq().map((function(o,i){return e.call(t,[i,o],r++,n)})).fromEntrySeq())},mapKeys:function(e,t){var n=this;return gn(this,this.toSeq().flip().map((function(r,o){return e.call(t,r,o,n)})).flip())}});var Xn=r.prototype;function Qn(e,t){return t}function er(e,t){return[t,e]}function tr(e){return function(){return!e.apply(this,arguments)}}function nr(e){return function(){return-e.apply(this,arguments)}}function rr(e){return"string"==typeof e?JSON.stringify(e):String(e)}function or(){return k(arguments)}function ir(e,t){return e<t?1:e>t?-1:0}function sr(e){if(e.size===1/0)return 0;var t=l(e),n=a(e),r=t?1:0;return ar(e.__iterate(n?t?function(e,t){r=31*r+ur(je(e),je(t))|0}:function(e,t){r=r+ur(je(e),je(t))|0}:t?function(e){r=31*r+je(e)|0}:function(e){r=r+je(e)|0}),r)}function ar(e,t){return t=Se(t,3432918353),t=Se(t<<15|t>>>-15,461845907),t=Se(t<<13|t>>>-13,5),t=Se((t=(t+3864292196|0)^e)^t>>>16,2246822507),t=Oe((t=Se(t^t>>>13,3266489909))^t>>>16)}function ur(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}return Xn[f]=!0,Xn[U]=Yn.entries,Xn.__toJS=Yn.toObject,Xn.__toStringMapper=function(e,t){return JSON.stringify(t)+": "+rr(e)},Gn(o,{toKeyedSeq:function(){return new Wt(this,!1)},filter:function(e,t){return gn(this,en(this,e,t,!1))},findIndex:function(e,t){var n=this.findEntry(e,t);return n?n[0]:-1},indexOf:function(e){var t=this.keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.lastKeyOf(e);return void 0===t?-1:t},reverse:function(){return gn(this,Qt(this,!1))},slice:function(e,t){return gn(this,rn(this,e,t,!1))},splice:function(e,t){var n=arguments.length;if(t=Math.max(0|t,0),0===n||2===n&&!t)return this;e=R(e,e<0?this.count():this.size);var r=this.slice(0,e);return gn(this,1===n?r:r.concat(k(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var n=this.findLastEntry(e,t);return n?n[0]:-1},first:function(){return this.get(0)},flatten:function(e){return gn(this,un(this,e,!1))},get:function(e,t){return(e=O(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find((function(t,n){return n===e}),void 0,t)},has:function(e){return(e=O(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){return gn(this,ln(this,e))},interleave:function(){var e=[this].concat(k(arguments)),t=pn(this.toSeq(),J.of,e),n=t.flatten(!0);return t.size&&(n.size=t.size*e.length),gn(this,n)},keySeq:function(){return we(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(e,t){return gn(this,sn(this,e,t,!1))},zip:function(){return gn(this,pn(this,or,[this].concat(k(arguments))))},zipWith:function(e){var t=k(arguments);return t[0]=this,gn(this,pn(this,e,t))}}),o.prototype[d]=!0,o.prototype[p]=!0,Gn(i,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}}),i.prototype.has=Yn.includes,i.prototype.contains=i.prototype.includes,Gn(Z,r.prototype),Gn(J,o.prototype),Gn(G,i.prototype),Gn(xe,r.prototype),Gn(Ee,o.prototype),Gn(ke,i.prototype),{Iterable:n,Seq:W,Collection:Ie,Map:Fe,OrderedMap:qt,List:Et,Stack:Pn,Set:An,OrderedSet:Mn,Record:xn,Range:we,Repeat:ve,is:_e,fromJS:de}}();const{Map:Ba}=Va.exports;class $a{constructor(e,t,n,r,o,i,s){this.key=e,this.value=t,this.level=n,this.prevKey=r,this.nextKey=o,this.prevCount=i,this.nextCount=s}setValue(e){return new $a(this.key,e,this.level,this.prevKey,this.nextKey,this.prevCount,this.nextCount)}insertAfter(e,t,n,r){if(t>this.level&&null!==this.key)throw new RangeError("Cannot increase the level of a non-head node");const o=Math.max(this.level,t),i=this.nextKey.slice(),s=this.nextCount.slice();for(let a=n;a<o;a++)a<t?(i[a]=e,s[a]=r):s[a]+=1;return new $a(this.key,this.value,o,this.prevKey,i,this.prevCount,s)}insertBefore(e,t,n,r){if(t>this.level)throw new RangeError("Cannot increase node level");const o=this.prevKey.slice(),i=this.prevCount.slice();for(let s=n;s<this.level;s++)s<t?(o[s]=e,i[s]=r):i[s]+=1;return new $a(this.key,this.value,this.level,o,this.nextKey,i,this.nextCount)}removeAfter(e,t,n,r){const o=this.nextKey.slice(),i=this.nextCount.slice();for(let s=e;s<this.level;s++)s<t?(o[s]=n[s],i[s]=r[s]):i[s]-=1;return new $a(this.key,this.value,this.level,this.prevKey,o,this.prevCount,i)}removeBefore(e,t,n,r){const o=this.prevKey.slice(),i=this.prevCount.slice();for(let s=e;s<this.level;s++)s<t?(o[s]=n[s],i[s]=r[s]):i[s]-=1;return new $a(this.key,this.value,this.level,o,this.nextKey,i,this.nextCount)}}class qa{constructor(e){const t=new $a(null,null,1,[],[null],[],[null]),n=e?e():{next(){const e=Math.floor(4294967296*Math.random());let t=1;for(;e<1<<32-2*t&&t<16;)t+=1;return{value:t,done:!1}}};return Pa(0,Ba().set(null,t),n)}get headNode(){return this._nodes.get(null)}predecessors(e,t){const n=[e],r=[1];for(let o=1;o<t;o++){let e=n[o-1],t=r[o-1];for(;e;){let n=this._nodes.get(e);if(n.level>o)break;if(n.level<o)throw new RangeError("Node "+e+" below expected level "+(o-1));t+=n.prevCount[o-1],e=n.prevKey[o-1]}n[o]=e,r[o]=t}return{preKeys:n,preCounts:r}}successors(e,t){const n=[e],r=[1];for(let o=1;o<t;o++){let e=n[o-1],t=r[o-1];for(;e;){let n=this._nodes.get(e);if(n.level>o)break;if(n.level<o)throw new RangeError("Node "+e+" below expected level "+(o-1));t+=n.nextCount[o-1],e=n.nextKey[o-1]}n[o]=e,r[o]=t}return{sucKeys:n,sucCounts:r}}insertAfter(e,t,n){if("string"!=typeof t||""===t)throw new RangeError("Key must be a nonempty string");if(!this._nodes.has(e))throw new RangeError("The referenced predecessor key does not exist");if(this._nodes.has(t))throw new RangeError("Cannot insert a key that already exists");const r=this._randomSource.next().value,o=Math.max(r,this.headNode.level),i=this._nodes.get(e).nextKey[0]||null,{preKeys:s,preCounts:a}=this.predecessors(e,o),{sucKeys:u,sucCounts:c}=this.successors(i,o);return Pa(this.length+1,this._nodes.withMutations((e=>{let i=0,l=0;for(let n=1;n<=o;n++){const h=Math.min(n,r);n!==o&&s[n]===s[i]||(e.update(s[i],(e=>e.insertAfter(t,h,i,a[i]))),i=n),!u[l]||n!==o&&u[n]===u[l]||(e.update(u[l],(e=>e.insertBefore(t,h,l,c[l]))),l=n)}e.set(t,new $a(t,n,r,s.slice(0,r),u.slice(0,r),a.slice(0,r),c.slice(0,r)))})),this._randomSource)}insertIndex(e,t,n){if("number"!=typeof e||e<0)throw new RangeError("Index must be a non-negative integer");return 0===e?this.insertAfter(null,t,n):this.insertAfter(this.keyOf(e-1),t,n)}removeKey(e){if("string"!=typeof e||!this._nodes.has(e))throw new RangeError("The given key cannot be removed because it does not exist");const t=this._nodes.get(e),n=this.headNode.level,{preKeys:r,preCounts:o}=this.predecessors(t.prevKey[0],n),{sucKeys:i,sucCounts:s}=this.successors(t.nextKey[0],n),a=new Array(n);for(let u=0;u<n;u++)a[u]=o[u]+s[u]-1;return Pa(this.length-1,this._nodes.withMutations((o=>{o.remove(e);let s=0,u=0;for(let e=1;e<=n;e++){const c=Math.min(e,t.level);e!==n&&r[e]===r[s]||(o.update(r[s],(e=>e.removeAfter(s,c,i,a))),s=e),!i[u]||e!==n&&i[e]===i[u]||(o.update(i[u],(e=>e.removeBefore(u,c,r,a))),u=e)}})),this._randomSource)}removeIndex(e){return this.removeKey(this.keyOf(e))}indexOf(e){if("string"!=typeof e||""===e||!this._nodes.has(e))return-1;let t=this._nodes.get(e),n=0;for(;t&&t.key;)n+=t.prevCount[t.level-1],t=this._nodes.get(t.prevKey[t.level-1]);return n-1}keyOf(e){if("number"!=typeof e)return null;if(e<0&&(e+=this.length),e<0||e>=this.length)return null;let t=this._nodes.get(null),n=t.level-1,r=0;for(;;){if(r===e+1)return t.key;r+t.nextCount[n]>e+1?n-=1:(r+=t.nextCount[n],t=this._nodes.get(t.nextKey[n]))}}getValue(e){if("string"!=typeof e||""===e)throw new RangeError("Key must be a nonempty string");const t=this._nodes.get(e);return t&&t.value}setValue(e,t){if("string"!=typeof e||""===e)throw new RangeError("Key must be a nonempty string");let n=this._nodes.get(e);if(!n)throw new RangeError("The referenced key does not exist");return n=n.setValue(t),Pa(this.length,this._nodes.set(e,n),this._randomSource)}iterator(e){const t=this._nodes;let n=t.get(null).nextKey[0];return{next(){if(!n)return{value:void 0,done:!0};const r=t.get(n);let o;switch(e){case"keys":o={value:n,done:!1};break;case"values":o={value:r.value,done:!1};break;case"entries":o={value:[n,r.value],done:!1}}return n=r.nextKey[0],o},[Symbol.iterator]:()=>this.iterator(e)}}[Symbol.iterator](){return this.iterator("values")}}function Pa(e,t,n){const r=Object.create(qa.prototype);return r.length=e,r._nodes=t,r._randomSource=n,r}var Fa={SkipList:qa};const{Map:Ha,List:Ka,Set:Wa,fromJS:Za}=Va.exports,{SkipList:Ja}=Fa,{decodeChange:Ga,decodeChangeMeta:Ya,appendEdit:Xa}=Ua,{parseOpId:Qa}=ct;function eu(e,t){for(let n of t.deps)if(!e.hasIn(["hashes",n]))return!1;return!0}function tu(e,t){if("_root"===t)return"map";const n=e.getIn(["byObject",t,"_init","action"]),r={makeMap:"map",makeTable:"table",makeList:"list",makeText:"text"}[n];if(!r)throw new RangeError(`Unknown object type ${n} for ${t}`);return r}function nu(e,t,n){const r=ou(t),o=t.get("action");if(e.hasIn(["byObject",r,"_keys"]))throw new Error(`Duplicate creation of object ${r}`);let i=Ha({_init:t,_inbound:Wa(),_keys:Ha()});return"makeList"!==o&&"makeText"!==o||(i=i.set("_elemIds",new Ja)),e=e.setIn(["byObject",r],i),n&&(n.objectId=r,n.type=tu(e,r),n.props={},"list"!==n.type&&"text"!==n.type||(n.edits=[])),e}function ru(e){const t=e.get("action");return t.startsWith("make")||"link"===t}function ou(e){return e.get("child",e.get("opId"))}function iu(e){const t=e.get("key");if(t)return t;const n=e.get("insert")?e.get("opId"):e.get("elemId");if(!n)throw new RangeError(`operation has no key: ${e}`);return n}function su(e,t,n){const r=t.get("obj"),o=t.get("action"),i=iu(t);if(!e.get("byObject").has(r))throw new RangeError(`Modification of unknown object ${r}`);const s=tu(e,r);if(n){if(n.objectId=n.objectId||r,n.objectId!==r)throw new RangeError(`objectId mismatch in patch: ${n.objectId} != ${r}`);if(n.type=n.type||s,n.type!==s)throw new RangeError(`object type mismatch in patch: ${n.type} != ${s}`);"list"===s||"text"===s||n.props[i]||(n.props[i]={})}if(o.startsWith("make"))if(n){const r={};e=nu(e,t,r),"map"!==s&&"table"!==s||(n.props[i][t.get("opId")]=r)}else e=nu(e,t);"link"===o&&n&&(n.props[i][t.get("opId")]=Iu(e,ou(t)));const a=pu(e,r,i);let u,c;if("inc"===o)u=Ka(),c=a.map((e=>"set"===e.get("action")&&"number"==typeof e.get("value")&&"counter"===e.get("datatype")&&t.get("pred").includes(e.get("opId"))?e.set("value",e.get("value")+t.get("value")):e));else{const e=a.groupBy((e=>t.get("pred").includes(e.get("opId"))));u=e.get(!0,Ka()),c=e.get(!1,Ka())}for(let l of u.filter(ru))e=e.updateIn(["byObject",ou(l),"_inbound"],(e=>e.remove(l)));return ru(t)&&(e=e.updateIn(["byObject",ou(t),"_inbound"],Wa(),(e=>e.add(t)))),("set"===o||ru(t))&&(c=c.push(t)),c=c.sort(yu).reverse(),e=e.setIn(["byObject",r,"_keys",i],c),"list"===s||"text"===s?e=function(e,t,n,r){const o=pu(e,t,n);let i=e.getIn(["byObject",t,"_elemIds"]),s=i.indexOf(n);if(s>=0)i=o.isEmpty()?i.removeIndex(s):i.setValue(n,o.first().get("value")),lu(e,t,n,s,!1,r);else{if(o.isEmpty())return e;let a=n;for(;s=-1,a=bu(e,t,a),a&&(s=i.indexOf(a),!(s>=0)););s+=1,i=i.insertIndex(s,n,o.first().get("value")),lu(e,t,n,s,!0,r)}return e.setIn(["byObject",t,"_elemIds"],i)}(e,r,i,n):cu(e,r,i,n),e}function au(e,t,n){const r=t.get("obj"),o=t.get("opId"),i=iu(t),s=tu(e,r);if(n.objectId=n.objectId||r,n.type=n.type||s,n.objectId!==r)throw new RangeError(`objectId mismatch in path: ${n.objectId} != ${r}`);if(n.type!==s)throw new RangeError(`object type mismatch in path: ${n.type} != ${s}`);if(!n.props[i]||!n.props[i][o])if("list"===s||"text"===s){const t=e.getIn(["byObject",r,"_elemIds"]).indexOf(i);lu(e,r,i,t,!1,n)}else cu(e,r,i,n);if(void 0===n.props[i][o])throw new RangeError(`field ops for ${i} did not contain opId ${o}`);return n.props[i][o]}function uu(e,t){if("set"===t.get("action")){const e={type:"value",value:t.get("value")};return t.get("datatype")&&(e.datatype=t.get("datatype")),e}if(ru(t)){const n=ou(t),r=tu(e,n);return"list"===r||"text"===r?{objectId:n,type:r,props:{},edits:[]}:{objectId:n,type:r,props:{}}}throw new RangeError(`Unexpected operation in field ops: ${t.get("action")}`)}function cu(e,t,n,r){if(!r)return;r.props[n]||(r.props[n]={});const o={};for(let i of pu(e,t,n)){const t=i.get("opId");o[t]=!0,ru(i)&&r.props[n][t]||(r.props[n][t]=uu(e,i))}for(let i of Object.keys(r.props[n]))o[i]||delete r.props[n][i]}function lu(e,t,n,r,o,i){if(i)if(cu(e,t,n,i),0!==Object.keys(i.props[n]).length){for(;!o&&i.edits.length>0&&i.edits[i.edits.length-1].index===r&&["insert","update"].includes(i.edits[i.edits.length-1].action);){o="insert"===i.edits.pop().action}for(const e of Object.keys(i.props[n]).sort(_u)){const t=i.props[n][e];Xa(i.edits,o?{action:"insert",index:r,elemId:n,opId:e,value:t}:{action:"update",index:r,opId:e,value:t}),o=!1}}else Xa(i.edits,{action:"remove",index:r,count:1})}function hu(e,t,n){const r=t.get("actor"),o=t.get("startOp");let i=Wa();return t.get("ops").forEach(((t,s)=>{const a=t.get("action"),u=t.get("obj"),c=t.get("insert");if(!["set","del","inc","link","makeMap","makeList","makeText","makeTable"].includes(a))throw new RangeError(`Unknown operation action: ${a}`);if(!t.get("pred"))throw new RangeError(`Missing 'pred' field in operation ${t}`);let l;if(n){const t=function(e,t){let n=[];for(;"_root"!==t;){const r=e.getIn(["byObject",t,"_inbound"],Wa()).first();if(!r)return null;n.unshift(r),t=r.get("obj")}return n}(e,u);if(null!==t){l=n;for(let n of t)l=au(e,n,l)}}const h=t.merge({opId:`${o+s}@${r}`});c&&(e=function(e,t){const n=t.get("obj"),r=t.get("opId");if(!e.get("byObject").has(n))throw new Error(`Modification of unknown object ${n}`);if(e.hasIn(["byObject",n,"_insertion",r]))throw new Error(`Duplicate list element ID ${r}`);if(!t.get("elemId"))throw new RangeError("insert operation has no key");return e.updateIn(["byObject",n,"_following",t.get("elemId")],Ka(),(e=>e.push(t))).setIn(["byObject",n,"_insertion",r],t)}(e,h)),a.startsWith("make")&&(i=i.add(ou(h))),e=su(e,h,l)})),e}function fu(e,t,n){const r=Za(Ga(t)),o=r.get("actor"),i=r.get("seq"),s=r.get("startOp"),a=r.get("hash");if("string"!=typeof o||"number"!=typeof i||"number"!=typeof s)throw new TypeError(`Missing change metadata: actor = ${o}, seq = ${i}, startOp = ${s}`);if(e.hasIn(["hashes",a]))return e;const u=e.getIn(["states",o],Ka()).size+1;if(i!==u)throw new RangeError(`Expected change ${u} by ${o}, got change ${i}`);let c=0;for(let d of r.get("deps")){const t=e.getIn(["hashes",d,"maxOpId"]);if(void 0===t)throw new RangeError(`Unknown dependency hash ${d}`);c=Math.max(c,t),e=e.updateIn(["hashes",d,"depsFuture"],Wa(),(e=>e.add(a)))}if(s!==c+1)throw new RangeError(`Expected startOp to be ${c+1}, was ${s}`);let l=r.get("deps"),h=1===i;for(;!h&&!l.isEmpty();){const t=e.getIn(["hashes",l.first()]);l=l.shift(),t.get("actor")===o&&t.get("seq")===i-1?h=!0:l=l.concat(t.get("depsPast"))}if(!h)throw new RangeError("Change lacks dependency on prior sequence number by the same actor");const f=Ha({actor:o,seq:i,startOp:s,change:t,maxOpId:s+r.get("ops").size-1,depsPast:r.get("deps").toSet(),depsFuture:Wa()});return(e=hu(e,r,n)).setIn(["hashes",a],f).updateIn(["states",o],Ka(),(e=>e.push(a))).update("deps",(e=>e.subtract(r.get("deps")).add(a))).update("maxOp",(e=>Math.max(e,f.get("maxOpId")))).update("history",(e=>e.push(a)))}function du(e,t){return e.getIn(["hashes",t,"change"])}function pu(e,t,n){return e.getIn(["byObject",t,"_keys",n],Ka())}function gu(e,t,n){if("_head"===n)return;const r=e.getIn(["byObject",t,"_insertion",n]);if(!r)throw new TypeError(`Missing index entry for list element ${n}`);return r.get("elemId")}function yu(e,t){return _u(e.get("opId"),t.get("opId"))}function _u(e,t){const n=Qa(e),r=Qa(t);return n.counter<r.counter?-1:n.counter>r.counter?1:n.actorId<r.actorId?-1:n.actorId>r.actorId?1:0}function mu(e,t,n,r){let o=null;return r&&(o=Ha({opId:r})),e.getIn(["byObject",t,"_following",n],Ka()).filter((e=>e.get("insert")&&(!o||yu(e,o)<0))).sort(yu).reverse().map((e=>e.get("opId")))}function vu(e,t,n){const r=mu(e,t,n);if(!r.isEmpty())return r.first();let o;for(;;){if(o=gu(e,t,n),!o)return;const r=mu(e,t,o,n);if(!r.isEmpty())return r.first();n=o}}function bu(e,t,n){const r=gu(e,t,n);let o,i=mu(e,t,r);if(i.first()===n)return"_head"===r?null:r;for(let s of i){if(s===n)break;o=s}for(;;){if(i=mu(e,t,o),i.isEmpty())return o;o=i.last()}}function wu(e,t){if(ru(t))return Iu(e,ou(t));if("set"===t.get("action")){const e={value:t.get("value")};return t.get("datatype")&&(e.datatype=t.get("datatype")),e}throw new TypeError(`Unexpected operation action: ${t.get("action")}`)}function Iu(e,t){const n=tu(e,t);if("map"===n||"table"===n)return function(e,t,n){const r={objectId:t,type:n,props:{}};for(let[o,i]of e.getIn(["byObject",t,"_keys"]).entries())if(!i.isEmpty()){r.props[o]={};for(let t of i)r.props[o][t.get("opId")]=wu(e,t)}return r}(e,t,n);if("list"===n||"text"===n)return function(e,t,n){const r={objectId:t,type:n,props:{},edits:[]};let o="_head",i=0,s=0;for(;;){if(o=vu(e,t,o),!o)return r;s=Math.max(s,Qa(o).counter);const n=pu(e,t,o);if(!n.isEmpty()){r.props[i]={};for(let t of n)r.props[i][t.get("opId")]=wu(e,t);i+=1}}}(e,t,n);throw new RangeError(`Unknown object type: ${n}`)}var xu={init:function(){return Ha().set("states",Ha()).set("history",Ka()).set("byObject",Ha().set("_root",Ha().set("_keys",Ha()))).set("hashes",Ha()).set("deps",Wa()).set("maxOp",0).set("queue",Ka())},addChange:function(e,t,n){return function(e,t){let n=Ka();for(;;){for(let r of e.get("queue"))eu(e,Ya(r,!1))?e=fu(e,r,t):n=n.push(r);if(n.count()===e.get("queue").count())return e;e=e.set("queue",n),n=Ka()}}(e=e.update("queue",(e=>e.push(t))),n)},addLocalChange:function(e,t,n){return fu(e,t,n)},getHeads:function(e){return e.get("deps").toArray().sort()},getChangeByHash:du,getMissingChanges:function(e,t){if(t.isEmpty())return e.get("history").toArray().map((t=>du(e,t)));let n=Ka(),r={},o=[];for(let i of t){r[i]=!0;const t=e.getIn(["hashes",i,"depsFuture"]);if(!t)throw new RangeError(`hash not found: ${i}`);n=n.concat(t)}for(;!n.isEmpty();){const t=n.last();if(r[t]=!0,o.push(t),!e.getIn(["hashes",t,"depsPast"]).every((e=>r[e])))break;n=n.pop().concat(e.getIn(["hashes",t,"depsFuture"]))}if(n.isEmpty()&&e.get("deps").every((e=>r[e])))return o.map((t=>du(e,t)));for(n=t,r={};!n.isEmpty();){const t=n.last();if(n=n.pop(),!r[t]){const o=e.getIn(["hashes",t,"depsPast"]);if(!o)throw new RangeError(`hash not found: ${t}`);n=n.concat(o),r[t]=!0}}return e.get("history").filter((e=>!r[e])).map((t=>du(e,t))).toArray()},getChangesAdded:function(e,t){let n=t.get("deps").toArray(),r={},o=[];for(;n.length>0;){const i=n.pop();r[i]||du(e,i)||(r[i]=!0,o.push(i),n.push(...t.getIn(["hashes",i,"depsPast"])))}return o.reverse().map((e=>du(t,e)))},getMissingDeps:function(e,t=[]){let n={},r={};for(let o of e.get("queue")){const t=Ya(o,!0);r[t.hash]=!0;for(let r of t.deps)e.hasIn(["hashes",r])||(n[r]=!0)}for(let o of t)e.hasIn(["hashes",o])||(n[o]=!0);return Object.keys(n).filter((e=>!r[e])).sort()},constructObject:Iu,getFieldOps:pu,getOperationKey:iu,finalizePatch:function e(t){if(t)if("list"===t.type||"text"===t.type){delete t.props;for(let n of t.edits)e(n.value)}else if("map"===t.type||"table"===t.type)for(const n of Object.keys(t.props))for(const r of Object.keys(t.props[n]))e(t.props[n][r])}};var Eu={backendState:function(e){if(e.frozen)throw new Error("Attempting to use an outdated Automerge document that has already been updated. Please use the latest document state, or call Automerge.clone() if you really need to use this old document state.");return e.state}};const{Map:ku,List:Su}=Va.exports,Ou=xu,{splitContainers:ju,encodeChange:Au,decodeChanges:Ru,encodeDocument:Cu,constructPatch:Tu,BackendDoc:zu}=Ua,{backendState:Nu}=Eu;function Lu(){return{state:ku({opSet:Ou.init(),objectIds:ku()}),heads:[]}}function Du(e,t,n,r){const o={clock:e.getIn(["opSet","states"]).map((e=>e.size)).toObject(),deps:e.getIn(["opSet","deps"]).toArray().sort(),diffs:t,maxOp:e.getIn(["opSet","maxOp"],0),pendingChanges:Ou.getMissingDeps(e.get("opSet")).length};if(r&&n){o.actor=n.actor,o.seq=n.seq;const t=e.getIn(["opSet","states",n.actor,n.seq-1]);o.deps=o.deps.filter((e=>e!==t))}return o}function Mu(e,t,n,r){let o=r?{objectId:"_root",type:"map",props:{}}:null,i=e.get("opSet");for(let s of t)for(let e of ju(s))i=n?Ou.addLocalChange(i,e,o):Ou.addChange(i,e,o);return Ou.finalizePatch(o),[e=e.set("opSet",i),r?Du(e,o,n,!0):null]}function Uu(e){return Cu(Bu(e))}function Vu(e,t){const n=Nu(e);{const[r]=Mu(n,t,null,!1);return e.frozen=!0,{state:r,heads:Ou.getHeads(r.get("opSet"))}}}function Bu(e){return $u(e,[])}function $u(e,t){if(!Array.isArray(t))throw new TypeError("Pass an array of hashes to Backend.getChanges()");const n=Nu(e);return Ou.getMissingChanges(n.get("opSet"),Su(t))}var qu={init:Lu,clone:function(e){return{state:Nu(e),heads:e.heads}},free:function(e){e.state=null,e.frozen=!0},applyChanges:function(e,t){{let[n,r]=Mu(Nu(e),t,null,!0);const o=Ou.getHeads(n.get("opSet"));return e.frozen=!0,[{state:n,heads:o},r]}},applyLocalChange:function(e,t){const n=Nu(e);if(t.seq<=function(e,t){return e.getIn(["opSet","states",t],Su()).size}(n,t.actor))throw new RangeError("Change request has already been applied");if(t.seq>1){const e=function(e,t,n){return e.getIn(["opSet","states",t,n])}(n,t.actor,t.seq-2);if(!e)throw new RangeError(`Cannot find hash of localChange before seq=${t.seq}`);let r={[e]:!0};for(let n of t.deps)r[n]=!0;t.deps=Object.keys(r).sort()}const r=Au(t);{const o={actor:t.actor,seq:t.seq},[i,s]=Mu(n,[r],o,!0),a=Ou.getHeads(i.get("opSet"));return e.frozen=!0,[{state:i,heads:a},s,r]}},save:Uu,load:function(e){{const t=Ru([e]).map(Au);return Vu(Lu(),t)}},loadChanges:Vu,getPatch:function(e){return Du(Nu(e),Tu(Uu(e)),null,!1)},getHeads:function(e){return e.heads},getAllChanges:Bu,getChanges:$u,getChangesAdded:function(e,t){const n=Nu(e).get("opSet"),r=Nu(t).get("opSet");return Ou.getChangesAdded(n,r)},getChangeByHash:function(e,t){const n=Nu(e);return Ou.getChangeByHash(n.get("opSet"),t)},getMissingDeps:function(e,t=[]){const n=Nu(e);return Ou.getMissingDeps(n.get("opSet"),t)}};const{List:Pu}=Va.exports,{backendState:Fu}=Eu,Hu=qu,Ku=xu,{hexStringToBytes:Wu,bytesToHexString:Zu,Encoder:Ju,Decoder:Gu}=ms,{decodeChangeMeta:Yu}=Ua,{copyObject:Xu}=ct;class Qu{constructor(e){if(Array.isArray(e)){this.numEntries=e.length,this.numBitsPerEntry=10,this.numProbes=7,this.bits=new Uint8Array(Math.ceil(this.numEntries*this.numBitsPerEntry/8));for(let t of e)this.addHash(t)}else{if(!(e instanceof Uint8Array))throw new TypeError("invalid argument");if(0===e.byteLength)this.numEntries=0,this.numBitsPerEntry=0,this.numProbes=0,this.bits=e;else{const t=new Gu(e);this.numEntries=t.readUint32(),this.numBitsPerEntry=t.readUint32(),this.numProbes=t.readUint32(),this.bits=t.readRawBytes(Math.ceil(this.numEntries*this.numBitsPerEntry/8))}}}get bytes(){if(0===this.numEntries)return new Uint8Array(0);const e=new Ju;return e.appendUint32(this.numEntries),e.appendUint32(this.numBitsPerEntry),e.appendUint32(this.numProbes),e.appendRawBytes(this.bits),e.buffer}getProbes(e){const t=Wu(e),n=8*this.bits.byteLength;if(32!==t.byteLength)throw new RangeError(`Not a 256-bit hash: ${e}`);let r=((t[0]|t[1]<<8|t[2]<<16|t[3]<<24)>>>0)%n,o=((t[4]|t[5]<<8|t[6]<<16|t[7]<<24)>>>0)%n,i=((t[8]|t[9]<<8|t[10]<<16|t[11]<<24)>>>0)%n;const s=[r];for(let a=1;a<this.numProbes;a++)r=(r+o)%n,o=(o+i)%n,s.push(r);return s}addHash(e){for(let t of this.getProbes(e))this.bits[t>>>3]|=1<<(7&t)}containsHash(e){if(0===this.numEntries)return!1;for(let t of this.getProbes(e))if(0==(this.bits[t>>>3]&1<<(7&t)))return!1;return!0}}function ec(e,t){if(!Array.isArray(t))throw new TypeError("hashes must be an array");e.appendUint32(t.length);for(let n=0;n<t.length;n++){if(n>0&&t[n-1]>=t[n])throw new RangeError("hashes must be sorted");const r=Wu(t[n]);if(32!==r.byteLength)throw new TypeError("heads hashes must be 256 bits");e.appendRawBytes(r)}}function tc(e){let t=e.readUint32(),n=[];for(let r=0;r<t;r++)n.push(Zu(e.readRawBytes(32)));return n}function nc(e){const t=new Ju;t.appendByte(66),ec(t,e.heads),ec(t,e.need),t.appendUint32(e.have.length);for(let n of e.have)ec(t,n.lastSync),t.appendPrefixedBytes(n.bloom);t.appendUint32(e.changes.length);for(let n of e.changes)t.appendPrefixedBytes(n);return t.buffer}function rc(e){const t=new Gu(e),n=t.readByte();if(66!==n)throw new RangeError(`Unexpected message type: ${n}`);const r=tc(t),o=tc(t),i=t.readUint32();let s={heads:r,need:o,have:[],changes:[]};for(let u=0;u<i;u++){const e=tc(t),n=t.readPrefixedBytes(t);s.have.push({lastSync:e,bloom:n})}const a=t.readUint32();for(let u=0;u<a;u++){const e=t.readPrefixedBytes();s.changes.push(e)}return s}function oc(e,t){const n=Ku.getMissingChanges(e.get("opSet"),Pu(t)).map((e=>Yu(e,!0).hash));return{lastSync:t,bloom:new Qu(n).bytes}}function ic(){return{sharedHeads:[],lastSentHeads:[],theirHeads:null,theirNeed:null,theirHave:null,sentHashes:{}}}function sc(e,t){return e.length===t.length&&e.every(((e,n)=>e===t[n]))}var ac={receiveSyncMessage:function(e,t,n){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:r,lastSentHeads:o,sentHashes:i}=t,s=null;const a=rc(n),u=Hu.getHeads(e);a.changes.length>0&&([e,s]=Hu.applyChanges(e,a.changes),r=function(e,t,n){const r=t.filter((t=>!e.includes(t))),o=n.filter((e=>t.includes(e)));return[...new Set([...r,...o])].sort()}(u,Hu.getHeads(e),r)),0===a.changes.length&&sc(a.heads,u)&&(o=a.heads);const c=a.heads.filter((t=>Hu.getChangeByHash(e,t)));c.length===a.heads.length?(r=a.heads,0===a.heads.length&&(o=[],i=[])):r=[...new Set(c.concat(r))].sort();const l={sharedHeads:r,lastSentHeads:o,theirHave:a.have,theirHeads:a.heads,theirNeed:a.need,sentHashes:i};return[e,l,s]},generateSyncMessage:function(e,t){if(!e)throw new Error("generateSyncMessage called with no Automerge document");if(!t)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads:n,lastSentHeads:r,theirHeads:o,theirNeed:i,theirHave:s,sentHashes:a}=t;const u=Hu.getHeads(e),c=Fu(e),l=Hu.getMissingDeps(e,o||[]);let h=[];if(o&&!l.every((e=>o.includes(e)))||(h=[oc(c,n)]),s&&s.length>0){if(!s[0].lastSync.every((t=>Hu.getChangeByHash(e,t)))){return[t,nc({heads:u,need:[],have:[{lastSync:[],bloom:new Uint8Array(0)}],changes:[]})]}}let f=Array.isArray(s)&&Array.isArray(i)?function(e,t,n){const r=e.get("opSet");if(0===t.length)return n.map((e=>Ku.getChangeByHash(r,e))).filter((e=>void 0!==e));let o={},i=[];for(let f of t){for(let e of f.lastSync)o[e]=!0;i.push(new Qu(f.bloom))}const s=Ku.getMissingChanges(r,Pu(Object.keys(o))).map((e=>Yu(e,!0)));let a={},u={},c={};for(let f of s){a[f.hash]=!0;for(let e of f.deps)u[e]||(u[e]=[]),u[e].push(f.hash);i.every((e=>!e.containsHash(f.hash)))&&(c[f.hash]=!0)}let l=Object.keys(c);for(;l.length>0;){const e=l.pop();if(u[e])for(let t of u[e])c[t]||(c[t]=!0,l.push(t))}let h=[];for(let f of n)if(c[f]=!0,!a[f]){const e=Ku.getChangeByHash(r,f);e&&h.push(e)}for(let f of s)c[f.hash]&&h.push(f.change);return h}(c,s,i):[];const d=Array.isArray(r)&&sc(u,r),p=Array.isArray(o)&&sc(u,o);if(d&&p&&0===f.length)return[t,null];f=f.filter((e=>!a[Yu(e,!0).hash]));const g={heads:u,have:h,need:l,changes:f};if(f.length>0){a=Xu(a);for(const e of f)a[Yu(e,!0).hash]=!0}return[t=Object.assign({},t,{lastSentHeads:u,sentHashes:a}),nc(g)]},encodeSyncMessage:nc,decodeSyncMessage:rc,initSyncState:ic,encodeSyncState:function(e){const t=new Ju;return t.appendByte(67),ec(t,e.sharedHeads),t.buffer},decodeSyncState:function(e){const t=new Gu(e),n=t.readByte();if(67!==n)throw new RangeError(`Unexpected record type: ${n}`);const r=tc(t);return Object.assign({sharedHeads:[],lastSentHeads:[],theirHeads:null,theirNeed:null,theirHave:null,sentHashes:{}},{sharedHeads:r})},BloomFilter:Qu};const{init:uc,clone:cc,free:lc,applyChanges:hc,applyLocalChange:fc,save:dc,load:pc,loadChanges:gc,getPatch:yc,getHeads:_c,getAllChanges:mc,getChanges:vc,getChangesAdded:bc,getChangeByHash:wc,getMissingDeps:Ic}=qu,{receiveSyncMessage:xc,generateSyncMessage:Ec,encodeSyncMessage:kc,decodeSyncMessage:Sc,encodeSyncState:Oc,decodeSyncState:jc,initSyncState:Ac}=ac;var Rc={init:uc,clone:cc,free:lc,applyChanges:hc,applyLocalChange:fc,save:dc,load:pc,loadChanges:gc,getPatch:yc,getHeads:_c,getAllChanges:mc,getChanges:vc,getChangesAdded:bc,getChangeByHash:wc,getMissingDeps:Ic,receiveSyncMessage:xc,generateSyncMessage:Ec,encodeSyncMessage:kc,decodeSyncMessage:Sc,encodeSyncState:Oc,decodeSyncState:jc,initSyncState:Ac};!function(e){const t=st,n=Xn,{OPTIONS:r}=at,{encodeChange:o,decodeChange:i}=Ua,{isObject:s}=ct;let a=Rc;function u(e){if("string"==typeof e)e={actorId:e};else if(void 0===e)e={};else if(!s(e))throw new TypeError(`Unsupported options for init(): ${e}`);return n.init(Object.assign({backend:a},e))}function c(e,t,r){const[o]=n.change(e,t,r);return o}function l(e){return a.getAllChanges(n.getBackendState(e,"getAllChanges"))}function h(e,t,o,i,s){const a=n.applyPatch(e,t,o),u=s.patchCallback||e[r].patchCallback;return u&&u(t,e,a,!1,i),a}function f(e,t,r={}){const o=n.getBackendState(e,"applyChanges"),[i,s]=a.applyChanges(o,t);return[h(e,s,i,t,r),s]}e.exports={init:u,from:function(e,t){return c(u(t),{message:"Initialization"},(t=>Object.assign(t,e)))},change:c,emptyChange:function(e,t){const[r]=n.emptyChange(e,t);return r},clone:function(e,t={}){const r=a.clone(n.getBackendState(e,"clone"));return h(u(t),a.getPatch(r),r,[],t)},free:function(e){a.free(n.getBackendState(e,"free"))},load:function(e,t={}){const n=a.load(e);return h(u(t),a.getPatch(n),n,[e],t)},save:function(e){return a.save(n.getBackendState(e,"save"))},merge:function(e,t){const r=n.getBackendState(e,"merge"),o=n.getBackendState(t,"merge","second");if(n.getActorId(e)===n.getActorId(t))throw new RangeError("Cannot merge an actor with itself");const i=a.getChangesAdded(r,o),[s]=f(e,i);return s},getChanges:function(e,t){const r=n.getBackendState(e,"getChanges"),o=n.getBackendState(t,"getChanges","second");return a.getChanges(o,a.getHeads(r))},getAllChanges:l,applyChanges:f,encodeChange:o,decodeChange:i,equals:function e(t,n){if(!s(t)||!s(n))return t===n;const r=Object.keys(t).sort(),o=Object.keys(n).sort();if(r.length!==o.length)return!1;for(let i=0;i<r.length;i++){if(r[i]!==o[i])return!1;if(!e(t[r[i]],n[o[i]]))return!1}return!0},getHistory:function(e){const t=n.getActorId(e),r=l(e);return r.map(((e,o)=>({get change(){return i(e)},get snapshot(){const e=a.loadChanges(a.init(),r.slice(0,o+1));return n.applyPatch(u(t),a.getPatch(e),e)}})))},uuid:t,Frontend:n,setDefaultBackend:function(e){a=e},generateSyncMessage:function(e,t){const r=n.getBackendState(e,"generateSyncMessage");return a.generateSyncMessage(r,t)},receiveSyncMessage:function(e,t,o){const i=n.getBackendState(e,"receiveSyncMessage"),[s,u,c]=a.receiveSyncMessage(i,t,o);if(!c)return[e,u,c];let l=null;return e[r].patchCallback&&(l=a.decodeSyncMessage(o).changes),[h(e,c,s,l,{}),u,c]},initSyncState:function(){return a.initSyncState()},get Backend(){return a}};for(let d of["getObjectId","getObjectById","getActorId","setActorId","getConflicts","getLastLocalChange","Text","Table","Counter","Observable","Int","Uint","Float64"])e.exports[d]=n[d]}(Le);var Cc,Tc,zc=Le.exports;(Tc=Cc||(Cc={})).Init="init",Tc.Get="get",Tc.Changes="changes";class Nc extends be.exports.EventEmitter{constructor(e,n,r){super(),t(this,"name"),t(this,"state"),t(this,"room"),t(this,"opened",!1),t(this,"initted",!1),t(this,"changeFns",[]),t(this,"changes",[]),t(this,"onOpen",(()=>{this.opened||(this.opened=!0,this.initted=!1,this.room.on(Ee.Message,this.onData),this.room.on(Ee.Close,this.onClose),this.room.isServer()?this.room.broadcast(Cc.Init,{name:this.name,raw:Lc(zc.save(this.state))}):this.room.broadcast(Cc.Get,{name:this.name}))})),t(this,"onClose",(()=>{this.opened&&(this.opened=!1,this.room.off(Ee.Message,this.onData),this.room.off(Ee.Close,this.onClose))})),t(this,"onData",((e,t)=>{if(Re(t,Cc.Changes)&&t.payload.name===this.name)if(this.initted){const[e]=zc.applyChanges(this.state,this.changes.concat(t.payload.changes.map(Dc)));this.changes.length=0,this.state=e,this.emit("update",e)}else this.changes.push(...t.payload.changes.map(Dc));else if(Re(t,Cc.Init)&&t.payload.name===this.name){const e=zc.load(function(e){const t=new Uint8Array(e);return t.__binaryDocument=!0,t}(t.payload.raw));let n=e;this.changeFns.length&&(n=[...this.changeFns].reduce(((e,t)=>zc.change(e,t)),n),this.changeFns.length=0),this.initted=!0,this.state=n,this.emit("update",n);const r=zc.getChanges(e,n).map(Lc);r.length&&this.room.broadcast(Cc.Changes,{name:this.name,changes:r})}else this.room.isServer()&&e!==this.room.getPeer().getId()&&Re(t,Cc.Get)&&t.payload.name===this.name&&this.room.send(e,Cc.Init,{name:this.name,raw:Lc(zc.save(this.state))})})),this.name=e,this.room=n,this.state=zc.from(r),n.isOpen()?this.onOpen():this.room.on(Ee.Open,this.onOpen)}get(){return this.state}change(e){if(this.initted){const t=this.state,n=zc.change(t,e),r=zc.getChanges(t,n).map(Lc);this.state=n,r.length&&this.room.broadcast(Cc.Changes,{name:this.name,changes:r})}else this.changeFns.push(e);return this}}function Lc(e){const t=new Array(e.length);for(let n=0,r=e.length;n<r;n++)t[n]=e[n];return t}function Dc(e){const t=new Uint8Array(e);return t.__binaryChange=!0,t}const Mc=Math.pow(2,31)-1|0;function Uc(e){return null!=e&&"function"==typeof e.toJS?e.toJS():e}function Vc(e){return null!=e&&"function"==typeof e.toJSON?e.toJSON():e}const Bc={},$c={};class qc{constructor(e,t){if(e!==Bc)throw new TypeError("Options can only be created with the some or none functions");this._value=t}static some(e){return Pc(e)}static none(){return Fc()}static from(e){return null!=e?Pc(e):Fc()}static fromResult(e){return e.isOk()?Pc(e.unwrap()):Fc()}isNone(){return this._value===$c}isSome(){return!this.isNone()}expect(e){if(this.isSome())return this._value;throw new Error("function"==typeof e?e():e)}unwrap(){return this.expect("Tried to unwrap value of none Option")}unwrapOr(e){return this.isSome()?this._value:e}unwrapOrElse(e){return this.isSome()?this._value:e()}map(e){return this.isSome()?Pc(e(this._value)):Fc()}mapOr(e,t){return this.isSome()?Pc(e(this._value)):Pc(t)}mapOrElse(e,t){return this.isSome()?Pc(e(this._value)):Pc(t())}flatMap(e){return this.isSome()?e(this._value):Fc()}flatMapOr(e,t){return this.isSome()?e(this._value):t}flatMapOrElse(e,t){return this.isSome()?e(this._value):t()}and(e){return this.isSome()?e:Fc()}andThen(e){return this.isSome()?e(this._value):Fc()}or(e){return this.isNone()?e:this}orElse(e){return this.isNone()?e():this}xor(e){const t=this.isSome(),n=e.isSome();return t&&!n?this:!t&&n?e:Fc()}filter(e){return this.isSome()&&e(this._value)?this:Fc()}getOrInsert(e){return this.isNone()&&(this._value=e),this}getOrInsertWith(e){return this.isNone()&&(this._value=e()),this}take(){if(this.isSome()){const e=this._value;return this._value=$c,Pc(e)}return Fc()}from(e){return null!=e?this._value=e:this.clear(),this}replace(e){return this._value=e,this}clear(){return this._value=$c,this}fromResult(e){return e.isOk()?Pc(e.unwrap()):Fc()}ifSome(e,t){return this.isSome()?e(this._value):t&&t(),this}ifNone(e,t){return this.isNone()?e():t&&t(this._value),this}fromJSON(e){return qc.from(e)}toJSON(){return this.map(Vc).unwrapOr(null)}toJS(){return this.map(Uc).unwrapOr(null)}}const Pc=e=>new qc(Bc,e),Fc=()=>new qc(Bc,$c);class Hc{constructor(e){this._index=0,this._iter=e}[Symbol.iterator](){return this}iter(){return this}next(){return this._iter.next()}nextWithIndex(){const e=this._iter.next();return e.done?e:{value:[e.value,this._index++]}}enumerate(){throw new Error("iter/Enumerate was not imported!")}peekable(){throw new Error("iter/Peekable was not imported!")}forEach(e){throw new Error("iter/ForEach was not imported!")}map(e){throw new Error("iter/Map was not imported!")}merge(e){throw new Error("iter/Merge was not imported!")}concat(e){return this.merge(e)}filter(e){throw new Error("iter/Filter was not imported!")}step(e){throw new Error("iter/Step was not imported!")}skip(e){throw new Error("iter/Skip was not imported!")}take(e){throw new Error("iter/Take was not imported!")}toMap(e,t){throw new Error("iter/ToMap was not imported!")}count(){return this.reduce(0,(e=>e+1))}consume(){let e=this.next();for(;!e.done;)e=this.next();return this}toArray(){return this.reduce([],((e,t)=>(e.push(t),e)))}join(e){return this.toArray().join(e)}indexOf(e){let t=this.next(),n=0;for(;!t.done;){if(t.value===e)return n;n++,t=this.next()}return-1}findIndex(e){let t=this.nextWithIndex();for(;!t.done;){const[n,r]=t.value;if(e(n,r))return r;t=this.nextWithIndex()}return-1}find(e){let t=this.nextWithIndex();for(;!t.done;){const[n,r]=t.value;if(e(n,r))return Pc(n);t=this.nextWithIndex()}return Fc()}findAll(e){return this.filter(e)}nth(e=0){let t=this.next();for(e<0&&(e=0);!t.done;){if(e--<=0)return Pc(t.value);t=this.next()}return Fc()}first(){return this.nth(0)}last(){let e=this.next();for(;!e.done;){const t=this.next();if(t.done)return Pc(e.value);e=t}return Fc()}any(e){return-1!==this.findIndex(e)}some(e){return this.any(e)}none(e){return-1===this.findIndex(e)}all(e){let t=this.nextWithIndex();for(;!t.done;){const[n,r]=t.value;if(!e(n,r))return!1;t=this.nextWithIndex()}return!0}unflatten(e){throw new Error("iter/Unflatten was not imported!")}reduce(e,t){let n=this.next();for(;!n.done;){e=t(e,n.value,this._index-1),n=this.next()}return e}reverse(){return Kc(this.toArray().reverse())}}function Kc(e){return null!=e?"function"==typeof e[Symbol.iterator]?new Hc(e[Symbol.iterator]()):"function"==typeof e.next?e instanceof Hc?e:new Hc(e):Kc("object"==typeof e?Object.entries(e):[e]):Kc([])}class Wc extends Hc{constructor(e){super(e)}next(){const e=super.nextWithIndex();return e.done?e:{value:Zc(e.value)}}}function Zc(e){const t=e[0],n=e;return n[0]=e[1],n[1]=t,n}Hc.prototype.enumerate=function(){return new Wc(this)};class Jc extends Hc{constructor(e,t){super(e),this._fn=t}next(){let e=super.nextWithIndex();for(;!e.done;){const[t,n]=e.value;if(this._fn(t,n))return{done:!1,value:t};e=super.nextWithIndex()}return{done:!0,value:void 0}}}Hc.prototype.filter=function(e){return new Jc(this,e)};class Gc extends Hc{constructor(e,t){super(e),this._fn=([e,n])=>(t(e,n),e)}next(){const e=super.nextWithIndex();return e.done?e:{done:!1,value:this._fn(e.value)}}}Hc.prototype.forEach=function(e){return new Gc(this,e)};class Yc extends Hc{constructor(e,t){super(e),this._fn=([e,n])=>t(e,n)}next(){const e=super.nextWithIndex();return e.done?e:{done:!1,value:this._fn(e.value)}}}Hc.prototype.map=function(e){return new Yc(this,e)};class Xc extends Hc{constructor(e,t){super(e),this._other=t}next(){const e=super.next();return e.done?this._other.next():e}}Hc.prototype.merge=function(e){return new Xc(this,e)};class Qc extends Hc{constructor(){super(...arguments),this.peeked=[]}unpeekAll(){return this.peeked.length=0,this}unpeek(){return this.peeked.length>0?Pc(this.peeked.shift()):Fc()}peek(e=0){if(e<this.peeked.length)return Pc(this.peeked[e]);{let t=this.peeked.length-e-1,n=super.next();for(;!(n.done||(this.peeked.push(n.value),--t<=0));)n=super.next();return n.done?Fc():Pc(n.value)}}next(){const e=this.unpeek();if(e.isSome())return{done:!1,value:e.unwrap()};const t=super.next();return t.done?t:{done:!1,value:t.value}}}Hc.prototype.peekable=function(){return new Qc(this)};class el extends Hc{constructor(e,t){super(e),this._skipped=0,this._skip=0|(t<=0?0:t)}next(){let e=super.next();for(;!e.done;){if(!(this._skipped<=this._skip))return e;this._skipped+=1,e=super.next()}return{done:!0,value:void 0}}}Hc.prototype.skip=function(e){return new el(this,e)};class tl extends Hc{constructor(e,t){super(e),this._stepped=0,this._step=t<=0?1:0|t}next(){let e=super.next();for(;!e.done;){if(!(this._stepped<this._step))return this._stepped=0,e;this._stepped+=1,e=super.next()}return{done:!0,value:void 0}}}Hc.prototype.step=function(e){return new tl(this,e)};class nl extends Hc{constructor(e,t){super(e),this._taken=0,this._count=0|(t<=0?0:t)}next(){return this._taken<this._count?(this._taken+=1,super.next()):{done:!0,value:void 0}}}Hc.prototype.take=function(e){return new nl(this,e)};const rl=e=>e,ol=e=>e;class il extends Hc{constructor(e,t=rl,n=ol){super(e),this._map=([e,r])=>[t(e,r),n(e,r)]}toObject(){return this.reduce({},((e,t)=>(e[t[0]]=t[1],e)))}next(){const e=super.nextWithIndex();return e.done?e:{done:!1,value:this._map(e.value)}}}Hc.prototype.toMap=function(e,t){return new il(this,e,t)};class sl extends Hc{constructor(e,t){super(e),this._fn=t}next(){return this._fn(this._iter)}}var al,ul;Hc.prototype.unflatten=function(e){return new sl(this,e)},(ul=al||(al={}))[ul.Forward=0]="Forward",ul[ul.Backward=1]="Backward";class cl{constructor(e,t,n=1){this.start=e,this.end=t,this.step=Math.abs(n),this.direction=e>t?al.Backward:al.Forward}static from(e,t,n=1){return new cl(e,t,n)}getStart(){return this.start}getEnd(){return this.end}getStep(){return this.step}getDirection(){return this.direction}contains(e){return this.start<=e&&e<=this.end}isEmpty(){return this.direction===al.Forward?this.start>this.end:this.start<this.end}iter(){return new Hc(this)}[Symbol.iterator](){return this}next(){if(this.isEmpty())return{done:!0,value:void 0};{const e=this.start;return this.direction===al.Forward?this.start+=this.step:this.start-=this.step,{done:!1,value:e}}}}const ll=cl.from;class hl extends Hc{constructor(e){super(e),this.rng=e}[Symbol.iterator](){return this}iter(){return new Hc(this)}next(){return{done:!1,value:this.rng.nextFloat()}}}class fl extends Hc{constructor(e,t=0,n=1){super(e),this.rng=e,this.min=t,this.max=n}[Symbol.iterator](){return this}iter(){return new Hc(this)}nextFloat(){return this.rng.nextFloatInRange(this.min,this.max)}next(){return{done:!1,value:this.nextFloat()}}}class dl extends Hc{constructor(e,t=0,n=Mc){super(e),this.rng=e,this.min=0|t,this.max=0|n}[Symbol.iterator](){return this}iter(){return new Hc(this)}nextInt(){return this.rng.nextIntInRange(this.min,this.max)}next(){return{done:!1,value:this.nextInt()}}}const pl=new Uint8Array(4);class gl{nextFloat(){return this.nextInt()/Mc}nextFloatInRange(e=0,t=1){return e+this.nextFloat()*(t-e)}nextIntInRange(e=0,t=Mc){return Math.round(this.nextFloatInRange(e,t))}shuffle(e){const t=e.length;for(let n=0;n<t;n++){const r=n+this.nextIntInRange(0,t-n-1),o=e[n];e[n]=e[r],e[r]=o}return e}fromArray(e){return e.length?Pc(e[this.nextIntInRange(0,e.length-1)]):Fc()}keyFromObject(e){return this.fromArray(Object.keys(e))}valueFromObject(e){return this.fromArray(Object.values(e))}fillBytes(e){const t=pl;for(let n=0,r=e.length;n<r;n++){const r=n%4;0===r&&yl(t,this.nextInt()),e[n]=t[r]}return e}[Symbol.iterator](){return this}iter(){return new Hc(this)}next(){return{done:!1,value:this.nextInt()}}float(){return new hl(this)}uniformFloat(e=0,t=1){return new fl(this,e,t)}uniformInt(e=0,t=Mc){return new dl(this,e,t)}}function yl(e,t){return e[0]=(4278190080&t)>>24,e[1]=(16711680&t)>>16,e[2]=(65280&t)>>8,e[3]=255&t,e}class _l extends gl{constructor(e=423257940){super(),this.seed=e}setSeed(e=423257940){return this.seed=e,this}nextInt(){return this.seed=Math.imul(48271,this.seed)|0%Mc,this.seed&Mc}}const ml=new _l;class vl extends gl{constructor(e,t,n,r){super(),this.x=423257940,this.y=2829571177,this.z=2541948421,this.w=289122235,this.set(e,t,n,r)}static fromSeed(e){return(new vl).setSeed(e)}setSeed(e){const t=ml.setSeed(e);return this.set(t.nextInt(),t.nextInt(),t.nextInt(),t.nextInt())}set(e=423257940,t=2829571177,n=2541948421,r=289122235){return this.x=0|e,this.y=0|t,this.z=0|n,this.w=0|r,this}nextInt(){const e=this.x,t=e^e<<11;this.x=this.y,this.y=this.z,this.z=this.w;const n=this.w;return this.w=n^n>>19^t^t>>8,this.w}}new _l,new vl;let bl=new class extends gl{nextInt(){return Math.random()*Mc|0}nextFloat(){return Math.random()}};function wl(){return bl.nextFloat()}var Il,xl={exports:{}};
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/xl.exports=function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){if(!a&&ve)return ve(s);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,(function(e){var n=t[s][1][e];return o(n||e)}),c,c.exports,e,t,n,r)}return n[s].exports}for(var i=ve,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){(function(e){var n,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,s=new o(l),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var u=new e.MessageChannel;u.port1.onmessage=l,n=function(){u.port2.postMessage(0)}}var c=[];function l(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}function h(e){1!==c.push(e)||r||n()}t.exports=h}).call(this,void 0!==me?me:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function o(){}var i={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,e!==o&&d(this,e)}function l(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){r((function(){var r;try{r=t(n)}catch(o){return i.reject(e,o)}r===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,r)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(e,t){var n=!1;function r(t){n||(n=!0,i.reject(e,t))}function o(t){n||(n=!0,i.resolve(e,t))}function s(){t(o,r)}var a=p(s);"error"===a.status&&r(a.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}function g(e){return e instanceof this?e:i.resolve(new this(o),e)}function y(e){var t=new this(o);return i.reject(t,e)}function _(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,u=-1,c=new this(o);++u<n;)l(e[u],u);return c;function l(e,o){function u(e){s[o]=e,++a!==n||r||(r=!0,i.resolve(c,s))}t.resolve(e).then(u,(function(e){r||(r=!0,i.reject(c,e))}))}}function m(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=-1,a=new this(o);++s<n;)u(e[s]);return a;function u(e){t.resolve(e).then((function(e){r||(r=!0,i.resolve(a,e))}),(function(e){r||(r=!0,i.reject(a,e))}))}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(o);return this.state!==u?h(n,this.state===a?e:t,this.outcome):this.queue.push(new l(n,e,t)),n},l.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){i.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=p(f,t);if("error"===n.status)return i.reject(e,n.value);var r=n.value;if(r)d(e,r);else{e.state=a,e.outcome=t;for(var o=-1,s=e.queue.length;++o<s;)e.queue[o].callFulfilled(t)}return e},i.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=g,c.reject=y,c.all=_,c.race=m},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==me?me:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var s=i();function a(){try{if(!s||!s.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(n){return!1}}function u(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function l(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function h(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function f(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function d(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",g=void 0,y={},_=Object.prototype.toString,m="readonly",v="readwrite";function b(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function w(e){return new c((function(t){var n=e.transaction(p,v),r=u([""]);n.objectStore(p).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function I(e){return"boolean"==typeof g?c.resolve(g):w(e).then((function(e){return g=e}))}function x(e){var t=y[e.name],n={};n.promise=new c((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function E(e){var t=y[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function k(e,t){var n=y[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function S(e,t){return new c((function(n,r){if(y[e.name]=y[e.name]||D(),e.db){if(!t)return n(e.db);x(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var i=s.open.apply(s,o);t&&(i.onupgradeneeded=function(t){var n=i.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(p)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),r(i.error)},i.onsuccess=function(){var t=i.result;t.onversionchange=function(e){e.target.close()},n(t),E(e)}}))}function O(e){return S(e,!1)}function j(e){return S(e,!0)}function A(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function R(e){return new c((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function C(e){return u([b(atob(e.data))],{type:e.type})}function T(e){return e&&e.__local_forage_encoded_blob}function z(e){var t=this,n=t._initReady().then((function(){var e=y[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return h(n,e,e),n}function N(e){x(e);for(var t=y[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,O(e).then((function(t){return e.db=t,A(e)?j(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw k(e,t),t}))}function L(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(i){if(r>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return c.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),j(e)})).then((function(){return N(e).then((function(){L(e,t,n,r-1)}))})).catch(n);n(i)}}function D(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function M(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=y[n.name];o||(o=D(),y[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=z);var i=[];function s(){return c.resolve()}for(var a=0;a<o.forages.length;a++){var u=o.forages[a];u!==t&&i.push(u._initReady().catch(s))}var l=o.forages.slice(0);return c.all(i).then((function(){return n.db=o.db,O(n)})).then((function(e){return n.db=e,A(n,t._defaultConfig.version)?j(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<l.length;r++){var i=l[r];i!==t&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}}))}function U(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){L(n._dbInfo,m,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),T(e)&&(e=C(e)),t(e)},s.onerror=function(){r(s.error)}}catch(a){r(a)}}))})).catch(r)}));return l(r,t),r}function V(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){L(n._dbInfo,m,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;T(r)&&(r=C(r));var o=e(r,n.key,a++);void 0!==o?t(o):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(u){r(u)}}))})).catch(r)}));return l(r,t),r}function B(e,t,n){var r=this;e=f(e);var o=new c((function(n,o){var i;r.ready().then((function(){return i=r._dbInfo,"[object Blob]"===_.call(t)?I(i.db).then((function(e){return e?t:R(t)})):t})).then((function(t){L(r._dbInfo,v,(function(i,s){if(i)return o(i);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var u=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),n(t)},s.onabort=s.onerror=function(){var e=u.error?u.error:u.transaction.error;o(e)}}catch(c){o(c)}}))})).catch(o)}));return l(o,n),o}function $(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){L(n._dbInfo,v,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){r(s.error)},i.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(a){r(a)}}))})).catch(r)}));return l(r,t),r}function q(e){var t=this,n=new c((function(e,n){t.ready().then((function(){L(t._dbInfo,v,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(s){n(s)}}))})).catch(n)}));return l(n,e),n}function P(e){var t=this,n=new c((function(e,n){t.ready().then((function(){L(t._dbInfo,m,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}catch(s){n(s)}}))})).catch(n)}));return l(n,e),n}function F(e,t){var n=this,r=new c((function(t,r){e<0?t(null):n.ready().then((function(){L(n._dbInfo,m,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName),a=!1,u=s.openKeyCursor();u.onsuccess=function(){var n=u.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},u.onerror=function(){r(u.error)}}catch(c){r(c)}}))})).catch(r)}));return l(r,t),r}function H(e){var t=this,n=new c((function(e,n){t.ready().then((function(){L(t._dbInfo,m,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];i.onsuccess=function(){var t=i.result;t?(s.push(t.key),t.continue()):e(s)},i.onerror=function(){n(i.error)}}catch(a){n(a)}}))})).catch(n)}));return l(n,e),n}function K(e,t){t=d.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;if(e.name){var i=e.name===n.name&&o._dbInfo.db?c.resolve(o._dbInfo.db):O(e).then((function(t){var n=y[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t}));r=e.storeName?i.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;x(e);var r=y[e.name],o=r.forages;t.close();for(var i=0;i<o.length;i++){var a=o[i];a._dbInfo.db=null,a._dbInfo.version=n}return new c((function(t,r){var o=s.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,E(n._dbInfo)}})).catch((function(t){throw(k(e,t)||c.resolve()).catch((function(){})),t}))}})):i.then((function(t){x(e);var n=y[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new c((function(t,n){var r=s.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)E(r[t]._dbInfo)})).catch((function(t){throw(k(e,t)||c.resolve()).catch((function(){})),t}))}))}else r=c.reject("Invalid arguments");return l(r,t),r}var W={_driver:"asyncStorage",_initStorage:M,_support:a(),iterate:V,getItem:U,setItem:B,removeItem:$,clear:q,length:P,key:F,keys:H,dropInstance:K};function Z(){return"function"==typeof openDatabase}var J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G="~~local_forage_type~",Y=/^~~local_forage_type~([^~]+)~/,X="__lfsc__:",Q=X.length,ee="arbf",te="blob",ne="si08",re="ui08",oe="uic8",ie="si16",se="si32",ae="ur16",ue="ui32",ce="fl32",le="fl64",he=Q+ee.length,fe=Object.prototype.toString;function de(e){var t,n,r,o,i,s=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),l=new Uint8Array(c);for(t=0;t<a;t+=4)n=J.indexOf(e[t]),r=J.indexOf(e[t+1]),o=J.indexOf(e[t+2]),i=J.indexOf(e[t+3]),l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|o>>2,l[u++]=(3&o)<<6|63&i;return c}function pe(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=J[n[t]>>2],r+=J[(3&n[t])<<4|n[t+1]>>4],r+=J[(15&n[t+1])<<2|n[t+2]>>6],r+=J[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function ge(e,t){var n="";if(e&&(n=fe.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===fe.call(e.buffer))){var r,o=X;e instanceof ArrayBuffer?(r=e,o+=ee):(r=e.buffer,"[object Int8Array]"===n?o+=ne:"[object Uint8Array]"===n?o+=re:"[object Uint8ClampedArray]"===n?o+=oe:"[object Int16Array]"===n?o+=ie:"[object Uint16Array]"===n?o+=ae:"[object Int32Array]"===n?o+=se:"[object Uint32Array]"===n?o+=ue:"[object Float32Array]"===n?o+=ce:"[object Float64Array]"===n?o+=le:t(new Error("Failed to get type for BinaryArray"))),t(o+pe(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=G+e.type+"~"+pe(this.result);t(X+te+n)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function ye(e){if(e.substring(0,Q)!==X)return JSON.parse(e);var t,n=e.substring(he),r=e.substring(Q,he);if(r===te&&Y.test(n)){var o=n.match(Y);t=o[1],n=n.substring(o[0].length)}var i=de(n);switch(r){case ee:return i;case te:return u([i],{type:t});case ne:return new Int8Array(i);case re:return new Uint8Array(i);case oe:return new Uint8ClampedArray(i);case ie:return new Int16Array(i);case ae:return new Uint16Array(i);case se:return new Int32Array(i);case ue:return new Uint32Array(i);case ce:return new Float32Array(i);case le:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}var _e={serialize:ge,deserialize:ye,stringToBuffer:de,bufferToString:pe};function me(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function ve(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new c((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(o){return r(o)}n.db.transaction((function(o){me(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=_e,o}function be(e,t,n,r,o,i){e.executeSql(n,r,o,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?i(e,s):me(e,t,(function(){e.executeSql(n,r,o,i)}),i)}),i):i(e,s)}),i)}function we(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){be(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return l(r,t),r}function Ie(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){be(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var i=r.rows,s=i.length,a=0;a<s;a++){var u=i.item(a),c=u.value;if(c&&(c=o.serializer.deserialize(c)),void 0!==(c=e(c,u.key,a+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return l(r,t),r}function xe(e,t,n,r){var o=this;e=f(e);var i=new c((function(i,s){o.ready().then((function(){void 0===t&&(t=null);var a=t,u=o._dbInfo;u.serializer.serialize(t,(function(t,c){c?s(c):u.db.transaction((function(n){be(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){i(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void i(xe.apply(o,[e,a,n,r-1]));s(t)}}))}))})).catch(s)}));return l(i,n),i}function Ee(e,t,n){return xe.apply(this,[e,t,n,1])}function ke(e,t){var n=this;e=f(e);var r=new c((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){be(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return l(r,t),r}function Se(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){be(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return l(n,e),n}function Oe(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){be(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return l(n,e),n}function je(e,t){var n=this,r=new c((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){be(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return l(r,t),r}function Ae(e){var t=this,n=new c((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){be(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return l(n,e),n}function Re(e){return new c((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],i=0;i<r.rows.length;i++)o.push(r.rows.item(i).name);t({db:e,storeNames:o})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function Ce(e,t){t=d.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return l(r=e.name?new c((function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Re(r))})).then((function(e){return new c((function(t,n){e.db.transaction((function(r){function o(e){return new c((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var i=[],s=0,a=e.storeNames.length;s<a;s++)i.push(o(e.storeNames[s]));c.all(i).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):c.reject("Invalid arguments"),t),r}var Te={_driver:"webSQLStorage",_initStorage:ve,_support:Z(),iterate:Ie,getItem:we,setItem:Ee,removeItem:ke,clear:Se,length:Oe,key:je,keys:Ae,dropInstance:Ce};function ze(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Ne(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function Le(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(t){return!0}}function De(){return!Le()||localStorage.length>0}function Me(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=Ne(e,t._defaultConfig),De()?(t._dbInfo=n,n.serializer=_e,c.resolve()):c.reject()}function Ue(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return l(n,e),n}function Ve(e,t){var n=this;e=f(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return l(r,t),r}function Be(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,i=localStorage.length,s=1,a=0;a<i;a++){var u=localStorage.key(a);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,u.substring(o),s++)))return c}}}));return l(r,t),r}function $e(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(o){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return l(r,t),r}function qe(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&r.push(i.substring(e.keyPrefix.length))}return r}));return l(n,e),n}function Pe(e){var t=this.keys().then((function(e){return e.length}));return l(t,e),t}function Fe(e,t){var n=this;e=f(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return l(r,t),r}function He(e,t,n){var r=this;e=f(e);var o=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new c((function(o,i){var s=r._dbInfo;s.serializer.serialize(t,(function(t,r){if(r)i(r);else try{localStorage.setItem(s.keyPrefix+e,t),o(n)}catch(a){"QuotaExceededError"!==a.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==a.name||i(a),i(a)}}))}))}));return l(o,n),o}function Ke(e,t){if(t=d.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return l(r=e.name?new c((function(t){e.storeName?t(Ne(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):c.reject("Invalid arguments"),t),r}var We={_driver:"localStorageWrapper",_initStorage:Me,_support:ze(),iterate:Be,getItem:Ve,setItem:He,removeItem:Fe,clear:Ue,length:Pe,key:$e,keys:qe,dropInstance:Ke},Ze=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Je=function(e,t){for(var n=e.length,r=0;r<n;){if(Ze(e[r],t))return!0;r++}return!1},Ge=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ye={},Xe={},Qe={INDEXEDDB:W,WEBSQL:Te,LOCALSTORAGE:We},et=[Qe.INDEXEDDB._driver,Qe.WEBSQL._driver,Qe.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ot(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function it(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ge(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var st=new(function(){function e(t){for(var n in o(this,e),Qe)if(Qe.hasOwnProperty(n)){var r=Qe[n],i=r._driver;this[n]=i,Ye[i]||this.defineDriver(r)}this._defaultConfig=it({},rt),this._config=it({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new c((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var i=nt.concat("_initStorage"),s=0,a=i.length;s<a;s++){var u=i[s];if((!Je(tt,u)||e[u])&&"function"!=typeof e[u])return void n(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=c.reject(t);return l(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var o=tt[n];e[o]||(e[o]=t(o))}}();var h=function(n){Ye[r]&&console.info("Redefining LocalForage driver: "+r),Ye[r]=e,Xe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,n):h(!!e._support):h(!0)}catch(f){n(f)}}));return h(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Ye[e]?c.resolve(Ye[e]):c.reject(new Error("Driver not found."));return h(r,t,n),r},e.prototype.getSerializer=function(e){var t=c.resolve(_e);return h(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return h(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Ge(e)||(e=[e]);var o=this._getSupportedDrivers(e);function i(){r._config.driver=r.driver()}function s(e){return r._extend(e),i(),r._ready=r._initStorage(r._config),r._ready}function a(e){return function(){var t=0;function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(s).catch(n)}i();var a=new Error("No available storage method found.");return r._driverSet=c.reject(a),r._driverSet}return n()}}var u=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=u.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=a(o)}))})).catch((function(){i();var e=new Error("No available storage method found.");return r._driverSet=c.reject(e),r._driverSet})),h(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Xe[e]},e.prototype._extend=function(e){it(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)ot(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=st},{3:3}]},{},[4])(4);var El=new Uint8Array(16);function kl(){if(!Il&&!(Il="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Il(El)}var Sl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ol(e){return"string"==typeof e&&Sl.test(e)}for(var jl=[],Al=0;Al<256;++Al)jl.push((Al+256).toString(16).substr(1));function Rl(e,t,n){var r=(e=e||{}).random||(e.rng||kl)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(jl[e[t+0]]+jl[e[t+1]]+jl[e[t+2]]+jl[e[t+3]]+"-"+jl[e[t+4]]+jl[e[t+5]]+"-"+jl[e[t+6]]+jl[e[t+7]]+"-"+jl[e[t+8]]+jl[e[t+9]]+"-"+jl[e[t+10]]+jl[e[t+11]]+jl[e[t+12]]+jl[e[t+13]]+jl[e[t+14]]+jl[e[t+15]]).toLowerCase();if(!Ol(n))throw TypeError("Stringified UUID is invalid");return n}(r)}export{Nc as $,B as A,r as B,ye as C,f as D,g as E,y as F,p as G,b as H,n as I,D as J,j as K,we as L,xl as M,Rl as N,l as O,Ne as P,ll as Q,wl as R,pe as S,Ee as T,h as U,M as V,a as W,s as X,x as Y,F as Z,_e as _,R as a,A as b,T as c,I as d,E as e,w as f,z as g,L as h,de as i,ue as j,S as k,O as l,ce as m,N as n,le as o,se as p,ae as q,ne as r,u as s,k as t,ie as u,he as v,re as w,oe as x,q as y,$ as z};
