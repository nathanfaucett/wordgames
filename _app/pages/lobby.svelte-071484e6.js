import{S as qe,i as He,s as Fe,U as Ve,V as Se,j as ne,k as O,m as ie,n as P,o as ue,f as j,W as je,x as fe,u as me,v as ce,d as n,Q as Xe,A as Ge,e as v,t as C,c as b,a as E,g as B,F as u,J as ge,b as c,X as x,L as X,Y as ve,Z as Le,h as ee,_ as Te,K as Ue,$ as Ne,O as Je,a0 as Ke,a1 as Ye,a2 as Oe,P as Ze}from"../chunks/vendor-230de008.js";import{M as Pe,W as de,g as Re,d as Y,a as ze,Q as xe,u as et}from"../chunks/userId-ebb4d183.js";import{L as tt,g as st,k as We}from"../chunks/util-ab4fc287.js";import{b as Me}from"../chunks/paths-28a87002.js";import"../chunks/singletons-e82519e2.js";function Ae(a,e,l){const s=a.slice();return s[22]=e[l][0],s[23]=e[l][1],s[25]=l,s}function Ce(a,e,l){const s=a.slice();return s[26]=e[l],s}function Be(a){let e,l=a[26]+"",s,i;return{c(){e=v("option"),s=C(l),this.h()},l(_){e=b(_,"OPTION",{});var f=E(e);s=B(f,l),f.forEach(n),this.h()},h(){e.__value=i=de[a[26]],e.value=e.__value},m(_,f){j(_,e,f),u(e,s)},p:ge,d(_){_&&n(e)}}}function Qe(a,e){let l,s,i,_=e[25]+1+"",f,L,w=e[23].name+"",R,D,I,V,o,d,W,S,k,y,Q,F,A,q,G,T;return{key:a,first:null,c(){l=v("div"),s=v("div"),i=v("p"),f=C(_),L=C(" - "),R=C(w),D=O(),I=v("form"),V=v("div"),o=v("input"),S=O(),k=v("div"),y=v("input"),A=O(),q=v("hr"),this.h()},l(r){l=b(r,"DIV",{class:!0});var g=E(l);s=b(g,"DIV",{class:!0});var U=E(s);i=b(U,"P",{class:!0});var M=E(i);f=B(M,_),L=B(M," - "),R=B(M,w),M.forEach(n),U.forEach(n),D=P(g),I=b(g,"FORM",{class:!0});var h=E(I);V=b(h,"DIV",{class:!0});var $=E(V);o=b($,"INPUT",{id:!0,name:!0,type:!0,class:!0}),$.forEach(n),S=P(h),k=b(h,"DIV",{class:!0});var H=E(k);y=b(H,"INPUT",{id:!0,name:!0,type:!0,class:!0}),H.forEach(n),h.forEach(n),g.forEach(n),A=P(r),q=b(r,"HR",{}),this.h()},h(){c(i,"class","text-2xl p-1 font-bold"),c(s,"class","flex-grow"),c(o,"id",d=`${e[22]}-team-1`),c(o,"name","team"),o.value="1",c(o,"type","radio"),c(o,"class","align-bottom"),o.checked=W=e[23].team==="team1",c(V,"class","btn sm primary flex-1"),c(y,"id",Q=`${e[22]}-team-2`),c(y,"name","team"),y.value="2",c(y,"type","radio"),c(y,"class","align-bottom"),y.checked=F=e[23].team==="team2",c(k,"class","btn sm danger flex-1"),c(I,"class","flex-grow-0 flex flex-row"),c(l,"class","flex justify-between"),x(l,"bg-gray-200",e[22]===e[3]),this.first=l},m(r,g){j(r,l,g),u(l,s),u(s,i),u(i,f),u(i,L),u(i,R),u(l,D),u(l,I),u(I,V),u(V,o),u(I,S),u(I,k),u(k,y),j(r,A,g),j(r,q,g),G||(T=[X(o,"click",ve(e[16])),X(V,"click",function(){Le(e[11](e[22],e[23].team,"team1"))&&e[11](e[22],e[23].team,"team1").apply(this,arguments)}),X(y,"click",ve(e[15])),X(k,"click",function(){Le(e[11](e[22],e[23].team,"team2"))&&e[11](e[22],e[23].team,"team2").apply(this,arguments)})],G=!0)},p(r,g){e=r,g&2&&_!==(_=e[25]+1+"")&&ee(f,_),g&2&&w!==(w=e[23].name+"")&&ee(R,w),g&2&&d!==(d=`${e[22]}-team-1`)&&c(o,"id",d),g&2&&W!==(W=e[23].team==="team1")&&(o.checked=W),g&2&&Q!==(Q=`${e[22]}-team-2`)&&c(y,"id",Q),g&2&&F!==(F=e[23].team==="team2")&&(y.checked=F),g&10&&x(l,"bg-gray-200",e[22]===e[3])},d(r){r&&n(l),r&&n(A),r&&n(q),G=!1,Te(T)}}}function lt(a){let e,l,s,i,_,f,L,w,R,D,I,V,o,d,W,S,k,y,Q,F,A,q,G,T=[],r=new Map,g,U,M,h,$,H,Z,_e,J,he,pe,be,z=Object.keys(de),N=[];for(let t=0;t<z.length;t+=1)N[t]=Be(Ce(a,z,t));let se=a[1];const ke=t=>t[22];for(let t=0;t<se.length;t+=1){let m=Ae(a,se,t),p=ke(m);r.set(p,T[t]=Qe(p,m))}return{c(){e=v("h1"),l=C(a[0]),s=O(),i=v("div"),_=v("label"),f=C("Name"),L=O(),w=v("input"),R=O(),D=v("div"),I=v("label"),V=C("Words"),o=O(),d=v("select");for(let t=0;t<N.length;t+=1)N[t].c();W=O(),S=v("div"),k=v("div"),y=v("div"),Q=C(a[2]),F=O(),A=v("div"),q=C(a[8]),G=O();for(let t=0;t<T.length;t+=1)T[t].c();g=O(),U=v("div"),M=O(),h=v("div"),$=v("button"),H=C("Start"),_e=O(),J=v("button"),he=C("Leave"),this.h()},l(t){e=b(t,"H1",{class:!0});var m=E(e);l=B(m,a[0]),m.forEach(n),s=P(t),i=b(t,"DIV",{class:!0});var p=E(i);_=b(p,"LABEL",{for:!0});var te=E(_);f=B(te,"Name"),te.forEach(n),L=P(p),w=b(p,"INPUT",{class:!0}),p.forEach(n),R=P(t),D=b(t,"DIV",{});var le=E(D);I=b(le,"LABEL",{for:!0});var we=E(I);V=B(we,"Words"),we.forEach(n),o=P(le),d=b(le,"SELECT",{id:!0,class:!0});var $e=E(d);for(let K=0;K<N.length;K+=1)N[K].l($e);$e.forEach(n),le.forEach(n),W=P(t),S=b(t,"DIV",{class:!0});var ae=E(S);k=b(ae,"DIV",{class:!0});var oe=E(k);y=b(oe,"DIV",{class:!0});var Ee=E(y);Q=B(Ee,a[2]),Ee.forEach(n),F=P(oe),A=b(oe,"DIV",{class:!0});var Ie=E(A);q=B(Ie,a[8]),Ie.forEach(n),oe.forEach(n),G=P(ae);for(let K=0;K<T.length;K+=1)T[K].l(ae);ae.forEach(n),g=P(t),U=b(t,"DIV",{class:!0}),E(U).forEach(n),M=P(t),h=b(t,"DIV",{class:!0});var re=E(h);$=b(re,"BUTTON",{class:!0});var ye=E($);H=B(ye,"Start"),ye.forEach(n),_e=P(re),J=b(re,"BUTTON",{class:!0});var De=E(J);he=B(De,"Leave"),De.forEach(n),re.forEach(n),this.h()},h(){c(e,"class","text-6xl text-center cursor-pointer"),c(_,"for","name"),c(w,"class","input"),c(i,"class","mt-2"),c(I,"for","words"),c(d,"id","words"),c(d,"class","input"),c(y,"class","btn md primary flex-1 text-center"),c(A,"class","btn md danger flex-1 text-center"),c(k,"class","mt-2 mb-2 flex justify-center"),c(S,"class","mt-2 mb-2"),c(U,"class","flex-grow"),c($,"class","btn lg primary flex-1"),$.disabled=Z=a[1].length<2,x($,"bg-blue-100",a[1].length<2),x($,"hover:bg-blue-500",a[1].length>1),c(J,"class","btn lg danger flex-1"),c(h,"class","flex justify-center")},m(t,m){j(t,e,m),u(e,l),j(t,s,m),j(t,i,m),u(i,_),u(_,f),u(i,L),u(i,w),Ue(w,a[7]),j(t,R,m),j(t,D,m),u(D,I),u(I,V),u(D,o),u(D,d);for(let p=0;p<N.length;p+=1)N[p].m(d,null);Ne(d,a[4]),j(t,W,m),j(t,S,m),u(S,k),u(k,y),u(y,Q),u(k,F),u(k,A),u(A,q),u(S,G);for(let p=0;p<T.length;p+=1)T[p].m(S,null);j(t,g,m),j(t,U,m),j(t,M,m),j(t,h,m),u(h,$),u($,H),u(h,_e),u(h,J),u(J,he),pe||(be=[X(e,"click",a[17]),X(w,"input",a[18]),X(w,"input",a[9]),X(d,"change",ve(a[10])),X($,"click",a[12]),X(J,"click",a[19])],pe=!0)},p(t,m){if(m&1&&ee(l,t[0]),m&128&&w.value!==t[7]&&Ue(w,t[7]),m&0){z=Object.keys(de);let p;for(p=0;p<z.length;p+=1){const te=Ce(t,z,p);N[p]?N[p].p(te,m):(N[p]=Be(te),N[p].c(),N[p].m(d,null))}for(;p<N.length;p+=1)N[p].d(1);N.length=z.length}m&16&&Ne(d,t[4]),m&4&&ee(Q,t[2]),m&256&&ee(q,t[8]),m&2058&&(se=t[1],T=Je(T,m,ke,1,t,se,r,S,Ze,Qe,null,Ae)),m&2&&Z!==(Z=t[1].length<2)&&($.disabled=Z),m&2&&x($,"bg-blue-100",t[1].length<2),m&2&&x($,"hover:bg-blue-500",t[1].length>1)},d(t){t&&n(e),t&&n(s),t&&n(i),t&&n(R),t&&n(D),Ke(N,t),t&&n(W),t&&n(S);for(let m=0;m<T.length;m+=1)T[m].d();t&&n(g),t&&n(U),t&&n(M),t&&n(h),pe=!1,Te(be)}}}function at(a){let e,l;return e=new xe({props:{value:location.href}}),{c(){ne(e.$$.fragment)},l(s){ie(e.$$.fragment,s)},m(s,i){ue(e,s,i),l=!0},p:ge,i(s){l||(fe(e.$$.fragment,s),l=!0)},o(s){me(e.$$.fragment,s),l=!1},d(s){ce(e,s)}}}function ot(a){let e,l;return{c(){e=v("h2"),l=C(a[0]),this.h()},l(s){e=b(s,"H2",{slot:!0});var i=E(e);l=B(i,a[0]),i.forEach(n),this.h()},h(){c(e,"slot","title")},m(s,i){j(s,e,i),u(e,l)},p(s,i){i&1&&ee(l,s[0])},d(s){s&&n(e)}}}function rt(a){let e,l;return{c(){e=v("a"),l=C("Exit"),this.h()},l(s){e=b(s,"A",{href:!0,class:!0});var i=E(e);l=B(i,"Exit"),i.forEach(n),this.h()},h(){c(e,"href",`${Me}/`),c(e,"class","btn lg danger")},m(s,i){j(s,e,i),u(e,l)},p:ge,d(s){s&&n(e)}}}function nt(a){let e,l,s,i,_,f,L,w;e=new tt({props:{$$slots:{default:[lt]},$$scope:{ctx:a}}});function R(o){a[20](o)}let D={$$slots:{title:[ot],default:[at]},$$scope:{ctx:a}};a[5]!==void 0&&(D.show=a[5]),s=new Pe({props:D}),Ve.push(()=>Se(s,"show",R));function I(o){a[21](o)}let V={$$slots:{default:[rt]},$$scope:{ctx:a}};return a[6]!==void 0&&(V.show=a[6]),f=new Pe({props:V}),Ve.push(()=>Se(f,"show",I)),{c(){ne(e.$$.fragment),l=O(),ne(s.$$.fragment),_=O(),ne(f.$$.fragment)},l(o){ie(e.$$.fragment,o),l=P(o),ie(s.$$.fragment,o),_=P(o),ie(f.$$.fragment,o)},m(o,d){ue(e,o,d),j(o,l,d),ue(s,o,d),j(o,_,d),ue(f,o,d),w=!0},p(o,[d]){const W={};d&536871423&&(W.$$scope={dirty:d,ctx:o}),e.$set(W);const S={};d&536870913&&(S.$$scope={dirty:d,ctx:o}),!i&&d&32&&(i=!0,S.show=o[5],je(()=>i=!1)),s.$set(S);const k={};d&536870912&&(k.$$scope={dirty:d,ctx:o}),!L&&d&64&&(L=!0,k.show=o[6],je(()=>L=!1)),f.$set(k)},i(o){w||(fe(e.$$.fragment,o),fe(s.$$.fragment,o),fe(f.$$.fragment,o),w=!0)},o(o){me(e.$$.fragment,o),me(s.$$.fragment,o),me(f.$$.fragment,o),w=!1},d(o){ce(e,o),o&&n(l),ce(s,o),o&&n(_),ce(f,o)}}}const _t=!1;function ht(a){return{props:{roomId:a.page.query.get("room")}}}function it(a,e,l){let s,i,_;Xe(a,et,r=>l(3,_=r));let{roomId:f}=e,L=[],w=!1,R,D=!1,I=!1,V=`guest-${st()}`;async function o(){const r=await Re();Y.get("rooms").get(f).get("users").get(r).get("name").put(V)}function d(r){Y.get("rooms").get(f).get("words").put(r.currentTarget.value)}function W(r,g,U){return function(){g!==U&&Y.get("rooms").get(f).get("users").get(r).get("team").put(U)}}async function S(){const r=Y.get("rooms").get(f),g=r.get("users"),U=await g,M=await r,h=Ye.fromSeed(M.seed);r.get("turn").put(h.fromArray(We(U)).unwrap()),r.get("started").put(!0)}let k;Ge(()=>{const r=Y.get("rooms").get(f),g=r.get("users").on(async h=>{l(1,L=(await Promise.all(We(h).map($=>new Promise(H=>r.get("users").get($).once(Z=>H([$,Z])))))).sort())}),U=r.get("words").on(h=>{l(4,R=h)}),M=r.get("started").on(h=>{l(13,w=h)});return Re().then(h=>r.get("users").get(h).get("name").once($=>{const H=$;H&&l(7,V=H)})),r.once(h=>{if(!(h==null?void 0:h.seed)){const $=Date.now();r.put({seed:$,team1:0,team2:0,started:!1,words:de.Medium})}}),o(),()=>{g.off(),U.off(),M.off()}});function y(r){Oe.call(this,a,r)}function Q(r){Oe.call(this,a,r)}const F=()=>l(5,D=!0);function A(){V=this.value,l(7,V)}const q=()=>l(6,I=!0);function G(r){D=r,l(5,D)}function T(r){I=r,l(6,I)}return a.$$set=r=>{"roomId"in r&&l(0,f=r.roomId)},a.$$.update=()=>{if(a.$$.dirty&8193&&w&&ze(`${Me}/game?room=${f}`),a.$$.dirty&2&&l(2,s=L.filter(([,r])=>r.team==="team1").length),a.$$.dirty&6&&l(8,i=L.length-s),a.$$.dirty&16393&&_&&k!==_){const r=_;Y.get("rooms").get(f).get("users").get(r).get("team").put("team1"),k&&Y.get("rooms").get(f).get("users").get(k).put(null),l(14,k=r)}},[f,L,s,_,R,D,I,V,i,o,d,W,S,w,k,y,Q,F,A,q,G,T]}class pt extends qe{constructor(e){super();He(this,e,it,nt,Fe,{roomId:0})}}export{pt as default,ht as load,_t as ssr};
