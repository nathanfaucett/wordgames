var De=Object.defineProperty,Se=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var me=(l,e,t)=>e in l?De(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,de=(l,e)=>{for(var t in e||(e={}))Ne.call(e,t)&&me(l,t,e[t]);if(ce)for(var t of ce(e))Ue.call(e,t)&&me(l,t,e[t]);return l},pe=(l,e)=>Se(l,Ve(e));import{S as _e,i as be,s as he,t as S,g as V,f as _,h as W,J as X,d as i,a8 as ge,V as ve,W as we,j as z,k as O,m as K,n as B,o as Z,X as ke,x,u as ee,v as te,R as Me,A as Re,l as ye,e as y,c as $,a as E,b as w,Y as ae,F as k,L as se,M as $e,a1 as Le}from"../chunks/vendor-497916f4.js";import{b as G}from"../chunks/paths-28a87002.js";import{L as Pe,k as Ee,g as He}from"../chunks/util-e96a9a8e.js";import{M as Ie,d as J,a as Oe,Q as Be,u as We}from"../chunks/userId-b57cf3ee.js";import"../chunks/singletons-12a22614.js";import"../chunks/preload-helper-ac1c8acd.js";function Ye(l){let e=fe(l[0])+"",t,s,n=fe(l[1])+"",r;return{c(){t=S(e),s=S(":"),r=S(n)},l(a){t=V(a,e),s=V(a,":"),r=V(a,n)},m(a,c){_(a,t,c),_(a,s,c),_(a,r,c)},p(a,[c]){c&1&&e!==(e=fe(a[0])+"")&&W(t,e),c&2&&n!==(n=fe(a[1])+"")&&W(r,n)},i:X,o:X,d(a){a&&i(t),a&&i(s),a&&i(r)}}}function fe(l){return(l<10?"0":"")+l}function qe(l,e,t){let s,n,{seconds:r=60}=e;return l.$$set=a=>{"seconds"in a&&t(2,r=a.seconds)},l.$$.update=()=>{l.$$.dirty&4&&t(0,s=Math.floor(r/60)),l.$$.dirty&5&&t(1,n=Math.floor(r-s*60))},[s,n,r]}class Ae extends _e{constructor(e){super();be(this,e,qe,Ye,he,{seconds:2})}}function Ce(l){var n;let e=((n=l[6][l[1]])==null?void 0:n.name)+"",t,s;return{c(){t=S(e),s=S("'s turn")},l(r){t=V(r,e),s=V(r,"'s turn")},m(r,a){_(r,t,a),_(r,s,a)},p(r,a){var c;a&66&&e!==(e=((c=r[6][r[1]])==null?void 0:c.name)+"")&&W(t,e)},d(r){r&&i(t),r&&i(s)}}}function Qe(l){var n;let e=((n=l[6][l[1]])==null?void 0:n.name)+"",t,s;return{c(){t=S(e),s=S(" and your Team's turn")},l(r){t=V(r,e),s=V(r," and your Team's turn")},m(r,a){_(r,t,a),_(r,s,a)},p(r,a){var c;a&66&&e!==(e=((c=r[6][r[1]])==null?void 0:c.name)+"")&&W(t,e)},d(r){r&&i(t),r&&i(s)}}}function Fe(l){let e;return{c(){e=S("Your Turn")},l(t){e=V(t,"Your Turn")},m(t,s){_(t,e,s)},p:X,d(t){t&&i(e)}}}function Te(l){let e;function t(r,a){return r[2]?Xe:Ge}let s=t(l),n=s(l);return{c(){n.c(),e=ye()},l(r){n.l(r),e=ye()},m(r,a){n.m(r,a),_(r,e,a)},p(r,a){s===(s=t(r))&&n?n.p(r,a):(n.d(1),n=s(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){n.d(r),r&&i(e)}}}function Xe(l){let e,t,s,n,r,a,c,b,T,j,h,N,f,d;return{c(){e=y("div"),t=y("div"),s=y("p"),n=S(l[9]),r=O(),a=y("div"),c=y("div"),b=y("button"),T=S("Skip"),j=O(),h=y("button"),N=S("Next"),this.h()},l(g){e=$(g,"DIV",{class:!0});var v=E(e);t=$(v,"DIV",{class:!0});var U=E(t);s=$(U,"P",{class:!0});var R=E(s);n=V(R,l[9]),R.forEach(i),U.forEach(i),v.forEach(i),r=B(g),a=$(g,"DIV",{class:!0});var I=E(a);c=$(I,"DIV",{class:!0});var P=E(c);b=$(P,"BUTTON",{class:!0});var L=E(b);T=V(L,"Skip"),L.forEach(i),j=B(P),h=$(P,"BUTTON",{class:!0});var Y=E(h);N=V(Y,"Next"),Y.forEach(i),P.forEach(i),I.forEach(i),this.h()},h(){w(s,"class","text-6xl"),w(t,"class","text-center"),w(e,"class","flex-1 flex h-full justify-center items-center"),w(b,"class","btn lg danger flex-1"),w(h,"class","btn lg primary flex-1"),w(c,"class","flex flex-1 justify-center"),w(a,"class","flex-1")},m(g,v){_(g,e,v),k(e,t),k(t,s),k(s,n),_(g,r,v),_(g,a,v),k(a,c),k(c,b),k(b,T),k(c,j),k(c,h),k(h,N),f||(d=[se(b,"click",l[13]),se(h,"click",l[14])],f=!0)},p(g,v){v&512&&W(n,g[9])},d(g){g&&i(e),g&&i(r),g&&i(a),f=!1,$e(d)}}}function Ge(l){let e,t,s,n,r,a;return{c(){e=y("div"),t=y("div"),s=y("button"),n=S("Start"),this.h()},l(c){e=$(c,"DIV",{class:!0});var b=E(e);t=$(b,"DIV",{class:!0});var T=E(t);s=$(T,"BUTTON",{class:!0});var j=E(s);n=V(j,"Start"),j.forEach(i),T.forEach(i),b.forEach(i),this.h()},h(){w(s,"class","btn lg primary flex-1"),w(t,"class","flex justify-center"),w(e,"class","flex-1")},m(c,b){_(c,e,b),k(e,t),k(t,s),k(s,n),r||(a=se(s,"click",l[12]),r=!0)},p:X,d(c){c&&i(e),r=!1,a()}}}function Je(l){let e,t,s,n,r,a,c,b,T,j,h,N,f,d,g,v,U,R,I,P,L,Y,le;function re(o,m){var M,H;return o[4]?Fe:((M=o[6][o[5]])==null?void 0:M.team)===((H=o[6][o[1]])==null?void 0:H.team)?Qe:Ce}let Q=re(l),u=Q(l);d=new Ae({props:{seconds:l[3]}});let p=l[4]&&Te(l);return{c(){e=y("h1"),t=S(l[0]),s=O(),n=y("div"),r=y("div"),a=S(l[7]),c=O(),b=y("div"),T=S(l[8]),j=O(),h=y("h1"),u.c(),N=O(),f=y("p"),z(d.$$.fragment),g=O(),v=y("div"),p&&p.c(),U=O(),R=y("div"),I=y("button"),P=S("Leave"),this.h()},l(o){e=$(o,"H1",{class:!0});var m=E(e);t=V(m,l[0]),m.forEach(i),s=B(o),n=$(o,"DIV",{class:!0});var M=E(n);r=$(M,"DIV",{class:!0});var H=E(r);a=V(H,l[7]),H.forEach(i),c=B(M),b=$(M,"DIV",{class:!0});var q=E(b);T=V(q,l[8]),q.forEach(i),M.forEach(i),j=B(o),h=$(o,"H1",{class:!0});var oe=E(h);u.l(oe),oe.forEach(i),N=B(o),f=$(o,"P",{class:!0});var ne=E(f);K(d.$$.fragment,ne),ne.forEach(i),g=B(o),v=$(o,"DIV",{class:!0});var D=E(v);p&&p.l(D),D.forEach(i),U=B(o),R=$(o,"DIV",{class:!0});var A=E(R);I=$(A,"BUTTON",{class:!0});var F=E(I);P=V(F,"Leave"),F.forEach(i),A.forEach(i),this.h()},h(){var o,m;w(e,"class","text-6xl text-center cursor-pointer"),w(r,"class","btn md primary flex-1 text-center"),w(b,"class","btn md danger flex-1 text-center"),w(n,"class","flex justify-center mt-2"),w(h,"class","text-center text-white rounded py-4 my-4"),ae(h,"bg-blue-500",((o=l[6][l[5]])==null?void 0:o.team)==="team1"),ae(h,"bg-red-500",((m=l[6][l[5]])==null?void 0:m.team)==="team2"),w(f,"class","text-2xl text-center"),w(v,"class","flex-grow flex flex-col justify-center"),w(I,"class","btn lg danger flex-1"),w(R,"class","flex justify-center")},m(o,m){_(o,e,m),k(e,t),_(o,s,m),_(o,n,m),k(n,r),k(r,a),k(n,c),k(n,b),k(b,T),_(o,j,m),_(o,h,m),u.m(h,null),_(o,N,m),_(o,f,m),Z(d,f,null),_(o,g,m),_(o,v,m),p&&p.m(v,null),_(o,U,m),_(o,R,m),k(R,I),k(I,P),L=!0,Y||(le=[se(e,"click",l[17]),se(I,"click",l[18])],Y=!0)},p(o,m){var H,q;(!L||m&1)&&W(t,o[0]),(!L||m&128)&&W(a,o[7]),(!L||m&256)&&W(T,o[8]),Q===(Q=re(o))&&u?u.p(o,m):(u.d(1),u=Q(o),u&&(u.c(),u.m(h,null))),m&96&&ae(h,"bg-blue-500",((H=o[6][o[5]])==null?void 0:H.team)==="team1"),m&96&&ae(h,"bg-red-500",((q=o[6][o[5]])==null?void 0:q.team)==="team2");const M={};m&8&&(M.seconds=o[3]),d.$set(M),o[4]?p?p.p(o,m):(p=Te(o),p.c(),p.m(v,null)):p&&(p.d(1),p=null)},i(o){L||(x(d.$$.fragment,o),L=!0)},o(o){ee(d.$$.fragment,o),L=!1},d(o){o&&i(e),o&&i(s),o&&i(n),o&&i(j),o&&i(h),u.d(),o&&i(N),o&&i(f),te(d),o&&i(g),o&&i(v),p&&p.d(),o&&i(U),o&&i(R),Y=!1,$e(le)}}}function ze(l){let e,t;return e=new Be({props:{value:location.href}}),{c(){z(e.$$.fragment)},l(s){K(e.$$.fragment,s)},m(s,n){Z(e,s,n),t=!0},p:X,i(s){t||(x(e.$$.fragment,s),t=!0)},o(s){ee(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function Ke(l){let e,t;return{c(){e=y("h2"),t=S(l[0]),this.h()},l(s){e=$(s,"H2",{slot:!0});var n=E(e);t=V(n,l[0]),n.forEach(i),this.h()},h(){w(e,"slot","title")},m(s,n){_(s,e,n),k(e,t)},p(s,n){n&1&&W(t,s[0])},d(s){s&&i(e)}}}function Ze(l){let e,t;return{c(){e=y("a"),t=S("Exit"),this.h()},l(s){e=$(s,"A",{href:!0,class:!0});var n=E(e);t=V(n,"Exit"),n.forEach(i),this.h()},h(){w(e,"href",`${G}/`),w(e,"class","btn lg danger")},m(s,n){_(s,e,n),k(e,t)},p:X,d(s){s&&i(e)}}}function xe(l){let e,t,s,n,r,a,c,b;e=new Pe({props:{$$slots:{default:[Je]},$$scope:{ctx:l}}});function T(f){l[19](f)}let j={$$slots:{title:[Ke],default:[ze]},$$scope:{ctx:l}};l[10]!==void 0&&(j.show=l[10]),s=new Ie({props:j}),ve.push(()=>we(s,"show",T));function h(f){l[20](f)}let N={$$slots:{default:[Ze]},$$scope:{ctx:l}};return l[11]!==void 0&&(N.show=l[11]),a=new Ie({props:N}),ve.push(()=>we(a,"show",h)),{c(){z(e.$$.fragment),t=O(),z(s.$$.fragment),r=O(),z(a.$$.fragment)},l(f){K(e.$$.fragment,f),t=B(f),K(s.$$.fragment,f),r=B(f),K(a.$$.fragment,f)},m(f,d){Z(e,f,d),_(f,t,d),Z(s,f,d),_(f,r,d),Z(a,f,d),b=!0},p(f,[d]){const g={};d&8392703&&(g.$$scope={dirty:d,ctx:f}),e.$set(g);const v={};d&8388609&&(v.$$scope={dirty:d,ctx:f}),!n&&d&1024&&(n=!0,v.show=f[10],ke(()=>n=!1)),s.$set(v);const U={};d&8388608&&(U.$$scope={dirty:d,ctx:f}),!c&&d&2048&&(c=!0,U.show=f[11],ke(()=>c=!1)),a.$set(U)},i(f){b||(x(e.$$.fragment,f),x(s.$$.fragment,f),x(a.$$.fragment,f),b=!0)},o(f){ee(e.$$.fragment,f),ee(s.$$.fragment,f),ee(a.$$.fragment,f),b=!1},d(f){te(e,f),f&&i(t),te(s,f),f&&i(r),te(a,f)}}}const ft=!1;function it(l){return{props:{roomId:l.page.query.get("room")}}}const ie=60,je=new ge.Howl({src:[`${G}/sounds/alarm-clock.mp3`,`${G}/sounds/alarm-clock.wav`]}),C=new ge.Howl({src:[`${G}/sounds/ticking.mp3`,`${G}/sounds/ticking.wav`],loop:!0});function et(l,e,t){let s,n;Me(l,We,u=>t(5,n=u));let{roomId:r}=e,a={},c,b,T,j=!1,h=!0,N,f,d=!1,g=!1;async function v(){await U(),J.get("rooms").get(r).get("playing").put(!0)}async function U(){const u=J.get("rooms").get(r),p=await u,o=Le.fromSeed(p.seed),m=await Oe(o,p.words);u.get("word").put(m),u.get("seed").put(o.nextInt())}async function R(){const u=J.get("rooms").get(r),p=u.get("users"),o=Ee(await p).sort();u.get("turn").put(o[(o.indexOf(T)+1)%o.length]),C.stop(),await U()}let I;function P(u=ie){if(I!=null)return;const p=J.get("rooms").get(r).get("timer");t(16,I=setInterval(async()=>{const o=await p;if(o===0)L();else{const m=o-1;C.rate(1+(1-m/ie)),p.put(m)}},1e3)),C.rate(1+(1-u/ie)),C.playing()||C.play(),p.put(u)}function L(){if(I==null)return;const u=J.get("rooms").get(r),p=u.get("users").get(T),o=u.get("timer");Promise.all([u,p]).then(([m,M])=>{M.team==="team1"?u.get("team2").put(m.team1+1):u.get("team1").put(m.team2+1)}),o.put(0),u.get("playing").put(!1).then(()=>{t(16,I=void 0)}),clearInterval(I),C.stop(),je.play()}Re(()=>{const u=J.get("rooms").get(r),p=u.get("users").on(async D=>{t(6,a=(await Promise.all(Ee(D).map(A=>new Promise(F=>u.get("users").get(A).once(ue=>F([A,ue])))))).reduce((A,[F,ue])=>pe(de({},A),{[F]:ue}),{}))}),o=u.get("timer").on(D=>{t(3,N=D)}),m=u.get("started").on(D=>{t(15,h=D)}),M=u.get("team1").on(D=>{t(7,c=D)}),H=u.get("team2").on(D=>{t(8,b=D)}),q=u.get("word").on(D=>{t(9,f=D)}),oe=u.get("turn").on(D=>{t(1,T=D)}),ne=u.get("playing").on(D=>{t(2,j=D)});return()=>{p.off(),o.off(),m.off(),M.off(),H.off(),q.off(),oe.off(),ne.off(),C.stop(),je.stop()}});const Y=()=>t(10,d=!0),le=()=>t(11,g=!0);function re(u){d=u,t(10,d)}function Q(u){g=u,t(11,g)}return l.$$set=u=>{"roomId"in u&&t(0,r=u.roomId)},l.$$.update=()=>{l.$$.dirty&34&&t(4,s=T===n),l.$$.dirty&32769&&(h||He(`${G}/lobby?room=${r}`)),l.$$.dirty&65564&&(s&&j?P(N===0?ie:N):I!=null&&(clearInterval(I),t(16,I=void 0)))},[r,T,j,N,s,n,a,c,b,f,d,g,v,U,R,h,I,Y,le,re,Q]}class ut extends _e{constructor(e){super();be(this,e,et,xe,he,{roomId:0})}}export{ut as default,it as load,ft as ssr};
