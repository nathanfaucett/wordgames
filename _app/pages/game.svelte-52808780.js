var je=Object.defineProperty,De=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var ce=(s,e,t)=>e in s?je(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,me=(s,e)=>{for(var t in e||(e={}))Ve.call(e,t)&&ce(s,t,e[t]);if(ue)for(var t of ue(e))Ue.call(e,t)&&ce(s,t,e[t]);return s},de=(s,e)=>De(s,Se(e));import{S as pe,i as _e,s as he,t as U,g as N,f as g,h as W,J as X,d as i,a8 as be,U as ge,V as ve,j as z,k as O,m as K,n as B,o as Z,W as we,x as ee,u as te,v as se,Q as Ne,A as Le,l as ke,e as y,c as E,a as I,b as k,F as b,L as oe,_ as $e,a1 as Me}from"../chunks/vendor-230de008.js";import{b as C}from"../chunks/paths-28a87002.js";import{M as ye,d as Y,b as Pe,a as Re,Q as He,u as Oe}from"../chunks/userId-ebb4d183.js";import{L as Be,k as Ee}from"../chunks/util-ab4fc287.js";import"../chunks/singletons-e82519e2.js";function Qe(s){let e=ae(s[0])+"",t,o,l=ae(s[1])+"",n;return{c(){t=U(e),o=U(":"),n=U(l)},l(a){t=N(a,e),o=N(a,":"),n=N(a,l)},m(a,c){g(a,t,c),g(a,o,c),g(a,n,c)},p(a,[c]){c&1&&e!==(e=ae(a[0])+"")&&W(t,e),c&2&&l!==(l=ae(a[1])+"")&&W(n,l)},i:X,o:X,d(a){a&&i(t),a&&i(o),a&&i(n)}}}function ae(s){return(s<10?"0":"")+s}function We(s,e,t){let o,l,{seconds:n=60}=e;return s.$$set=a=>{"seconds"in a&&t(2,n=a.seconds)},s.$$.update=()=>{s.$$.dirty&4&&t(0,o=Math.floor(n/60)),s.$$.dirty&5&&t(1,l=Math.floor(n-o*60))},[o,l,n]}class qe extends pe{constructor(e){super();_e(this,e,We,Qe,he,{seconds:2})}}function Ie(s){let e;function t(n,a){return n[2]?xe:Ae}let o=t(s),l=o(s);return{c(){l.c(),e=ke()},l(n){l.l(n),e=ke()},m(n,a){l.m(n,a),g(n,e,a)},p(n,a){o===(o=t(n))&&l?l.p(n,a):(l.d(1),l=o(n),l&&(l.c(),l.m(e.parentNode,e)))},d(n){l.d(n),n&&i(e)}}}function xe(s){let e,t,o,l,n,a,c,p,T,D,v,V,f,_;return{c(){e=y("div"),t=y("div"),o=y("p"),l=U(s[8]),n=O(),a=y("div"),c=y("div"),p=y("button"),T=U("Skip"),D=O(),v=y("button"),V=U("Next"),this.h()},l(h){e=E(h,"DIV",{class:!0});var w=I(e);t=E(w,"DIV",{class:!0});var j=I(t);o=E(j,"P",{class:!0});var Q=I(o);l=N(Q,s[8]),Q.forEach(i),j.forEach(i),w.forEach(i),n=B(h),a=E(h,"DIV",{class:!0});var $=I(a);c=E($,"DIV",{class:!0});var P=I(c);p=E(P,"BUTTON",{class:!0});var L=I(p);T=N(L,"Skip"),L.forEach(i),D=B(P),v=E(P,"BUTTON",{class:!0});var M=I(v);V=N(M,"Next"),M.forEach(i),P.forEach(i),$.forEach(i),this.h()},h(){k(o,"class","text-6xl"),k(t,"class","text-center"),k(e,"class","flex-1 flex h-full justify-center items-center"),k(p,"class","btn lg danger flex-1"),k(v,"class","btn lg primary flex-1"),k(c,"class","flex flex-1 justify-center"),k(a,"class","flex-1")},m(h,w){g(h,e,w),b(e,t),b(t,o),b(o,l),g(h,n,w),g(h,a,w),b(a,c),b(c,p),b(p,T),b(c,D),b(c,v),b(v,V),f||(_=[oe(p,"click",s[12]),oe(v,"click",s[13])],f=!0)},p(h,w){w&256&&W(l,h[8])},d(h){h&&i(e),h&&i(n),h&&i(a),f=!1,$e(_)}}}function Ae(s){let e,t,o,l,n,a;return{c(){e=y("div"),t=y("div"),o=y("button"),l=U("Start"),this.h()},l(c){e=E(c,"DIV",{class:!0});var p=I(e);t=E(p,"DIV",{class:!0});var T=I(t);o=E(T,"BUTTON",{class:!0});var D=I(o);l=N(D,"Start"),D.forEach(i),T.forEach(i),p.forEach(i),this.h()},h(){k(o,"class","btn lg primary flex-1"),k(t,"class","flex justify-center"),k(e,"class","flex-1")},m(c,p){g(c,e,p),b(e,t),b(t,o),b(o,l),n||(a=oe(o,"click",s[11]),n=!0)},p:X,d(c){c&&i(e),n=!1,a()}}}function Ce(s){let e,t,o,l,n,a,c,p,T,D,v,V=(s[4]?"Your":s[5][s[1]]+"'s")+"",f,_,h,w,j,Q,$,P,L,M,F,H,G,u;j=new qe({props:{seconds:s[3]}});let d=s[4]&&Ie(s);return{c(){e=y("h1"),t=U(s[0]),o=O(),l=y("div"),n=y("div"),a=U(s[6]),c=O(),p=y("div"),T=U(s[7]),D=O(),v=y("h1"),f=U(V),_=U(" Turn"),h=O(),w=y("p"),z(j.$$.fragment),Q=O(),$=y("div"),d&&d.c(),P=O(),L=y("div"),M=y("button"),F=U("Leave"),this.h()},l(r){e=E(r,"H1",{class:!0});var m=I(e);t=N(m,s[0]),m.forEach(i),o=B(r),l=E(r,"DIV",{class:!0});var R=I(l);n=E(R,"DIV",{class:!0});var re=I(n);a=N(re,s[6]),re.forEach(i),c=B(R),p=E(R,"DIV",{class:!0});var le=I(p);T=N(le,s[7]),le.forEach(i),R.forEach(i),D=B(r),v=E(r,"H1",{class:!0});var J=I(v);f=N(J,V),_=N(J," Turn"),J.forEach(i),h=B(r),w=E(r,"P",{class:!0});var ne=I(w);K(j.$$.fragment,ne),ne.forEach(i),Q=B(r),$=E(r,"DIV",{class:!0});var S=I($);d&&d.l(S),S.forEach(i),P=B(r),L=E(r,"DIV",{class:!0});var q=I(L);M=E(q,"BUTTON",{class:!0});var A=I(M);F=N(A,"Leave"),A.forEach(i),q.forEach(i),this.h()},h(){k(e,"class","text-6xl text-center cursor-pointer"),k(n,"class","btn md primary flex-1 text-center"),k(p,"class","btn md danger flex-1 text-center"),k(l,"class","flex justify-center"),k(v,"class","text-center"),k(w,"class","text-2xl text-center"),k($,"class","flex-grow flex flex-col justify-center"),k(M,"class","btn lg danger flex-1"),k(L,"class","flex justify-center")},m(r,m){g(r,e,m),b(e,t),g(r,o,m),g(r,l,m),b(l,n),b(n,a),b(l,c),b(l,p),b(p,T),g(r,D,m),g(r,v,m),b(v,f),b(v,_),g(r,h,m),g(r,w,m),Z(j,w,null),g(r,Q,m),g(r,$,m),d&&d.m($,null),g(r,P,m),g(r,L,m),b(L,M),b(M,F),H=!0,G||(u=[oe(e,"click",s[17]),oe(M,"click",s[18])],G=!0)},p(r,m){(!H||m&1)&&W(t,r[0]),(!H||m&64)&&W(a,r[6]),(!H||m&128)&&W(T,r[7]),(!H||m&50)&&V!==(V=(r[4]?"Your":r[5][r[1]]+"'s")+"")&&W(f,V);const R={};m&8&&(R.seconds=r[3]),j.$set(R),r[4]?d?d.p(r,m):(d=Ie(r),d.c(),d.m($,null)):d&&(d.d(1),d=null)},i(r){H||(ee(j.$$.fragment,r),H=!0)},o(r){te(j.$$.fragment,r),H=!1},d(r){r&&i(e),r&&i(o),r&&i(l),r&&i(D),r&&i(v),r&&i(h),r&&i(w),se(j),r&&i(Q),r&&i($),d&&d.d(),r&&i(P),r&&i(L),G=!1,$e(u)}}}function Ye(s){let e,t;return e=new He({props:{value:location.href}}),{c(){z(e.$$.fragment)},l(o){K(e.$$.fragment,o)},m(o,l){Z(e,o,l),t=!0},p:X,i(o){t||(ee(e.$$.fragment,o),t=!0)},o(o){te(e.$$.fragment,o),t=!1},d(o){se(e,o)}}}function Fe(s){let e,t;return{c(){e=y("h2"),t=U(s[0]),this.h()},l(o){e=E(o,"H2",{slot:!0});var l=I(e);t=N(l,s[0]),l.forEach(i),this.h()},h(){k(e,"slot","title")},m(o,l){g(o,e,l),b(e,t)},p(o,l){l&1&&W(t,o[0])},d(o){o&&i(e)}}}function Ge(s){let e,t;return{c(){e=y("a"),t=U("Exit"),this.h()},l(o){e=E(o,"A",{href:!0,class:!0});var l=I(e);t=N(l,"Exit"),l.forEach(i),this.h()},h(){k(e,"href",`${C}/`),k(e,"class","btn lg danger")},m(o,l){g(o,e,l),b(e,t)},p:X,d(o){o&&i(e)}}}function Je(s){let e,t,o,l,n,a,c,p;e=new Be({props:{$$slots:{default:[Ce]},$$scope:{ctx:s}}});function T(f){s[19](f)}let D={$$slots:{title:[Fe],default:[Ye]},$$scope:{ctx:s}};s[9]!==void 0&&(D.show=s[9]),o=new ye({props:D}),ge.push(()=>ve(o,"show",T));function v(f){s[20](f)}let V={$$slots:{default:[Ge]},$$scope:{ctx:s}};return s[10]!==void 0&&(V.show=s[10]),a=new ye({props:V}),ge.push(()=>ve(a,"show",v)),{c(){z(e.$$.fragment),t=O(),z(o.$$.fragment),n=O(),z(a.$$.fragment)},l(f){K(e.$$.fragment,f),t=B(f),K(o.$$.fragment,f),n=B(f),K(a.$$.fragment,f)},m(f,_){Z(e,f,_),g(f,t,_),Z(o,f,_),g(f,n,_),Z(a,f,_),p=!0},p(f,[_]){const h={};_&8390655&&(h.$$scope={dirty:_,ctx:f}),e.$set(h);const w={};_&8388609&&(w.$$scope={dirty:_,ctx:f}),!l&&_&512&&(l=!0,w.show=f[9],we(()=>l=!1)),o.$set(w);const j={};_&8388608&&(j.$$scope={dirty:_,ctx:f}),!c&&_&1024&&(c=!0,j.show=f[10],we(()=>c=!1)),a.$set(j)},i(f){p||(ee(e.$$.fragment,f),ee(o.$$.fragment,f),ee(a.$$.fragment,f),p=!0)},o(f){te(e.$$.fragment,f),te(o.$$.fragment,f),te(a.$$.fragment,f),p=!1},d(f){se(e,f),f&&i(t),se(o,f),f&&i(n),se(a,f)}}}const ot=!1;function rt(s){return{props:{roomId:s.page.query.get("room")}}}const fe=60,Te=new be.Howl({src:[`${C}/sounds/alarm-clock.mp3`,`${C}/sounds/alarm-clock.wav`]}),x=new be.Howl({src:[`${C}/sounds/ticking.mp3`,`${C}/sounds/ticking.wav`],loop:!0});function Xe(s,e,t){let o,l;Ne(s,Oe,u=>t(16,l=u));let{roomId:n}=e,a={},c,p,T,D=!1,v=!0,V,f,_=!1,h=!1;async function w(){await j(),Y.get("rooms").get(n).get("playing").put(!0)}async function j(){const u=Y.get("rooms").get(n),d=await u,r=Me.fromSeed(d.seed),m=await Pe(r,d.words);u.get("word").put(m),u.get("seed").put(r.nextInt())}async function Q(){const u=Y.get("rooms").get(n),d=u.get("users"),r=Ee(await d).sort();u.get("turn").put(r[(r.indexOf(T)+1)%r.length]),x.stop(),await j()}let $;function P(u=fe){if($!=null)return;const d=Y.get("rooms").get(n).get("timer");t(15,$=setInterval(async()=>{const r=await d;if(r===0)L();else{const m=r-1;x.rate(1+(1-m/fe)),d.put(m)}},1e3)),x.rate(1+(1-u/fe)),x.playing()||x.play(),d.put(u)}function L(){if($==null)return;const u=Y.get("rooms").get(n),d=u.get("users").get(T),r=u.get("timer");Promise.all([u,d]).then(([m,R])=>{R.team==="team1"?u.get("team1").put(m.team1+1):u.get("team2").put(m.team2+1)}),r.put(0),u.get("playing").put(!1).then(()=>{t(15,$=void 0)}),clearInterval($),x.stop(),Te.play()}Le(()=>{const u=Y.get("rooms").get(n),d=u.get("users").on(async S=>{t(5,a=(await Promise.all(Ee(S).map(q=>new Promise(A=>u.get("users").get(q).once(ie=>A([q,ie])))))).reduce((q,[A,ie])=>de(me({},q),{[A]:ie.name}),{}))}),r=u.get("timer").on(S=>{t(3,V=S)}),m=u.get("started").on(S=>{t(14,v=S)}),R=u.get("team1").on(S=>{t(6,c=S)}),re=u.get("team2").on(S=>{t(7,p=S)}),le=u.get("word").on(S=>{t(8,f=S)}),J=u.get("turn").on(S=>{t(1,T=S)}),ne=u.get("playing").on(S=>{t(2,D=S)});return()=>{d.off(),r.off(),m.off(),R.off(),re.off(),le.off(),J.off(),ne.off(),x.stop(),Te.stop()}});const M=()=>t(9,_=!0),F=()=>t(10,h=!0);function H(u){_=u,t(9,_)}function G(u){h=u,t(10,h)}return s.$$set=u=>{"roomId"in u&&t(0,n=u.roomId)},s.$$.update=()=>{s.$$.dirty&65538&&t(4,o=T===l),s.$$.dirty&16385&&(v||Re(`${C}/lobby?room=${n}`)),s.$$.dirty&32796&&(o&&D?P(V===0?fe:V):$!=null&&(clearInterval($),t(15,$=void 0)))},[n,T,D,V,o,a,c,p,f,_,h,w,j,Q,v,$,l,M,F,H,G]}class lt extends pe{constructor(e){super();_e(this,e,Xe,Je,he,{roomId:0})}}export{lt as default,rt as load,ot as ssr};
