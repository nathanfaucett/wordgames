import{S as We,i as Me,s as Re,U as ke,V as we,j as ae,k as N,m as oe,n as P,o as re,f as T,W as $e,x as ne,u as ie,v as ue,d as i,J as Ee,A as Ne,e as w,t as A,c as $,a as j,g as C,H as f,I as ce,b as c,X as Y,L as X,Y as de,Z as Ie,h as Z,_ as je,$ as ye,O as Pe,a0 as Ae,a1 as Ce,a2 as De,P as He}from"../chunks/vendor-f52da261.js";import{g as Se,k as qe,e as Be}from"../chunks/util-ef0af0fd.js";import{L as Qe,d as z,u as Xe,l as Fe}from"../chunks/user-a6e6886b.js";import{b as me}from"../chunks/paths-45dac81d.js";import{M as Ve,W as fe,g as Ge,Q as Je}from"../chunks/words-08d5bb08.js";import"../chunks/singletons-12a22614.js";import"../chunks/preload-helper-ac1c8acd.js";function Te(o,e,l){const t=o.slice();return t[20]=e[l][0],t[21]=e[l][1],t[23]=l,t}function Le(o,e,l){const t=o.slice();return t[24]=e[l],t}function Oe(o){let e,l=o[24]+"",t,n;return{c(){e=w("option"),t=A(l),this.h()},l(u){e=$(u,"OPTION",{});var m=j(e);t=C(m,l),m.forEach(i),this.h()},h(){e.__value=n=fe[o[24]],e.value=e.__value},m(u,m){T(u,e,m),f(e,t)},p:ce,d(u){u&&i(e)}}}function Ue(o,e){let l,t,n,u=e[23]+1+"",m,W,p=e[20]+"",M,y,v,E,a,b,L,D,S,g,B,H,R,q,r,I;return{key:o,first:null,c(){l=w("div"),t=w("div"),n=w("p"),m=A(u),W=A(" - "),M=A(p),y=N(),v=w("form"),E=w("div"),a=w("input"),D=N(),S=w("div"),g=w("input"),R=N(),q=w("hr"),this.h()},l(k){l=$(k,"DIV",{class:!0});var h=j(l);t=$(h,"DIV",{class:!0});var V=j(t);n=$(V,"P",{class:!0});var O=j(n);m=C(O,u),W=C(O," - "),M=C(O,p),O.forEach(i),V.forEach(i),y=P(h),v=$(h,"FORM",{class:!0});var Q=j(v);E=$(Q,"DIV",{class:!0});var G=j(E);a=$(G,"INPUT",{id:!0,name:!0,type:!0,class:!0}),G.forEach(i),D=P(Q),S=$(Q,"DIV",{class:!0});var K=j(S);g=$(K,"INPUT",{id:!0,name:!0,type:!0,class:!0}),K.forEach(i),Q.forEach(i),h.forEach(i),R=P(k),q=$(k,"HR",{}),this.h()},h(){c(n,"class","text-2xl p-1 font-bold"),c(t,"class","flex-grow"),c(a,"id",b=`${e[20]}-1`),c(a,"name","team"),a.value="1",c(a,"type","radio"),c(a,"class","align-bottom"),a.checked=L=e[21]==="team1",c(E,"class","btn sm primary flex-1"),c(g,"id",B=`${e[20]}-2`),c(g,"name","team"),g.value="2",c(g,"type","radio"),c(g,"class","align-bottom"),g.checked=H=e[21]==="team2",c(S,"class","btn sm danger flex-1"),c(v,"class","flex-grow-0 flex flex-row"),c(l,"class","flex justify-between"),Y(l,"bg-gray-200",e[20]===e[1]),this.first=l},m(k,h){T(k,l,h),f(l,t),f(t,n),f(n,m),f(n,W),f(n,M),f(l,y),f(l,v),f(v,E),f(E,a),f(v,D),f(v,S),f(S,g),T(k,R,h),T(k,q,h),r||(I=[X(a,"click",de(e[15])),X(E,"click",function(){Ie(e[9](e[20],e[21],"team1"))&&e[9](e[20],e[21],"team1").apply(this,arguments)}),X(g,"click",de(e[14])),X(S,"click",function(){Ie(e[9](e[20],e[21],"team2"))&&e[9](e[20],e[21],"team2").apply(this,arguments)})],r=!0)},p(k,h){e=k,h&4&&u!==(u=e[23]+1+"")&&Z(m,u),h&4&&p!==(p=e[20]+"")&&Z(M,p),h&4&&b!==(b=`${e[20]}-1`)&&c(a,"id",b),h&4&&L!==(L=e[21]==="team1")&&(a.checked=L),h&4&&B!==(B=`${e[20]}-2`)&&c(g,"id",B),h&4&&H!==(H=e[21]==="team2")&&(g.checked=H),h&6&&Y(l,"bg-gray-200",e[20]===e[1])},d(k){k&&i(l),k&&i(R),k&&i(q),r=!1,je(I)}}}function Ye(o){let e,l,t,n,u,m,W,p,M,y,v,E,a,b,L,D,S,g=[],B=new Map,H,R,q,r,I,k,h,V,O,Q,G,K,J=Object.keys(fe),U=[];for(let s=0;s<J.length;s+=1)U[s]=Oe(Le(o,J,s));let ee=o[2];const _e=s=>s[20];for(let s=0;s<ee.length;s+=1){let d=Te(o,ee,s),_=_e(d);B.set(_,g[s]=Ue(_,d))}return{c(){e=w("h1"),l=A(o[0]),t=N(),n=w("div"),u=w("label"),m=A("Words"),W=N(),p=w("select");for(let s=0;s<U.length;s+=1)U[s].c();M=N(),y=w("div"),v=w("div"),E=w("div"),a=A(o[3]),b=N(),L=w("div"),D=A(o[4]),S=N();for(let s=0;s<g.length;s+=1)g[s].c();H=N(),R=w("div"),q=N(),r=w("div"),I=w("button"),k=A("Start"),V=N(),O=w("button"),Q=A("Leave"),this.h()},l(s){e=$(s,"H1",{class:!0});var d=j(e);l=C(d,o[0]),d.forEach(i),t=P(s),n=$(s,"DIV",{class:!0});var _=j(n);u=$(_,"LABEL",{for:!0});var x=j(u);m=C(x,"Words"),x.forEach(i),W=P(_),p=$(_,"SELECT",{id:!0,class:!0});var he=j(p);for(let F=0;F<U.length;F+=1)U[F].l(he);he.forEach(i),_.forEach(i),M=P(s),y=$(s,"DIV",{class:!0});var te=j(y);v=$(te,"DIV",{class:!0});var se=j(v);E=$(se,"DIV",{class:!0});var pe=j(E);a=C(pe,o[3]),pe.forEach(i),b=P(se),L=$(se,"DIV",{class:!0});var ge=j(L);D=C(ge,o[4]),ge.forEach(i),se.forEach(i),S=P(te);for(let F=0;F<g.length;F+=1)g[F].l(te);te.forEach(i),H=P(s),R=$(s,"DIV",{class:!0}),j(R).forEach(i),q=P(s),r=$(s,"DIV",{class:!0});var le=j(r);I=$(le,"BUTTON",{class:!0});var be=j(I);k=C(be,"Start"),be.forEach(i),V=P(le),O=$(le,"BUTTON",{class:!0});var ve=j(O);Q=C(ve,"Leave"),ve.forEach(i),le.forEach(i),this.h()},h(){c(e,"class","text-6xl text-center cursor-pointer"),c(u,"for","words"),c(p,"id","words"),c(p,"class","input"),c(n,"class","mt-2"),c(E,"class","btn md primary flex-1 text-center"),c(L,"class","btn md danger flex-1 text-center"),c(v,"class","mt-2 mb-2 flex justify-center"),c(y,"class","mt-2 mb-2"),c(R,"class","flex-grow"),c(I,"class","btn lg primary flex-1"),I.disabled=h=o[2].length<2,Y(I,"bg-blue-100",o[2].length<2),Y(I,"hover:bg-blue-500",o[2].length>1),c(O,"class","btn lg danger flex-1"),c(r,"class","flex justify-center")},m(s,d){T(s,e,d),f(e,l),T(s,t,d),T(s,n,d),f(n,u),f(u,m),f(n,W),f(n,p);for(let _=0;_<U.length;_+=1)U[_].m(p,null);ye(p,o[5]),T(s,M,d),T(s,y,d),f(y,v),f(v,E),f(E,a),f(v,b),f(v,L),f(L,D),f(y,S);for(let _=0;_<g.length;_+=1)g[_].m(y,null);T(s,H,d),T(s,R,d),T(s,q,d),T(s,r,d),f(r,I),f(I,k),f(r,V),f(r,O),f(O,Q),G||(K=[X(e,"click",o[16]),X(p,"change",de(o[8])),X(I,"click",o[10]),X(O,"click",o[17])],G=!0)},p(s,d){if(d&1&&Z(l,s[0]),d&0){J=Object.keys(fe);let _;for(_=0;_<J.length;_+=1){const x=Le(s,J,_);U[_]?U[_].p(x,d):(U[_]=Oe(x),U[_].c(),U[_].m(p,null))}for(;_<U.length;_+=1)U[_].d(1);U.length=J.length}d&32&&ye(p,s[5]),d&8&&Z(a,s[3]),d&16&&Z(D,s[4]),d&518&&(ee=s[2],g=Pe(g,d,_e,1,s,ee,B,y,He,Ue,null,Te)),d&4&&h!==(h=s[2].length<2)&&(I.disabled=h),d&4&&Y(I,"bg-blue-100",s[2].length<2),d&4&&Y(I,"hover:bg-blue-500",s[2].length>1)},d(s){s&&i(e),s&&i(t),s&&i(n),Ae(U,s),s&&i(M),s&&i(y);for(let d=0;d<g.length;d+=1)g[d].d();s&&i(H),s&&i(R),s&&i(q),s&&i(r),G=!1,je(K)}}}function Ze(o){let e,l;return e=new Je({props:{value:location.href}}),{c(){ae(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,n){re(e,t,n),l=!0},p:ce,i(t){l||(ne(e.$$.fragment,t),l=!0)},o(t){ie(e.$$.fragment,t),l=!1},d(t){ue(e,t)}}}function ze(o){let e,l;return{c(){e=w("h3"),l=A(o[0]),this.h()},l(t){e=$(t,"H3",{slot:!0});var n=j(e);l=C(n,o[0]),n.forEach(i),this.h()},h(){c(e,"slot","title")},m(t,n){T(t,e,n),f(e,l)},p(t,n){n&1&&Z(l,t[0])},d(t){t&&i(e)}}}function Ke(o){let e,l;return{c(){e=w("a"),l=A("Exit"),this.h()},l(t){e=$(t,"A",{href:!0,class:!0});var n=j(e);l=C(n,"Exit"),n.forEach(i),this.h()},h(){c(e,"href",`${me}/`),c(e,"class","btn lg danger")},m(t,n){T(t,e,n),f(e,l)},p:ce,d(t){t&&i(e)}}}function xe(o){let e,l,t,n,u,m,W,p;e=new Qe({props:{$$slots:{default:[Ye]},$$scope:{ctx:o}}});function M(a){o[18](a)}let y={$$slots:{title:[ze],default:[Ze]},$$scope:{ctx:o}};o[6]!==void 0&&(y.show=o[6]),t=new Ve({props:y}),ke.push(()=>we(t,"show",M));function v(a){o[19](a)}let E={$$slots:{default:[Ke]},$$scope:{ctx:o}};return o[7]!==void 0&&(E.show=o[7]),m=new Ve({props:E}),ke.push(()=>we(m,"show",v)),{c(){ae(e.$$.fragment),l=N(),ae(t.$$.fragment),u=N(),ae(m.$$.fragment)},l(a){oe(e.$$.fragment,a),l=P(a),oe(t.$$.fragment,a),u=P(a),oe(m.$$.fragment,a)},m(a,b){re(e,a,b),T(a,l,b),re(t,a,b),T(a,u,b),re(m,a,b),p=!0},p(a,[b]){const L={};b&134217983&&(L.$$scope={dirty:b,ctx:a}),e.$set(L);const D={};b&134217729&&(D.$$scope={dirty:b,ctx:a}),!n&&b&64&&(n=!0,D.show=a[6],$e(()=>n=!1)),t.$set(D);const S={};b&134217728&&(S.$$scope={dirty:b,ctx:a}),!W&&b&128&&(W=!0,S.show=a[7],$e(()=>W=!1)),m.$set(S)},i(a){p||(ne(e.$$.fragment,a),ne(t.$$.fragment,a),ne(m.$$.fragment,a),p=!0)},o(a){ie(e.$$.fragment,a),ie(t.$$.fragment,a),ie(m.$$.fragment,a),p=!1},d(a){ue(e,a),a&&i(l),ue(t,a),a&&i(u),ue(m,a)}}}function it(o){return{props:{roomId:o.page.query.get("room")}}}function et(o,e,l){let t,n;Ee(o,Xe,r=>l(1,t=r)),Ee(o,Fe,r=>l(13,n=r));let{roomId:u}=e,m=[],W=!1,p=0,M=0,y,v=!1,E=!1;function a(r){z.get("rooms").get(u).get("words").put(r.currentTarget.value)}function b(r,I,k){return function(){I!==k&&z.get("rooms").get(u).get("users").get(r).put(k)}}async function L(){const r=z.get("rooms").get(u),I=r.get("users"),k=await I,h=await r,V=Ce.fromSeed(h.seed);r.get("turn").put(V.fromArray(qe(k)).unwrap()),r.get("word").put(await Ge(V,h.words)),r.get("started").put(!0)}let D;Ne(()=>{const r=z.get("rooms").get(u),I=r.get("users").on(V=>{l(2,m=Be(V).sort()),l(3,p=m.filter(([,O])=>O==="team1").length),l(4,M=m.length-p)}),k=r.get("words").on(V=>{l(5,y=V)}),h=r.get("started").on(V=>{l(11,W=V)});return r.once(V=>{if(!V.seed){const O=Date.now();r.put({seed:O,team1:0,team2:0,started:!1,words:fe.Medium})}}),()=>{I.off(),k.off(),h.off()}});function S(r){De.call(this,o,r)}function g(r){De.call(this,o,r)}const B=()=>l(6,v=!0),H=()=>l(7,E=!0);function R(r){v=r,l(6,v)}function q(r){E=r,l(7,E)}return o.$$set=r=>{"roomId"in r&&l(0,u=r.roomId)},o.$$.update=()=>{if(o.$$.dirty&8194&&!t&&!n&&Se(`${me}/auth`),o.$$.dirty&2049&&W&&Se(`${me}/game?room=${u}`),o.$$.dirty&4099&&t&&D!==t){const r=t;z.get("rooms").get(u).get("users").get(r).put("team1"),D&&z.get("rooms").get(u).get("users").get(D).put(null),l(12,D=r)}},[u,t,m,p,M,y,v,E,a,b,L,W,D,n,S,g,B,H,R,q]}class ut extends We{constructor(e){super();Me(this,e,et,xe,Re,{roomId:0})}}export{ut as default,it as load};
