import{S as fe,i as ie,s as ue,t as N,g as U,f as w,h as q,I as Y,d as i,U as ce,V as me,j as F,k as B,m as G,n as P,o as J,W as de,x as X,u as z,v as K,J as pe,A as ke,l as _e,e as E,c as I,a as T,b as $,H as h,L as Z,_ as be,a1 as $e,a3 as Ee}from"../chunks/vendor-f52da261.js";import{b as re}from"../chunks/paths-45dac81d.js";import{g as he,k as Ie}from"../chunks/util-ef0af0fd.js";import{L as Te,d as A,l as ye,u as ge}from"../chunks/user-a6e6886b.js";import{M as ve,g as je,Q as De}from"../chunks/words-08d5bb08.js";import"../chunks/singletons-12a22614.js";import"../chunks/preload-helper-ac1c8acd.js";function Se(l){let e=se(l[0])+"",t,s,n=se(l[1])+"",o;return{c(){t=N(e),s=N(":"),o=N(n)},l(a){t=U(a,e),s=U(a,":"),o=U(a,n)},m(a,c){w(a,t,c),w(a,s,c),w(a,o,c)},p(a,[c]){c&1&&e!==(e=se(a[0])+"")&&q(t,e),c&2&&n!==(n=se(a[1])+"")&&q(o,n)},i:Y,o:Y,d(a){a&&i(t),a&&i(s),a&&i(o)}}}function se(l){return(l<10?"0":"")+l}function Ve(l,e,t){let s,n,{seconds:o=60}=e;return l.$$set=a=>{"seconds"in a&&t(2,o=a.seconds)},l.$$.update=()=>{l.$$.dirty&4&&t(0,s=Math.floor(o/60)),l.$$.dirty&5&&t(1,n=Math.floor(o-s*60))},[s,n,o]}class Ne extends fe{constructor(e){super();ie(this,e,Ve,Se,ue,{seconds:2})}}function we(l){let e;function t(o,a){return o[1]?Ue:Le}let s=t(l),n=s(l);return{c(){n.c(),e=_e()},l(o){n.l(o),e=_e()},m(o,a){n.m(o,a),w(o,e,a)},p(o,a){s===(s=t(o))&&n?n.p(o,a):(n.d(1),n=s(o),n&&(n.c(),n.m(e.parentNode,e)))},d(o){n.d(o),o&&i(e)}}}function Ue(l){let e,t,s,n,o,a,c,m,D,j,g,S,f,_;return{c(){e=E("div"),t=E("div"),s=E("p"),n=N(l[7]),o=B(),a=E("div"),c=E("div"),m=E("button"),D=N("Skip"),j=B(),g=E("button"),S=N("Next"),this.h()},l(b){e=I(b,"DIV",{class:!0});var v=T(e);t=I(v,"DIV",{class:!0});var y=T(t);s=I(y,"P",{class:!0});var W=T(s);n=U(W,l[7]),W.forEach(i),y.forEach(i),v.forEach(i),o=P(b),a=I(b,"DIV",{class:!0});var k=T(a);c=I(k,"DIV",{class:!0});var L=T(c);m=I(L,"BUTTON",{class:!0});var M=T(m);D=U(M,"Skip"),M.forEach(i),j=P(L),g=I(L,"BUTTON",{class:!0});var x=T(g);S=U(x,"Next"),x.forEach(i),L.forEach(i),k.forEach(i),this.h()},h(){$(s,"class","text-6xl"),$(t,"class","text-center"),$(e,"class","flex-1 flex h-full justify-center items-center"),$(m,"class","btn lg danger flex-1"),$(g,"class","btn lg primary flex-1"),$(c,"class","flex flex-1 justify-center"),$(a,"class","flex-1")},m(b,v){w(b,e,v),h(e,t),h(t,s),h(s,n),w(b,o,v),w(b,a,v),h(a,c),h(c,m),h(m,D),h(c,j),h(c,g),h(g,S),f||(_=[Z(m,"click",l[11]),Z(g,"click",l[12])],f=!0)},p(b,v){v&128&&q(n,b[7])},d(b){b&&i(e),b&&i(o),b&&i(a),f=!1,be(_)}}}function Le(l){let e,t,s,n,o,a;return{c(){e=E("div"),t=E("div"),s=E("button"),n=N("Start"),this.h()},l(c){e=I(c,"DIV",{class:!0});var m=T(e);t=I(m,"DIV",{class:!0});var D=T(t);s=I(D,"BUTTON",{class:!0});var j=T(s);n=U(j,"Start"),j.forEach(i),D.forEach(i),m.forEach(i),this.h()},h(){$(s,"class","btn lg primary flex-1"),$(t,"class","flex justify-center"),$(e,"class","flex-1")},m(c,m){w(c,e,m),h(e,t),h(t,s),h(s,n),o||(a=Z(s,"click",l[10]),o=!0)},p:Y,d(c){c&&i(e),o=!1,a()}}}function Me(l){let e,t,s,n,o,a,c,m,D,j,g,S=(l[2]?"Your":l[6]+"'s")+"",f,_,b,v,y,W,k,L,M,x,C,R,H,u;y=new Ne({props:{seconds:l[3]}});let d=l[2]&&we(l);return{c(){e=E("h1"),t=N(l[0]),s=B(),n=E("div"),o=E("div"),a=N(l[4]),c=B(),m=E("div"),D=N(l[5]),j=B(),g=E("h1"),f=N(S),_=N(" Turn"),b=B(),v=E("p"),F(y.$$.fragment),W=B(),k=E("div"),d&&d.c(),L=B(),M=E("div"),x=E("button"),C=N("Leave"),this.h()},l(r){e=I(r,"H1",{class:!0});var p=T(e);t=U(p,l[0]),p.forEach(i),s=P(r),n=I(r,"DIV",{class:!0});var O=T(n);o=I(O,"DIV",{class:!0});var ee=T(o);a=U(ee,l[4]),ee.forEach(i),c=P(O),m=I(O,"DIV",{class:!0});var te=T(m);D=U(te,l[5]),te.forEach(i),O.forEach(i),j=P(r),g=I(r,"H1",{class:!0});var Q=T(g);f=U(Q,S),_=U(Q," Turn"),Q.forEach(i),b=P(r),v=I(r,"P",{class:!0});var V=T(v);G(y.$$.fragment,V),V.forEach(i),W=P(r),k=I(r,"DIV",{class:!0});var oe=T(k);d&&d.l(oe),oe.forEach(i),L=P(r),M=I(r,"DIV",{class:!0});var ne=T(M);x=I(ne,"BUTTON",{class:!0});var ae=T(x);C=U(ae,"Leave"),ae.forEach(i),ne.forEach(i),this.h()},h(){$(e,"class","text-6xl text-center cursor-pointer"),$(o,"class","btn md primary flex-1 text-center"),$(m,"class","btn md danger flex-1 text-center"),$(n,"class","flex justify-center"),$(g,"class","text-center"),$(v,"class","text-2xl text-center"),$(k,"class","flex-grow flex flex-col justify-center"),$(x,"class","btn lg danger flex-1"),$(M,"class","flex justify-center")},m(r,p){w(r,e,p),h(e,t),w(r,s,p),w(r,n,p),h(n,o),h(o,a),h(n,c),h(n,m),h(m,D),w(r,j,p),w(r,g,p),h(g,f),h(g,_),w(r,b,p),w(r,v,p),J(y,v,null),w(r,W,p),w(r,k,p),d&&d.m(k,null),w(r,L,p),w(r,M,p),h(M,x),h(x,C),R=!0,H||(u=[Z(e,"click",l[17]),Z(x,"click",l[18])],H=!0)},p(r,p){(!R||p&1)&&q(t,r[0]),(!R||p&16)&&q(a,r[4]),(!R||p&32)&&q(D,r[5]),(!R||p&68)&&S!==(S=(r[2]?"Your":r[6]+"'s")+"")&&q(f,S);const O={};p&8&&(O.seconds=r[3]),y.$set(O),r[2]?d?d.p(r,p):(d=we(r),d.c(),d.m(k,null)):d&&(d.d(1),d=null)},i(r){R||(X(y.$$.fragment,r),R=!0)},o(r){z(y.$$.fragment,r),R=!1},d(r){r&&i(e),r&&i(s),r&&i(n),r&&i(j),r&&i(g),r&&i(b),r&&i(v),K(y),r&&i(W),r&&i(k),d&&d.d(),r&&i(L),r&&i(M),H=!1,be(u)}}}function xe(l){let e,t;return e=new De({props:{value:location.href}}),{c(){F(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,n){J(e,s,n),t=!0},p:Y,i(s){t||(X(e.$$.fragment,s),t=!0)},o(s){z(e.$$.fragment,s),t=!1},d(s){K(e,s)}}}function Oe(l){let e,t;return{c(){e=E("a"),t=N("Exit"),this.h()},l(s){e=I(s,"A",{href:!0,class:!0});var n=T(e);t=U(n,"Exit"),n.forEach(i),this.h()},h(){$(e,"href",`${re}/`),$(e,"class","btn lg danger")},m(s,n){w(s,e,n),h(e,t)},p:Y,d(s){s&&i(e)}}}function Re(l){let e,t,s,n,o,a,c,m;e=new Te({props:{$$slots:{default:[Me]},$$scope:{ctx:l}}});function D(f){l[19](f)}let j={$$slots:{default:[xe]},$$scope:{ctx:l}};l[8]!==void 0&&(j.show=l[8]),s=new ve({props:j}),ce.push(()=>me(s,"show",D));function g(f){l[20](f)}let S={$$slots:{default:[Oe]},$$scope:{ctx:l}};return l[9]!==void 0&&(S.show=l[9]),a=new ve({props:S}),ce.push(()=>me(a,"show",g)),{c(){F(e.$$.fragment),t=B(),F(s.$$.fragment),o=B(),F(a.$$.fragment)},l(f){G(e.$$.fragment,f),t=P(f),G(s.$$.fragment,f),o=P(f),G(a.$$.fragment,f)},m(f,_){J(e,f,_),w(f,t,_),J(s,f,_),w(f,o,_),J(a,f,_),m=!0},p(f,[_]){const b={};_&8389631&&(b.$$scope={dirty:_,ctx:f}),e.$set(b);const v={};_&8388608&&(v.$$scope={dirty:_,ctx:f}),!n&&_&256&&(n=!0,v.show=f[8],de(()=>n=!1)),s.$set(v);const y={};_&8388608&&(y.$$scope={dirty:_,ctx:f}),!c&&_&512&&(c=!0,y.show=f[9],de(()=>c=!1)),a.$set(y)},i(f){m||(X(e.$$.fragment,f),X(s.$$.fragment,f),X(a.$$.fragment,f),m=!0)},o(f){z(e.$$.fragment,f),z(s.$$.fragment,f),z(a.$$.fragment,f),m=!1},d(f){K(e,f),f&&i(t),K(s,f),f&&i(o),K(a,f)}}}const le=60;function Ye(l){return{props:{roomId:l.page.query.get("room")}}}function Be(l,e,t){let s,n;pe(l,ye,u=>t(15,s=u)),pe(l,ge,u=>t(16,n=u));let{roomId:o}=e,a,c,m,D=!1,j=!0,g=!1,S,f,_=!1,b=!1;function v(){L(le),y(),A.get("rooms").get(o).get("playing").put(!0)}async function y(){const u=A.get("rooms").get(o),d=await u,r=$e.fromSeed(d.seed),p=await je(r,d.words);u.get("word").put(p),u.get("seed").put(r.nextInt())}async function W(){const u=A.get("rooms").get(o),d=u.get("users"),r=Ie(await d).sort();u.get("turn").put(r[(r.indexOf(m)+1)%r.length]),await y()}let k;function L(u=le){if(k!=null)return;const d=A.get("rooms").get(o).get("timer");d.put(u),t(14,k=setInterval(async()=>{const r=await d;r===0?M():d.put(r-1)},1e3))}function M(){if(k==null)return;const u=A.get("rooms").get(o),d=u.get("users"),r=u.get("timer");Promise.all([u,d]).then(([p,O])=>{O[m]==="team1"?u.get("team1").put(p.team1+1):u.get("team2").put(p.team2+1)}),u.get("playing").put(!1),clearInterval(k),t(14,k=void 0),r.put(0)}ke(()=>{const u=A.get("rooms").get(o),d=u.get("timer").on(V=>{t(3,S=V)}),r=u.get("started").on(V=>{t(13,j=V)}),p=u.get("team1").on(V=>{t(4,a=V)}),O=u.get("team2").on(V=>{t(5,c=V)}),ee=u.get("word").on(V=>{t(7,f=V)}),te=u.get("turn").on(V=>{t(6,m=V),t(2,g=m===Ee(ge))}),Q=u.get("playing").on(V=>{t(1,D=V)});return()=>{d.off(),r.off(),p.off(),O.off(),ee.off(),te.off(),Q.off()}});const x=()=>t(8,_=!0),C=()=>t(9,b=!0);function R(u){_=u,t(8,_)}function H(u){b=u,t(9,b)}return l.$$set=u=>{"roomId"in u&&t(0,o=u.roomId)},l.$$.update=()=>{l.$$.dirty&98304&&!n&&!s&&he(`${re}/auth`),l.$$.dirty&8193&&(j||he(`${re}/lobby?room=${o}`)),l.$$.dirty&16398&&(g&&D?L(S===0?le:S):k!=null&&(clearInterval(k),t(14,k=void 0)))},[o,D,g,S,a,c,m,f,_,b,v,y,W,j,k,s,n,x,C,R,H]}class Fe extends fe{constructor(e){super();ie(this,e,Be,Re,ue,{roomId:0})}}export{Fe as default,Ye as load};
